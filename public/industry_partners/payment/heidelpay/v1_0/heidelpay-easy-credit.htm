<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-conditions="Spryker.B2C,Spryker.DemoShop" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Technology Partners|Payment|Heidelpay">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../Skins/Favicons/browserconfig.xml" />
        <meta name="description" content="Integrate Easy Credit payment through Heidelpay into Spryker Legacy Demoshop." />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Heidelpay Partner Integration - Easy Credit | Spryker</title>
        <!-- Google Tag Manager -->
        <script>/* <![CDATA[ */(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-NP24S2');/* ]]> */</script>
        <!-- End Google Tag Manager -->
        <script>/* <![CDATA[ */
			var s = document.createElement("script");
			s.type = "text/javascript";
			s.src = "https://www.googletagmanager.com/gtag/js?id==UA-56589105-4";
			document.getElementsByTagName('head').item(0).appendChild(s);
		/* ]]> */</script>
        <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-56589105-4');
		/* ]]> */</script>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <link href="../../../../resources/stylesheets/perfect-scrollbar.css" rel="stylesheet" />
        <link href="../../../../resources/stylesheets/prism.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../resources/scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../resources/stylesheets/mainstyles.css" rel="stylesheet" />
        <link href="../../../../resources/tablestyles/patternedrows2.css" rel="stylesheet" />
        <script src="../../../../resources/scripts/custom.modernizr.js">
        </script>
        <script src="../../../../resources/scripts/jquery.min.js">
        </script>
        <script src="../../../../resources/scripts/require.min.js">
        </script>
        <script src="../../../../resources/scripts/require.config.js">
        </script>
        <script src="../../../../resources/scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../resources/scripts/plugins.min.js">
        </script>
        <script src="../../../../resources/scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search the Academy" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <!-- Google Tag Manager (noscript) -->
                                <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP24S2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                </noscript>
                                <!-- End Google Tag Manager (noscript) -->
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="breadcrumbs-block">
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                        </div>
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchHome mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                                <div data-sticky-container="" id="EITCtiM6C0KWQLqiCwKGEg">
                                                    <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="EITCtiM6C0KWQLqiCwKGEg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                        <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/master.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="side-menu">
                                                <div class="toolbar-wrapper">
                                                    <div class="widget-github js-widget-github"><a class="widget-github-link js-widget-github-link" href="https://github.com/spryker/spryker-documentation" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><path d="M13.5 0C6.057 0 0 6.057 0 13.5c0 5.888 3.791 10.905 9.058 12.745a.463.463 0 0 0 .258.088c1.316.43 2.724.667 4.184.667C20.943 27 27 20.943 27 13.5S20.943 0 13.5 0zm0 .931c6.93 0 12.569 5.639 12.569 12.569 0 5.428-3.459 10.061-8.287 11.818a1.903 1.903 0 0 1-.092-.527v-2.446c0-.975-.477-2.037-.946-2.75 2.584-.436 5.537-1.776 5.537-6.779 0-1.37-.429-2.58-1.275-3.598.186-.611.415-1.9-.225-3.52a.47.47 0 0 0-.291-.272c-.13-.04-1.326-.35-3.806 1.277a12.921 12.921 0 0 0-6.36 0c-2.481-1.63-3.68-1.319-3.809-1.277a.47.47 0 0 0-.29.273C5.582 7.319 5.811 8.607 6 9.218c-.85 1.018-1.279 2.227-1.279 3.598 0 4.957 2.9 6.323 5.463 6.778-.322.407-.66.934-.81 1.47-.661.184-2.018.19-2.929-1.37-.032-.06-.829-1.475-2.4-1.584-.25.002-.882.042-1.035.525-.169.537.424.944.679 1.117l.058.034c.029.015.707.371 1.213 1.644.105.333 1.03 2.84 4.353 2.399.002.367 0 .552-.004.7v.26c0 .15-.045.378-.096.525C4.386 23.558.931 18.924.931 13.5.931 6.57 6.57.931 13.5.931zm6.51 5.375c.5 1.471.158 2.537.035 2.839a.468.468 0 0 0 .089.49c.805.883 1.214 1.952 1.214 3.181 0 4.72-2.796 5.666-5.535 5.97a.464.464 0 0 0-.253.815c.368.314 1.199 1.68 1.199 2.744v2.446c0 .009.001.414.134.809a12.513 12.513 0 0 1-6.792-.002c.135-.396.139-.802.139-.81l.001-.248c.002-.211.006-.497 0-1.266a.473.473 0 0 0-.174-.362.47.47 0 0 0-.391-.09c-3.126.681-3.802-1.576-3.828-1.67l-.016-.047c-.448-1.135-1.037-1.713-1.388-1.975.759.267 1.182 1.007 1.193 1.024 1.231 2.107 3.264 2.162 4.328 1.685a.463.463 0 0 0 .27-.36c.095-.665.826-1.545 1.196-1.87a.464.464 0 0 0 .136-.488.461.461 0 0 0-.39-.324c-2.73-.31-5.524-1.266-5.524-5.98 0-1.228.41-2.3 1.219-3.181a.464.464 0 0 0 .087-.491c-.124-.302-.467-1.364.031-2.837.396.013 1.362.182 2.988 1.286.112.076.256.1.387.063.973-.27 2.058-.416 3.135-.421 1.08.005 2.166.15 3.14.421.131.037.273.013.386-.063 1.635-1.11 2.6-1.275 2.984-1.288z" /></svg></a>
                                                    </div>
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic NextTopic Print ExpandAll CollapseAll;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="js-anchorer main-content">
                                                    <h1>Heidelpay - Easy Credit <img src="../../../../resources/images/shoptype/b2c_shop.png" /> <img src="../../../../resources/images/shoptype/demoshop.png" /></h1>
                                                    <h2>Setup</h2>
                                                    <p>The following configuration should be implemented after Heidelpay has been <a href="heidelpay-installation.htm">installed</a> and <a href="heidelpay-integration.htm">integrated</a>.</p>
                                                    <h2>Configuration</h2>
                                                    <div class="table-wrap">
                                                        <table style="width: 100%;mc-table-style: url('../../../../resources/tablestyles/patternedrows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
                                                            <col class="TableStyle-PatternedRows2-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows2-Column-Regular" />
                                                            <col class="TableStyle-PatternedRows2-Column-Regular" />
                                                            <thead>
                                                                <tr class="TableStyle-PatternedRows2-Head-Header1">
                                                                    <td class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Configuration Key</td>
                                                                    <td class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Type</td>
                                                                    <td class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Description</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows"><var>HeidelpayConstants::CONFIG_HEIDELPAY_EASYCREDIT_CRITERIA_REJECTED_DELIVERY_ADDRESS</var>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">string</td>
                                                                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">Criteria to reject by delivery address (for example 'Packstation')</td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows"><var>HeidelpayConstants::CONFIG_HEIDELPAY_EASYCREDIT_CRITERIA_GRAND_TOTAL_LESS_THAN</var>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">int</td>
                                                                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">Criteria to reject if grand total less than (for example 200)</td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows"><var>HeidelpayConstants::CONFIG_HEIDELPAY_EASYCREDIT_CRITERIA_GRAND_TOTAL_MORE_THAN</var>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">int</td>
                                                                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">Criteria to reject if grand total greater than (for example 5000)</td>
                                                                </tr>
                                                                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                                                                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows"><var>HeidelpayConstants::CONFIG_HEIDELPAY_TRANSACTION_CHANNEL_EASY_CREDIT</var>
                                                                    </td>
                                                                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">string</td>
                                                                    <td class="TableStyle-PatternedRows2-BodyA-Regular-DarkerRows">Transaction channel for Easy Credit payment method (provided by Heidelpay)</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <ol>
                                                        <li value="1">Activate Heidelpay Easycredit payment method.
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />OMS Configuration</a></span><div class="MCDropDownBody dropDownBody"><pre><code class="language-bash line-numbers">$config[OmsConstants::PROCESS_LOCATION] = [
	...
	APPLICATION_ROOT_DIR . '/vendor/spryker-eco/heidelpay/config/Zed/Oms',
];
$config[OmsConstants::ACTIVE_PROCESSES] = [
	...
	'HeidelpayEasyCredit01',
];
$config[SalesConstants::PAYMENT_METHOD_STATEMACHINE_MAPPING] = [
	...
	HeidelpayConfig::PAYMENT_METHOD_EASY_CREDIT =&gt; 'HeidelpayEasyCredit01',
];</code></pre></div></div></li>
                                                        <li value="2">Add Easycredit checkout steps to <var>StepFactory</var>:<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />\Pyz\Yves\CheckoutPage\Process\StepFactory</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-php line-numbers">&lt;?php
 
namespace Pyz\Yves\CheckoutPage\Process;
 
use Pyz\Yves\CheckoutPage\CheckoutPageDependencyProvider;
use Pyz\Yves\CheckoutPage\Plugin\Provider\CheckoutPageControllerProvider;
use Spryker\Yves\StepEngine\Process\StepCollection;
use SprykerEco\Client\Heidelpay\HeidelpayClientInterface;
use SprykerEco\Yves\Heidelpay\CheckoutPage\Process\Steps\HeidelpayEasycreditInitializeStep;
use SprykerEco\Yves\Heidelpay\CheckoutPage\Process\Steps\HeidelpayEasycreditStep;
use SprykerShop\Yves\CheckoutPage\Process\StepFactory as BaseStepFactory;
use SprykerShop\Yves\HomePage\Plugin\Provider\HomePageControllerProvider;
 
/**
 * @method \SprykerShop\Yves\CheckoutPage\CheckoutPageConfig getConfig()
 */
class StepFactory extends BaseStepFactory
{
	/**
	 * @return \Spryker\Yves\StepEngine\Process\StepCollectionInterface
	 */
	public function createStepCollection()
	{
		$stepCollection = new StepCollection(
			$this-&gt;getUrlGenerator(),
			CheckoutPageControllerProvider::CHECKOUT_ERROR
		);
 
		$stepCollection
			-&gt;addStep($this-&gt;createEntryStep())
			-&gt;addStep($this-&gt;createCustomerStep())
			-&gt;addStep($this-&gt;createAddressStep())
			-&gt;addStep($this-&gt;createShipmentStep())
			-&gt;addStep($this-&gt;createHeidelpayEasyCreditInitializeStep())
			-&gt;addStep($this-&gt;createPaymentStep())
			-&gt;addStep($this-&gt;createHeidelpayEasyCreditStep())
			-&gt;addStep($this-&gt;createSummaryStep())
			-&gt;addStep($this-&gt;createPlaceOrderStep())
			-&gt;addStep($this-&gt;createSuccessStep());
 
		return $stepCollection;
	}
 
	/**
	 * @return \SprykerEco\Yves\Heidelpay\CheckoutPage\Process\Steps\HeidelpayEasycreditInitializeStep
	 */
	public function createHeidelpayEasyCreditInitializeStep(): HeidelpayEasycreditInitializeStep
	{
		return new HeidelpayEasycreditInitializeStep(
			CheckoutPageControllerProvider::CHECKOUT_EASYCREDIT_INITIALIZE,
			HomePageControllerProvider::ROUTE_HOME,
			$this-&gt;getHeidelpayClient()
		);
	}
 
	/**
	 * @return \SprykerEco\Yves\Heidelpay\CheckoutPage\Process\Steps\HeidelpayEasycreditStep
	 */
	public function createHeidelpayEasyCreditStep(): HeidelpayEasycreditStep
	{
		return new HeidelpayEasycreditStep(
			CheckoutPageControllerProvider::CHECKOUT_EASYCREDIT,
			HomePageControllerProvider::ROUTE_HOME
		);
	}
 
	/**
	 * @return \SprykerEco\Client\Heidelpay\HeidelpayClientInterface
	 */
	public function getHeidelpayClient(): HeidelpayClientInterface
	{
		return $this-&gt;getProvidedDependency(CheckoutPageDependencyProvider::CLIENT_HEIDELPAY);
	}
}</code></pre></div></div></li>
                                                        <li value="3">Extend <var>CheckoutPageFactory</var> to change step factory creation:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />\Pyz\Yves\CheckoutPage\CheckoutPageFactory</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-php line-numbers">&lt;?php
 
namespace Pyz\Yves\CheckoutPage;
 
use Pyz\Yves\CheckoutPage\Process\StepFactory;
use SprykerShop\Yves\CheckoutPage\CheckoutPageFactory as SprykerShopCheckoutPageFactory;
 
class CheckoutPageFactory extends SprykerShopCheckoutPageFactory
{
	/**
	 * @return \Pyz\Yves\CheckoutPage\Process\StepFactory
	 */
	public function createStepFactory()
	{
		return new StepFactory();
	}
}</code></pre></div></div></li>
                                                        <li value="4">Extend <var>CheckoutController</var> to add Easycredit step action:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />\Pyz\Yves\CheckoutPage\Controller\CheckoutController</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-php line-numbers">&lt;?php
 
namespace Pyz\Yves\CheckoutPage\Controller;
 
use SprykerShop\Yves\CheckoutPage\Controller\CheckoutController as BaseCheckoutController;
use Symfony\Component\HttpFoundation\Request;
 
/**
 * @method \SprykerShop\Yves\CheckoutPage\CheckoutPageFactory getFactory()
 */
class CheckoutController extends BaseCheckoutController
{
	/**
	 * @param \Symfony\Component\HttpFoundation\Request $request
	 *
	 * @return array|\Symfony\Component\HttpFoundation\RedirectResponse
	 */
	public function easyCreditAction(Request $request)
	{
		return $this-&gt;createStepProcess()-&gt;process($request);
	}
}</code></pre></div></div></li>
                                                        <li value="5">Extend <var>CheckoutPageControllerProvider</var> to add Easycredit actions:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />\Pyz\Yves\CheckoutPage\Plugin\Provider\CheckoutPageControllerProvider</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-php line-numbers">&lt;?php
 
namespace Pyz\Yves\CheckoutPage\Plugin\Provider;
 
use Silex\Application;
use SprykerShop\Yves\CheckoutPage\Plugin\Provider\CheckoutPageControllerProvider as BaseCheckoutPageControllerProvider;
 
class CheckoutPageControllerProvider extends BaseCheckoutPageControllerProvider
{
	public const CHECKOUT_EASYCREDIT = 'checkout-easycredit';
	public const CHECKOUT_EASYCREDIT_INITIALIZE = 'checkout-easycredit-initialize';
 
	/**
	 * @param \Silex\Application $app
	 *
	 * @return void
	 */
	protected function defineControllers(Application $app)
	{
		parent::defineControllers($app);
 
		$this-&gt;addCheckoutEasycreditRoute();
	}
 
	/**
	 * @return $this
	 */
	protected function addCheckoutEasycreditRoute()
	{
		$this-&gt;createController(
			'/{checkout}/easycredit',
			self::CHECKOUT_EASYCREDIT,
			'CheckoutPage',
			'Checkout',
			'easyCredit'
		)
			-&gt;assert('checkout', $this-&gt;getAllowedLocalesPattern() . 'checkout|checkout')
			-&gt;value('checkout', 'checkout')
			-&gt;method('GET|POST');
 
		$this-&gt;createController(
			'/{checkout}/easycredit-initialize',
			self::CHECKOUT_EASYCREDIT_INITIALIZE,
			'CheckoutPage',
			'Checkout',
			'easyCredit'
		)
			-&gt;assert('checkout', $this-&gt;getAllowedLocalesPattern() . 'checkout|checkout')
			-&gt;value('checkout', 'checkout')
			-&gt;method('GET|POST');
 
		return $this;
	}
}</code></pre></div></div></li>
                                                        <li value="6">Update <var>CheckoutPageDependencyProvider</var> with Easycredit related modifications:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />\Pyz\Yves\CheckoutPage\CheckoutPageDependencyProvider</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-php line-numbers">&lt;?php
 
namespace Pyz\Yves\CheckoutPage;
 
...
use SprykerEco\Yves\Heidelpay\Plugin\Subform\HeidelpayEasyCreditSubFormPlugin;
...
 
class CheckoutPageDependencyProvider extends SprykerShopCheckoutPageDependencyProvider
{
	public const CLIENT_HEIDELPAY = 'CLIENT_HEIDELPAY';
 
	/**
	 * @param \Spryker\Yves\Kernel\Container $container
	 *
	 * @return \Spryker\Yves\Kernel\Container
	 */
	public function provideDependencies(Container $container)
	{
		$container = parent::provideDependencies($container);
		$container = $this-&gt;addHeidelpayClient($container);
 
		return $container;
	}
 
	/**
	 * @param \Spryker\Yves\Kernel\Container $container
	 *
	 * @return \Spryker\Yves\Kernel\Container
	 */
	protected function addSubFormPluginCollection(Container $container): Container
	{
		$container[self::PAYMENT_SUB_FORMS] = function () {
			$subFormPluginCollection = new SubFormPluginCollection();
			...
			$subFormPluginCollection-&gt;add(new HeidelpayEasyCreditSubFormPlugin());
 
			return $subFormPluginCollection;
		};
 
		return $container;
	}
 
	/**
	 * @param \Spryker\Yves\Kernel\Container $container
	 *
	 * @return \Spryker\Yves\Kernel\Container
	 */
	protected function addPaymentMethodHandlerPluginCollection(Container $container): Container
	{
		$container[self::PAYMENT_METHOD_HANDLER] = function () {
			$stepHandlerPluginCollection = new StepHandlerPluginCollection();
			...
			$stepHandlerPluginCollection-&gt;add(new HeidelpayHandlerPlugin(), PaymentTransfer::HEIDELPAY_EASY_CREDIT);
 
			return $stepHandlerPluginCollection;
		};
 
		return $container;
	}
 
	/**
	 * @param \Spryker\Yves\Kernel\Container $container
	 *
	 * @return \Spryker\Yves\Kernel\Container
	 */
	protected function addHeidelpayClient(Container $container): Container
	{
		$container[static::CLIENT_HEIDELPAY] = function () use ($container) {
			return $container-&gt;getLocator()-&gt;heidelpay()-&gt;client();
		};
 
		return $container;
	}
}</code></pre></div></div></li>
                                                        <li value="7">Update <var>payment.twig</var> template with Easycredit payment method:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />src/Pyz/Yves/CheckoutPage/Theme/default/views/payment/payment.twig</a></span><div class="MCDropDownBody dropDownBody"><pre><code class="language-twig line-numbers">{% extends template('page-layout-checkout', 'CheckoutPage') %}
 
{% define data = {
	backUrl: _view.previousStepUrl,
	forms: {
		payment: _view.paymentForm
	},
 
	title: 'checkout.step.payment.title' | trans,
	customForms: {
		...
		'heidelpay/easy-credit': ['easy-credit', 'heidelpay'],
	}
} %}
 
{% block content %}
	...
{% endblock %}</code></pre></div></div></li>
                                                        <li value="8">Update <var>summary.twig</var> to template to display Easycredit related fees:
				<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />src/Pyz/Yves/CheckoutPage/Theme/default/views/payment/payment.twig</a></span><div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="language-twig line-numbers">{% extends template('page-layout-checkout', 'CheckoutPage') %}
 
{% define data = {
	backUrl: _view.previousStepUrl,
	transfer: _view.quoteTransfer,
	cartItems: _view.cartItems,
	shippingAddress: _view.quoteTransfer.shippingAddress,
	billingAddress: _view.quoteTransfer.billingAddress,
	shipmentMethod: _view.quoteTransfer.shipment.method.name,
	paymentMethod: _view.quoteTransfer.payment.paymentMethod,
	heidelpayEasyCredit: _view.quoteTransfer.payment.heidelpayEasyCredit | default(null),
 
	forms: {
		summary: _view.summaryForm
	},
 
	overview: {
		shipmentMethod: _view.quoteTransfer.shipment.method.name,
		expenses: _view.quoteTransfer.expenses,
		voucherDiscounts: _view.quoteTransfer.voucherDiscounts,
		cartRuleDiscounts: _view.quoteTransfer.cartRuleDiscounts,
 
		prices: {
			subTotal: _view.quoteTransfer.totals.subtotal,
			storeCurrency: _view.quoteTransfer.shipment.method.storeCurrencyPrice,
			grandTotal: _view.quoteTransfer.totals.grandtotal,
			tax: _view.quoteTransfer.totals.taxtotal.amount,
			discountTotal: _view.quoteTransfer.totals.discounttotal | default
		}
	},
 
	title: 'checkout.step.summary.title' | trans
} %}
 
{% block content %}
	&lt;div class="grid"&gt;
		&lt;div class="col col--sm-12 col--lg-4"&gt;
			&lt;div class="box"&gt;
				&lt;span class="float-right"&gt;{{ 'checkout.step.summary.with_method' | trans }} &lt;strong&gt;{{data.paymentMethod}}&lt;/strong&gt;&lt;/span&gt;
				&lt;h6&gt;{{ 'checkout.step.summary.payment' | trans }}&lt;/h6&gt;
				&lt;br&gt;
				{% if data.heidelpayEasyCredit is not null %}
					&lt;span class="float-right"&gt;{{ data.heidelpayEasyCredit.amortisationText }}&lt;/span&gt;
					&lt;div class="grid"&gt;
						&lt;a href="{{ data.heidelpayEasyCredit.preContractionInformationUrl }} "class="float-left"&gt;
							{{ 'heidelpay.payment.easy_credit.pre_contraction_info_link_text' | trans }}
						&lt;/a&gt;
					&lt;/div&gt;
					&lt;br&gt;
					&lt;div&gt;
						&lt;ul&gt;
							&lt;li&gt;&lt;strong&gt;{{ 'heidelpay.payment.easy_credit.order_total' | trans }} &lt;/strong&gt;{{ data.heidelpayEasyCredit.totalOrderAmount | money }}&lt;/li&gt;
							&lt;li&gt;&lt;strong&gt;{{ 'heidelpay.payment.easy_credit.interest' | trans }} &lt;/strong&gt;{{ data.heidelpayEasyCredit.accruingInterest | money }}&lt;/li&gt;
							&lt;li&gt;&lt;strong&gt;{{ 'heidelpay.payment.easy_credit.total_inc_interest' | trans }} &lt;/strong&gt;{{ data.heidelpayEasyCredit.totalAmount | money }}&lt;/li&gt;
						&lt;/ul&gt;
					&lt;/div&gt;
				{% endif %}
				&lt;hr/&gt;
 
				{% include molecule('display-address') with {
					class: 'text-small',
					data: {
						address: data.billingAddress
					}
				} only %}
			&lt;/div&gt;
 
			&lt;div class="box"&gt;
				&lt;span class="float-right"&gt;{{ 'checkout.step.summary.with_method' | trans }} &lt;strong&gt;{{ data.shipmentMethod }}&lt;/strong&gt;&lt;/span&gt;
				&lt;h6&gt;{{ 'checkout.step.summary.shipping' | trans }}&lt;/h6&gt;
				&lt;hr/&gt;
 
				{% include molecule('display-address') with {
					class: 'text-small',
					data: {
						address: data.shippingAddress
					}
				} only %}
			&lt;/div&gt;
		&lt;/div&gt;
 
		&lt;div class="col col--sm-12 col--lg-8"&gt;
			&lt;div class="box"&gt;
				{% for item in data.cartItems %}
					{% set item = item.bundleProduct is defined ? item.bundleProduct : item %}
					{% embed molecule('summary-item', 'CheckoutPage') with {
						data: {
							name: item.name,
							quantity: item.quantity,
							price: item.sumPrice | money,
							options: item.productOptions | default({}),
							bundleItems: item.bundleItems | default([]),
							quantitySalesUnit: item.quantitySalesUnit,
							amountSalesUnit: item.amountSalesUnit,
							amount: item.amount
						},
						embed: {
							isLast: not loop.last,
							item: item
						}
					} only %}
						{% block body %}
							{{parent()}}
							{% if widgetExists('CartNoteQuoteItemNoteWidgetPlugin') %}
								{% if embed.item.cartNote is not empty %}
									{{ widget('CartNoteQuoteItemNoteWidgetPlugin', embed.item) }} {# @deprecated Use molecule('note-list', 'CartNoteWidget') instead. #}
								{% endif %}
							{% elseif embed.item.cartNote is not empty %}
								{% include molecule('note-list', 'CartNoteWidget') ignore missing with {
									data: {
										label: 'cart_note.checkout_page.item_note',
										note: embed.item.cartNote
									}
								} only %}
							{% endif %}
							{% if embed.isLast %}&lt;hr/&gt;{% endif %}
						{% endblock %}
					{% endembed %}
				{% endfor %}
			&lt;/div&gt;
 
			{% if data.transfer.cartNote is not empty %}
				{% if widgetExists('CartNoteQuoteNoteWidgetPlugin') %}
					&lt;div class="box"&gt;
						{{ widget('CartNoteQuoteNoteWidgetPlugin', data.transfer) }}  {#@deprecated Use molecule('note-list', 'CartNoteWidget') instead.#}
					&lt;/div&gt;
				{% else %}
					&lt;div class="box"&gt;
						{% include molecule('note-list', 'CartNoteWidget') ignore missing with {
							data: {
								label: 'cart_note.checkout_page.quote_note',
								note: data.transfer.cartNote
							}
						} only %}
					&lt;/div&gt;
				{% endif %}
			{% endif %}
 
			&lt;div class="box"&gt;
				{% widget 'CheckoutVoucherFormWidget' args [data.transfer] only %}
				{% elsewidget 'CheckoutVoucherFormWidgetPlugin' args [data.transfer] only %} {# @deprecated Use CheckoutVoucherFormWidget instead. #}
				{% endwidget %}
			&lt;/div&gt;
 
			{% embed molecule('form') with {
				class: 'box',
				data: {
					form: data.forms.summary,
					submit: {
						enable: can('SeeOrderPlaceSubmitPermissionPlugin'),
						text: 'checkout.step.place.order' | trans
					},
					cancel: {
						enable: true,
						url: data.backUrl,
						text: 'general.back.button' | trans
					}
				},
				embed: {
					overview: data.overview
				}
			} only %}
				{% block body %}
					{% include molecule('summary-overview', 'CheckoutPage') with {
						data: embed.overview
					} only %}
 
					&lt;hr /&gt;
					{{parent()}}
				{% endblock %}
			{% endembed %}
		&lt;/div&gt;
	&lt;/div&gt;
{% endblock %}</code></pre></div></div></li>
                                                    </ol>
                                                    <h2>Checkout Payment Step Display</h2>
                                                    <p>Displays payment method name with a radio button. No extra input fields are required.</p>
                                                    <h2>Payment Step Submitting</h2>
                                                    <p>No further actions are needed, the quote being filled with payment method selection as default. After selecting Easy Credit as a payment method "HP.IN" request will be sent. In the response, Heidelpay returns an URL string which defines where the customer has to be redirected. If everything was ok, the user would be redirected to the Easy Credit Externally.</p>
                                                    <h2>Summary Review and Order Submitting</h2>
                                                    <p>Once the customer is redirected back to us, the response from Easy Credit is sent to the Heidelpay, and Heidelpay makes a synchronous POST request to the shop's <var>CONFIG_HEIDELPAY_PAYMENT_RESPONSE_URL</var> URL (Yves), with the result of payment (see <var>EasyCreditController::paymentAction()</var>). It is called "external response transaction," the result will be persisted in <var>spy_payment_heidelpay_transaction_log</var> as usual. The most important data here - is the payment reference ID which can be used for further transactions like <var>finalize/reserve/etc</var>.</p>
                                                    <p>After that, the customer can see the order summary page, where they can review all related data.</p>
                                                    <p>There the user will see:</p>
                                                    <ul>
                                                        <li value="1">rate plan (<var>CRITERION.EASYCREDIT_AMORTISATIONTEXT</var>)</li>
                                                        <li value="2">interest fees (<var>CRITERION_EASYCREDIT_ACCRUINGINTEREST</var>)</li>
                                                        <li value="3">total sum including the interest fees (<var>CRITERION.EASYCREDIT_TOTALAMOUNT</var>)</li>
                                                    </ul>
                                                    <p>If the customer has not yet completed the HP.IN they must do that again.</p>
                                                    <p><u style="font-weight: bold;">On the "save order" event</u> - save Heidelpay payment per order and items, as usual.</p>
                                                    <p><b>When the state machine is initialized</b>, an event "send authorize on registration request" will trigger the authorize on registration request. In case of success, the state will be changed.</p>
                                                    <p>Finalize - later on, when the item is shipped to the customer, it is time to call "finalize" command of the state machine. This will send HP.FI request to the Payment API. This is done in <var>FinalizePlugin</var> of the OMS command.</p>
                                                    <p>&#160;</p>
                                                    <p><b>See also:</b>
                                                    </p>
                                                    <ul>
                                                        <li value="1"><a href="../heidelpay.htm">Get a general idea about Heidelpay</a><![CDATA[
            ]]></li>
                                                        <li value="2"><a href="heidelpay-installation.htm">Install Heidelpay
            
</a>
                                                        </li>
                                                        <li value="3"><a href="heidelpay-integration.htm">Integrate Heidelpay</a><![CDATA[
            ]]></li>
                                                        <li value="4"><a href="heidelpay-credit-card.htm">Configuring Credit Card Secure for Heidelpay</a><![CDATA[
            ]]></li>
                                                        <li value="5"><a href="heidelpay-ideal.htm">Configuring iDeal for Hedelpay</a><![CDATA[
            ]]></li>
                                                        <li value="6"><a href="heidelpay-paypal-debit.htm">Checking Paypal Debit Workflow for Heidelpay
            
</a>
                                                        </li>
                                                        <li value="7"><a href="heidelpay-sofort.htm">Configuring Sofort payment for Heidelay
            
</a>
                                                        </li>
                                                        <li value="8"><a href="heidelpay-error-workflow.htm">Configuring Heidelpay error workflow
</a>
                                                        </li>
                                                    </ul>
                                                    <p>&#160;</p>
                                                    <p><i>Last
        review date: Jun 6th, 2019</i>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><a class="scroll-top js-scroll-top" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="#FFF" fill-rule="nonzero" d="M11.82 5.22a.54.54 0 0 1 0 .806.636.636 0 0 1-.852 0L6.607 1.937v13.49a.587.587 0 0 1-.602.573c-.336 0-.611-.258-.611-.573V1.937L1.04 6.026a.647.647 0 0 1-.86 0 .54.54 0 0 1 0-.807L5.573.163a.636.636 0 0 1 .852 0L11.82 5.22z" /></svg></a>
                                <script>/* <![CDATA[ */
			function createGithubUrl() {
			var GITHUB_CONTENT_PATH = '/blob/master/public';
			var link = document.querySelector('.js-widget-github-link');
			var href =
			link.getAttribute('href')
			+ GITHUB_CONTENT_PATH
			+ window.location.pathname;
			link.setAttribute('href', href);
			}
			createGithubUrl();
		/* ]]> */</script>
                                <script>/* <![CDATA[ */
			requirejs.config({
				appDir: '',
				paths: {
					'clipboard': ['https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min']
					
				}
			});
			require(['clipboard'], function(Clipboard) {
				console.log(Clipboard);
				window.Clipboard = Clipboard;
			});
		/* ]]> */</script>
                                <script src="../../../../resources/scripts/perfect-scrollbar.js">
                                </script>
                                <script src="../../../../resources/scripts/imagemapster.js">
                                </script>
                                <script src="../../../../resources/scripts/script.js">
                                </script>
                                <script src="../../../../resources/scripts/prism.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>
