<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="Spryker.ShopSuite,Spryker.DemoShop,Spryker.B2C,Spryker.B2B">
    <head>
    </head>
    <body>
        <h1><a name="Step"></a>Step Engine Workflow <img src="../../../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/MasterSuite.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <p>When you need to define a multi-step process using the <var>StepEngine</var> feature, you need to implement the following interfaces:</p>
        <ul>
            <li class="bullet_list"><var>StepInterface </var>- here you implement the logic that needs to get executed when the defined step takes place</li>
            <li class="bullet_list"><var>SubFormInterface</var> - defines the name of the form and the <var>pathProperty</var> which is used to fill the property of transfer object for the current step</li>
            <li class="bullet_list"><var>DataContainerInterface</var> - holds the transfer object you are working on</li>
        </ul>
        <h2><a name="Defining2"></a>Defining the Steps</h2>
        <p>The defined steps are wired up through the parameters that are passed when creating the <var>StepEngine</var>:</p>
        <ul>
            <li class="bullet_list"><var>StepCollectionInterface</var> - this contains all the steps that are used in the <var>StepEngine::process()</var></li>
            <li class="bullet_list"><var>DataContainerInterface</var> - holds the main transfer object and knows how to persist the data during the requests</li>
        </ul>
        <p>The <var>StepEngine</var> takes care of executing the steps defined in your <var>StepCollection</var>. To start the multi-step workflow, you need to call the <var>StepEngine::process()</var> operation from your controller and pass the request object to it; optionally you can pass a <var>FormCollectionHandlerInterface</var> to it.</p>
        <h2><a name="Processi"></a>Processing the Workflow</h2>
        <p>When the <var>StepEngine</var> starts to process the multi-step workflow, it will iterate through the steps contained in the step collection.</p>
        <p>For the current step, it will check if it meets the assigned preconditions by calling <var>StepInterface::preCondition()</var>.</p>
        <ul>
            <li class="bullet_list">the preconditions are not satisfied: <var>StepEngine</var> will return a <var>RedirectResponse</var> to the defined <var>StepInterface::getEscapeRoute()</var></li>
            <li class="bullet_list">the preconditions are satisfied: <var>StepEngine</var> will ask the <var>StepCollection</var> if the current step can be accessed.</li>
        </ul>
        <p>If the preconditions are satisfied and the current step can be accessed, <var>StepEngine</var> needs to verify if the current step needs user input:</p>
        <ul>
            <li class="bullet_list">current step doesn’t need user input: <var>StepEngine</var> will return a <var>RedirectResponse</var> to the next step</li>
            <li class="bullet_list">current step needs user input: <var>StepEngine</var> will take the <var>Request</var> object and pass it to the <var>FormCollectionHandlerInterface</var></li>
        </ul>
        <p>If we have a submitted form, the <var>FormCollectionHandlerInterface</var> will handle the request and if the form validation passes the <var>StepEngine</var> the execution of the workflow will continue.</p>
        <p>If the request does not contain valid data for the given form, it will redirect the user to the last URL, where the user can correct his input data and submit it again.</p>
        <p>The <var>StepEngine</var> will go like this through all the steps added to the <var>StepCollection</var>, until all the steps are executed.</p>
        <p class="note">The <var>StepCollection</var>, <var>FormCollectionHandler</var> and <var>StepEngine</var> classes can be used without the need to extend them in your project.</p>
        <ul>
            <li class="bullet_list"><a href="step-engine-define-step.htm">Defining a Step - Step Engine</a>
            </li>
            <li class="bullet_list"><a href="step-engine-use-case-scenario.htm">Use Case Scenario - Step Engine</a>
            </li>
            <li class="bullet_list"><a href="step-engine-breadcrumb.htm">Breadcrumb Navigation - Step Engine</a>
            </li>
            <li class="bullet_list"><a href="step-engine.htm">About Step Engine</a>
            </li>
        </ul>
    </body>
</html>