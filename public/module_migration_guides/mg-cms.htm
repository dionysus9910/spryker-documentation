<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../" data-mc-has-content-body="True" data-mc-conditions="General.Demoshop,Spryker.B2C,Spryker.B2B" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Migration and Integration|Module Migration Guides">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Migration Guide - CMS</title>
        <!-- Google Tag Manager -->
        <script>/* <![CDATA[ */(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-NP24S2');/* ]]> */</script>
        <!-- End Google Tag Manager -->
        <script>/* <![CDATA[ */
			var s = document.createElement("script");
			s.type = "text/javascript";
			s.src = "https://www.googletagmanager.com/gtag/js?id==UA-56589105-4";
			document.getElementsByTagName('head').item(0).appendChild(s);
		/* ]]> */</script>
        <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-56589105-4');
		/* ]]> */</script>
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <link href="../resources/stylesheets/perfect-scrollbar.css" rel="stylesheet" />
        <link href="../resources/stylesheets/prism.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../resources/scripts/PIE-no-motw.htc');
}

</style>
        <link href="../resources/stylesheets/mainstyles.css" rel="stylesheet" />
        <script src="../resources/scripts/custom.modernizr.js">
        </script>
        <script src="../resources/scripts/jquery.min.js">
        </script>
        <script src="../resources/scripts/require.min.js">
        </script>
        <script src="../resources/scripts/require.config.js">
        </script>
        <script src="../resources/scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../resources/scripts/plugins.min.js">
        </script>
        <script src="../resources/scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search the Academy" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <!-- Google Tag Manager (noscript) -->
                                <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP24S2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                </noscript>
                                <!-- End Google Tag Manager (noscript) -->
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="breadcrumbs-block">
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                        </div>
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchHome mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                                <div data-sticky-container="" id="v8FmN7cuu0GEUIYYzzFXLg">
                                                    <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="v8FmN7cuu0GEUIYYzzFXLg:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                        <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/master.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="side-menu">
                                                <div class="toolbar-wrapper">
                                                    <div class="widget-github js-widget-github"><a class="widget-github-link js-widget-github-link" href="https://github.com/spryker/spryker-documentation" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><path d="M13.5 0C6.057 0 0 6.057 0 13.5c0 5.888 3.791 10.905 9.058 12.745a.463.463 0 0 0 .258.088c1.316.43 2.724.667 4.184.667C20.943 27 27 20.943 27 13.5S20.943 0 13.5 0zm0 .931c6.93 0 12.569 5.639 12.569 12.569 0 5.428-3.459 10.061-8.287 11.818a1.903 1.903 0 0 1-.092-.527v-2.446c0-.975-.477-2.037-.946-2.75 2.584-.436 5.537-1.776 5.537-6.779 0-1.37-.429-2.58-1.275-3.598.186-.611.415-1.9-.225-3.52a.47.47 0 0 0-.291-.272c-.13-.04-1.326-.35-3.806 1.277a12.921 12.921 0 0 0-6.36 0c-2.481-1.63-3.68-1.319-3.809-1.277a.47.47 0 0 0-.29.273C5.582 7.319 5.811 8.607 6 9.218c-.85 1.018-1.279 2.227-1.279 3.598 0 4.957 2.9 6.323 5.463 6.778-.322.407-.66.934-.81 1.47-.661.184-2.018.19-2.929-1.37-.032-.06-.829-1.475-2.4-1.584-.25.002-.882.042-1.035.525-.169.537.424.944.679 1.117l.058.034c.029.015.707.371 1.213 1.644.105.333 1.03 2.84 4.353 2.399.002.367 0 .552-.004.7v.26c0 .15-.045.378-.096.525C4.386 23.558.931 18.924.931 13.5.931 6.57 6.57.931 13.5.931zm6.51 5.375c.5 1.471.158 2.537.035 2.839a.468.468 0 0 0 .089.49c.805.883 1.214 1.952 1.214 3.181 0 4.72-2.796 5.666-5.535 5.97a.464.464 0 0 0-.253.815c.368.314 1.199 1.68 1.199 2.744v2.446c0 .009.001.414.134.809a12.513 12.513 0 0 1-6.792-.002c.135-.396.139-.802.139-.81l.001-.248c.002-.211.006-.497 0-1.266a.473.473 0 0 0-.174-.362.47.47 0 0 0-.391-.09c-3.126.681-3.802-1.576-3.828-1.67l-.016-.047c-.448-1.135-1.037-1.713-1.388-1.975.759.267 1.182 1.007 1.193 1.024 1.231 2.107 3.264 2.162 4.328 1.685a.463.463 0 0 0 .27-.36c.095-.665.826-1.545 1.196-1.87a.464.464 0 0 0 .136-.488.461.461 0 0 0-.39-.324c-2.73-.31-5.524-1.266-5.524-5.98 0-1.228.41-2.3 1.219-3.181a.464.464 0 0 0 .087-.491c-.124-.302-.467-1.364.031-2.837.396.013 1.362.182 2.988 1.286.112.076.256.1.387.063.973-.27 2.058-.416 3.135-.421 1.08.005 2.166.15 3.14.421.131.037.273.013.386-.063 1.635-1.11 2.6-1.275 2.984-1.288z" /></svg></a>
                                                    </div>
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic NextTopic Print ExpandAll CollapseAll;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img src="../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img src="../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img src="../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img src="../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="js-anchorer main-content">
                                                    <h1><a name="Migration"></a>Migration Guide - CMS <img src="../resources/images/shoptype/b2b_shop.png" /> <img src="../resources/images/shoptype/b2c_shop.png" /></h1>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><div class="drop-anchor">Upgrading from Version 6.* to Version 7.*</div></a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Version 7.0.0 of the CMS module introduces the <a href="https://documentation.spryker.com/capabilities/cms/cms_page/multi-store-cms-pages-201903.htm">multi-store functionality</a>. The multi-store CMS page feature enables management of CMS page display per store via a store toggle control in the Admin UI.</p>
                                                            <h3>BC breaks and solutions:</h3>
                                                            <ul>
                                                                <li value="1">Update deprecated methods and classes</li>
                                                                <li value="2">Update removed exceptions</li>
                                                                <li value="3">Update storage behavior</li>
                                                                <li value="4">Migrate database</li>
                                                            </ul>
                                                            <h4>To upgrade to the new version of the module, do the following:</h4>
                                                            <ol>
                                                                <li value="1">Update the Cms module with Composer: <br /><i>"spryker/cms": "^7.0.0"</i></li>
                                                                <li value="2"><b>Remove</b> all deprecated references:
						<br />Search for and update usage of any deprecated class or method that was used.
						<ul><li value="1">Renamed the <var>createLocaleQuery</var> method to <var>getLocaleQuery</var> in <var>CmsPersistenceFactory</var>.</li><li value="2">Removed the deprecated method <var>getName()</var> in favor of <var>getBlockPrefix()</var> in <var>CmsGlossaryForm.php</var>.</li><li value="3">Removed deprecated method <var>getName()</var> in favor of <var>getBlockPrefix()</var> in <var>CmsRedirectForm.php</var>.</li></ul><br />Interfaces were moved to the <var>CmsExtension</var> module.
						<ul><li value="1">Moved the <var>CmsVersionPostSavePluginInterface</var> interface from Cms to <var>CmsExtension</var></li><li value="2">Moved the <var>CmsVersionTransferExpanderPluginInterface</var> interface from Cms to <var>CmsExtension</var></li><li value="3">Moved the <var>CmsPageDataExpanderPluginInterface.php</var> interface from Cms to <var>CmsExtension</var></li><li value="4">Removed the deprecated class <var>CmsBlockKeyBuilder</var> in favor of installing the new <var>CmsBlock</var> module instead.</li></ul><br />Exceptions were replaced by Throwables.
						<ul><li value="1">Replaced <i>Exception</i> in favor of <i>Throwable</i> in <var>CmsPageSaver</var></li><li value="2">Replaced <i>Exception</i> in favor of <i>Throwable</i> in <var>PageRemover</var></li><li value="3">Replaced <i>Exception</i> in favor of <i>Throwable</i> in <var>CmsPageActivator</var></li><li value="4">Replaced <i>Exception</i> in favor of <i>Throwable</i> in <var>CmsGlossarySaver</var></li></ul><br />Also, keep in mind that a doc block with non-existing methods was removed from <var>CmsQueryContainerInterface</var>.
					</li>
                                                                <li value="3">Update Database Schema.
						<br />The event behavior needs to be applied to all <var>SpyCmsPageStore</var> columns.
						<var>src/Pyz/Zed/Cms/Persistence/Propel/Schema/spy_cms.schema.xml</var><pre><code class="language-PHP line-numbers">
&lt;?xml version="1.0"?&gt;
&lt;database xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" name="zed" xsi:noNamespaceSchemaLocation="http://static.spryker.com/schema-01.xsd" namespace="Orm\Zed\Cms\Persistence" package="src.Orm.Zed.Cms.Persistence"&gt;

	&lt;table name="spy_cms_page_store"&gt;
		&lt;behavior name="event"&gt;
			&lt;parameter name="spy_cms_page_store_all" column="*"/&gt;
		&lt;/behavior&gt;
	&lt;/table&gt;
&lt;/database&gt;</code></pre></li>
                                                                <li value="4">Perform database schema migration.
						<br />On your local development environment you may run:
						<pre><code class="language-PHP">
console transfer:generate
console propel:install
console transfer:generate</code></pre><br />When looking to generate a production migration, this command will help you find the SQL patches needed against your production schema.
						<pre><code class="language-PHP">vendor/bin/console propel:diff</code></pre><p class="tip">Before migrating a production database, always review each SQL statement individually, even when there are many of them.</p></li>
                                                                <li value="5">Perform&#160;Data Migration</li>
                                                                <br />For quick and smooth migration, we have prepared an example migration script.
						<br />This script will find a page and share it with every store. Your specific project may require customization, especially if you have special rules regarding sharing of pages per store or a collection of CmsPages larger than what can be stored in your migration server's available memory.
						<br />This script will only migrate pages to stores where persistence&#160;is shared.
					<div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Pyz\Zed\Cms\Communication\Console\CmsStoreToPageDataMigration.php</a></span><div class="MCDropDownBody dropDownBody"><pre><code class="language-PHP line-numbers">&lt;?php

/**
* Copyright © 2016-present Spryker Systems GmbH. All rights reserved.
* Use of this software requires acceptance of the Evaluation License Agreement. See LICENSE file.
*/

namespace Pyz\Zed\Cms\Communication\Console;

use Orm\Zed\Cms\Persistence\SpyCmsPageQuery;
use Orm\Zed\Cms\Persistence\SpyCmsPageStore;
use Orm\Zed\Store\Persistence\SpyStoreQuery;
use Propel\Runtime\Propel;
use Spryker\Zed\Kernel\Communication\Console\Console;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Output\OutputInterface;

/**
* @method \Spryker\Zed\CmsBlock\Communication\CmsBlockCommunicationFactory getFactory()
* @method \Spryker\Zed\CmsBlock\Business\CmsBlockFacade getFacade()
*/
class CmsStoreToPageDataMigration extends Console
{
	const COMMAND_NAME = 'cms-store-cms-page:migrate';
	const COMMAND_DESCRIPTION = 'Updates CMS page store relation by existing stores';
	const COMMAND_ARGUMENT_DRY_RUN = 'dry-run';

	/**
	* @param InputInterface $input
	* @param OutputInterface $output
	*
	* @return void
	*/
	public function execute(InputInterface $input, OutputInterface $output)
	{
		$connection = Propel::getConnection();

		$spyCmsPages = SpyCmsPageQuery::create()-&gt;find();
		$spyStores = SpyStoreQuery::create()-&gt;find();
		$output-&gt;writeln(sprintf('Count pages: %s', count($spyCmsPages)));
		$output-&gt;writeln(sprintf('Stores: %s', implode(', ', array_map(function(array $spyStore) {
		return $spyStore['Name'];
		}, $spyStores-&gt;toArray()))));

		foreach ($spyCmsPages as $spyCmsPage) {
			try {
				$connection-&gt;beginTransaction();

				foreach ($spyStores as $spyStore) {
					$spyCmsPageStore = new SpyCmsPageStore();
					$spyCmsPageStore-&gt;setSpyCmsPage($spyCmsPage);
					$spyCmsPageStore-&gt;setSpyStore($spyStore);
					$spyCmsPageStore-&gt;save();
				}

				$connection-&gt;commit();
			} catch (\Exception $exception) {
				$output-&gt;writeln('ERROR: ' . $exception-&gt;getMessage());
				$connection-&gt;rollBack();
			}
		}

		$output-&gt;writeln('Successfully finished.');
	}

	/**
	* @return void
	*/
	protected function configure()
	{
		parent::configure();

		$this-&gt;setName(static::COMMAND_NAME);
		$this-&gt;setDescription(static::COMMAND_DESCRIPTION);

		$this-&gt;addOption(
			static::COMMAND_ARGUMENT_DRY_RUN,
			null,
			InputOption::VALUE_REQUIRED,
			'Run without database changes'
		);
	}
}
					</code></pre></div></div><p class="tip">Don't forget to register your migration console command in&#160;<var>Pyz\Zed\Console\ConsoleDependencyProvider</var>.</p><br />Your command should be executable with
			<pre><code class="language-PHP">
$&#160;console cms-store-cms-page:migrate
			</code></pre><br />Don't forget to sync your newly updated Zed data with the storage tables.
			<pre><code class="language-PHP">
$&#160;console event:trigger -r cms_page
$&#160;console event:trigger -r cms_page_search
			</code></pre></ol>
                                                            <p><i>Estimated migration time:</i> <i>2 hours</i>.</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><div class="drop-anchor">Upgrading from Version 5. to Version 6.*</div></a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>CMS version 5.0 is responsible only for CMS pages and page versioning. CMS Block functionality became more flexible and moved to the <i>CmsBlock</i> module.</p>
                                                            <p>If you used CMS Blocks before, you need to migrate your data to the new structure.
    If you did not use CMS Blocks in your project, you can skip the migration process.</p>
                                                            <p>The migration process for CMS Block data is as follows:</p>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Install CMS Block module
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>To install the module, <var>"spryker/cms-block": "^1.0.0"</var> with Composer is required.</p>
                                                                </div>
                                                            </div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Perform database migration
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <ul>
                                                                        <li value="1"> <var>`vendor/bin/console propel:diff`</var>, also manual review is necessary for the generated migration file</li>
                                                                        <li value="2"> <var>`vendor/bin/console propel:migrate`</var></li>
                                                                        <li value="3"> <var>`vendor/bin/console propel:model:build`</var></li>
                                                                    </ul>
                                                                    <p>After running the last command you’ll find some new classes in your project under <var>\Orm\Zed\Cms\Persistence</var> namespace. It’s important to make sure that they are extending the base classes from the core, i.e.
<var>`Orm\Zed\Cms\Persistence\SpyCmsBlock</var> extends <var>Spryker\Zed\CmsBlock\Persistence\Propel\AbstractSpyCmsBlock`</var><var>`Orm\Zed\Cms\Persistence\SpyCmsBlockQuery</var> extends <var>Spryker\Zed\CmsBlock\Persistence\Propel\AbstractSpyCmsBlockQuery.`</var> </p>
                                                                    <p>The same is for <var>SpyCmsBlockGlossaryKeyMapping</var>, <var>SpyCmsBlockGlossaryKeyMappingQuery</var>, <var>SpyCmsBlockTemplate</var>, <var>SpyCmsBlockTemplateQuery</var>.</p>
                                                                </div>
                                                            </div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Move templates
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>Now your block and page templates can be found in <var>src/Pyz/Yves/Cms/Theme/default/template/*</var> or <var>src/Pyz/Shared/Cms/Theme/default/template/*</var> folders.</p>
                                                                    <p>Move CMS Block templates to the <var>src/Pyz/Shared/CmsBlock/Theme/default/template/*</var> folder.</p>
                                                                </div>
                                                            </div>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Run migration script
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody">
                                                                    <p>For quick and smooth migration, we have prepared a migration script. You can find it below.</p>
                                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><div class="drop-anchor">Click here to expand the code sample</div></a></span>
                                                                        <div class="MCDropDownBody dropDownBody"><pre><code class="language-PHP line-numbers">
&lt;?php

/**
 * Copyright © 2016-present Spryker Systems GmbH. All rights reserved.
 * Use of this software requires acceptance of the Evaluation License Agreement. See LICENSE file.
 */

namespace Pyz\Zed\CmsBlock\Communication\Console;

use Orm\Zed\Cms\Persistence\SpyCmsPage;
use Orm\Zed\Cms\Persistence\SpyCmsPageQuery;
use Orm\Zed\Cms\Persistence\SpyCmsTemplate;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlock;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlockGlossaryKeyMapping;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlockGlossaryKeyMappingQuery;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlockQuery;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlockTemplate;
use Orm\Zed\CmsBlock\Persistence\SpyCmsBlockTemplateQuery;
use Orm\Zed\CmsBlockCategoryConnector\Persistence\SpyCmsBlockCategoryConnector;
use Propel\Runtime\ActiveQuery\Criteria;
use Propel\Runtime\Propel;
use Spryker\Zed\Kernel\Communication\Console\Console;
use Spryker\Zed\Kernel\Locator;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Output\OutputInterface;

/**
 * @method \Spryker\Zed\CmsBlock\Communication\CmsBlockCommunicationFactory getFactory()
 * @method \Spryker\Zed\CmsBlock\Business\CmsBlockFacade getFacade()
 */
class CmsToCmsBlockDataMigration extends Console
{

    const COMMAND_NAME = 'cms-cms-block:migrate';
    const COMMAND_DESCRIPTION = 'Migrates CMS Block data from CMS module';
    const COMMAND_ARGUMENT_DRY_RUN = 'dry-run';

    const CMS_BLOCK_RELATION_TYPE_CATEGORY = 'category';

    /**
     * @param InputInterface $input
     * @param OutputInterface $output
     *
     * @return void
     */
    public function execute(InputInterface $input, OutputInterface $output)
    {
        $connection = Propel::getConnection();

        $spyCmsBlocks = SpyCmsBlockQuery::create()
            -&gt;filterByFkPage(null, Criteria::ISNOTNULL)
            -&gt;filterByFkTemplate(null, Criteria::ISNULL)
            -&gt;find();

        $spyCmsBlocksCount = count($spyCmsBlocks);

        $output-&gt;writeln(sprintf('Processing %s blocks...', $spyCmsBlocksCount));

        foreach ($spyCmsBlocks as $spyCmsBlock) {
            $spyCmsPage = SpyCmsPageQuery::create()
                -&gt;filterByIdCmsPage($spyCmsBlock-&gt;getFkPage())
                -&gt;findOne();

            try {
                $connection-&gt;beginTransaction();

                //Migration of template
                $spyCmsTemplate = $spyCmsPage-&gt;getCmsTemplate();
                $spyCmsBlockTemplate = $this-&gt;createCmsBlockTemplate($spyCmsTemplate);
                $spyCmsBlock-&gt;setFkTemplate($spyCmsBlockTemplate-&gt;getIdCmsBlockTemplate());

                //Migration of common data fields
                $spyCmsBlock-&gt;setValidFrom($spyCmsPage-&gt;getValidFrom());
                $spyCmsBlock-&gt;setValidTo($spyCmsPage-&gt;getValidTo());
                $spyCmsBlock-&gt;setIsActive($spyCmsPage-&gt;getIsActive());

                //Migration of category relation
                if ($spyCmsBlock-&gt;getType() === self::CMS_BLOCK_RELATION_TYPE_CATEGORY) {
                    if (!$this-&gt;isCategoryConnectorInstalled()) {
                        $output-&gt;writeln('To import relation to Category you need to install CmsBlockCategoryConnector module');
                        $connection-&gt;rollBack();
                        continue;
                    }

                    $this-&gt;createCmsBlockCategoryConnector($spyCmsBlock);
                }

                $spyCmsBlock-&gt;save();
                $this-&gt;migrateGlossary($spyCmsPage, $spyCmsBlock);

                $connection-&gt;commit();
            } catch (\Exception $exception) {
                $output-&gt;writeln('ERROR: ' . $exception-&gt;getMessage());
                $connection-&gt;rollBack();
            }
        }

        $output-&gt;writeln('Successfully finished.');
    }

    /**
     * @param \Orm\Zed\Cms\Persistence\SpyCmsTemplate $spyCmsTemplate
     *
     * @return \Orm\Zed\CmsBlock\Persistence\SpyCmsBlockTemplate
     */
    protected function createCmsBlockTemplate(SpyCmsTemplate $spyCmsTemplate)
    {
        $spyCmsBlockTemplate = SpyCmsBlockTemplateQuery::create()
            -&gt;filterByTemplatePath($spyCmsTemplate-&gt;getTemplatePath())
            -&gt;findOne();

        if (empty($spyCmsBlockTemplate)) {
            $spyCmsBlockTemplate = new SpyCmsBlockTemplate();
            $spyCmsBlockTemplate-&gt;setTemplateName($spyCmsTemplate-&gt;getTemplateName());
            $spyCmsBlockTemplate-&gt;setTemplatePath($spyCmsTemplate-&gt;getTemplatePath());
            $spyCmsBlockTemplate-&gt;save();
        }

        return $spyCmsBlockTemplate;
    }

    /**
     * @param SpyCmsBlock $spyCmsBlock
     *
     * @return SpyCmsBlockCategoryConnector
     */
    protected function createCmsBlockCategoryConnector(SpyCmsBlock $spyCmsBlock)
    {
        $spyCmsBlockRelation = new SpyCmsBlockCategoryConnector();
        $spyCmsBlockRelation-&gt;setFkCmsBlock($spyCmsBlock-&gt;getIdCmsBlock());
        $spyCmsBlockRelation-&gt;setFkCategory($spyCmsBlock-&gt;getValue());
        $spyCmsBlockRelation-&gt;save();

        return $spyCmsBlockRelation;
    }

    /**
     * @param SpyCmsPage $spyCmsPage
     * @param SpyCmsBlock $spyCmsBlock
     *
     * @return void
     */
    protected function migrateGlossary(SpyCmsPage $spyCmsPage, SpyCmsBlock $spyCmsBlock)
    {
        foreach ($spyCmsPage-&gt;getSpyCmsGlossaryKeyMappings() as $cmsGlossaryKeyMapping) {
            $exists = SpyCmsBlockGlossaryKeyMappingQuery::create()
                -&gt;filterByFkCmsBlock($spyCmsBlock-&gt;getIdCmsBlock())
                -&gt;filterByPlaceholder($cmsGlossaryKeyMapping-&gt;getPlaceholder())
                -&gt;exists();

            if (!$exists) {
                $spyCmsBlockGlossaryKeyMapping = new SpyCmsBlockGlossaryKeyMapping();
                $spyCmsBlockGlossaryKeyMapping-&gt;setFkCmsBlock($spyCmsBlock-&gt;getIdCmsBlock());
                $spyCmsBlockGlossaryKeyMapping-&gt;setFkGlossaryKey($cmsGlossaryKeyMapping-&gt;getFkGlossaryKey());
                $spyCmsBlockGlossaryKeyMapping-&gt;setPlaceholder($cmsGlossaryKeyMapping-&gt;getPlaceholder());
                $spyCmsBlockGlossaryKeyMapping-&gt;save();
            }
        }

    }


    /**
     * @return void
     */
    protected function configure()
    {
        parent::configure();

        $this-&gt;setName(static::COMMAND_NAME);
        $this-&gt;setDescription(static::COMMAND_DESCRIPTION);

        $this-&gt;addOption(
            static::COMMAND_ARGUMENT_DRY_RUN,
            null,
            InputOption::VALUE_REQUIRED,
            'Run without database changes'
        );
    }

    /**
     * @return bool
     */
    protected function isCategoryConnectorInstalled()
    {
        return class_exists(SpyCmsBlockCategoryConnector::class);
    }

}
        </code></pre>
                                                                        </div>
                                                                    </div>
                                                                    <p>Copy script to <var>src/Pyz/Zed/CmsBlock/Communication/Console/CmsToCmsBlockDataMigration.php</var> and register it in <var>Pyz\Zed\Console\ConsoleDependencyProvider</var>.</p><code class="php">
&lt;?php
namespace Pyz\Zed\Console;

class ConsoleDependencyProvider extends SprykerConsoleDependencyProvider
{
    public function getConsoleCommands(Container $container)
    {
        $commands = [
          ...
          CmsToCmsBlockDataMigration()
        ];

        ...
    }
}
</code>
                                                                    <p>Run the script with the command <var>vendor/bin/console cms-cms-block:migrate</var>.</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><div class="drop-anchor">Upgrading from Version 4.* to Version 5.*</div></a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>CMS Version 5.0 has a new concept for showing pages in the frontend. In previous CMS versions, after creating a CMS page and running the collectors, we were able to see the page in the frontend, but now this has changed. After creating a CMS page, another step  called <var>Publish</var> is needed to display the page in the frontend. Publish aggregates all CMS related data and puts it to our new CMS table <var>spy_cms_version</var>. The new collectors push this data to the frontend storage and search.</p>
                                                            <p class="important">Before upgrading, make sure that you do not use any deprecated code from version 3|4.*. Check the description of the deprecated code (inside the code) to see what you will need to use instead.</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" /><div class="drop-anchor">Database Migration</div></a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>To start Database migration, run the following commands:</p>
                                                            <ul>
                                                                <li value="1"><var>vendor/bin/console propel:diff</var>, manual review is necessary for the generated migration file.</li>
                                                                <li value="2"><var>vendor/bin/console propel:migrate</var>
                                                                </li>
                                                                <li value="3"><var>vendor/bin/console propel:model:build</var>
                                                                </li>
                                                            </ul>
                                                            <p>After running the last command, you will find some new classes in your project under the <var>\Orm\Zed\Cms\Persistence</var> namespace. It is important to make sure that they are extending the base classes from the core, i.e.</p>
                                                            <ul>
                                                                <li value="1"><var>Orm\Zed\Cms\Persistence\SpyCmsVersion</var> extends <var>Spryker\Zed\Cms\Persistence\Propel\SpyCmsVersion</var>,</li>
                                                                <li value="2"><var>Orm\Zed\Cms\Persistence\SpyCmsVersionQuery</var> extends <var>Spryker\Zed\Cms\Persistence\Propel\SpyCmsVersionQuery</var></li>
                                                            </ul>
                                                            <h3>CMS Templates</h3>
                                                            <p>In this version we have moved all CMS templates to the <var>Shared</var> layer instead of only <var>Yves</var>, but you are still able to use the old files.</p>
                                                            <p><var>src/Pyz/Yves/Cms/Theme/default/template/* </var>=&gt; <var>src/Pyz/Shared/Cms/Theme/default/template/*</var></p>
                                                            <h3>CMS Twig Functions</h3>
                                                            <p>The <var>TwigCms</var> function has been improved to provide better speed and performance, it will only send query to Redis when the translations are not available. </p>
                                                            <p>You can still work with the current version although upgrading is highly recommended.</p>
                                                            <p>You can find it here: <var>src/Pyz/Yves/Cms/Plugin/TwigCms.php</var></p>
                                                            <h3>CMS Collector</h3>
                                                            <p style="text-align: left;">To push new CMS version data to the frontend storage and search, add it to <var>src/Pyz/Zed/Collector/CollectorDependencyProvider.php</var> plugin stack:</p>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Click to expand the code sample
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody"><pre><code class="language-PHP line-numbers">    &lt;?php
    ...

    use Spryker\Zed\CmsCollector\Communication\Plugin\CmsVersionPageCollectorSearchPlugin;
    use Spryker\Zed\CmsCollector\Communication\Plugin\CmsVersionPageCollectorStoragePlugin;

    class CollectorDependencyProvider extends SprykerCollectorDependencyProvider
    {
    ...
        $container[self::SEARCH_PLUGINS] = function (Container $container) {
          return [
              ...
              CmsConstants::RESOURCE_TYPE_PAGE =&gt; new CmsVersionPageCollectorSearchPlugin(),
          ];
        };

          ...

        $container[self::STORAGE_PLUGINS] = function (Container $container) {
           return [
                ...
                CmsConstants::RESOURCE_TYPE_PAGE =&gt; new CmsVersionPageCollectorStoragePlugin(),
                ...
           ];
    };

    ...
    ?&gt;
</code></pre>
                                                                </div>
                                                            </div>
                                                            <h3>CMS User Interaction</h3>
                                                            <p>When a CMS page is published, we also store/show user information for this action. To store and show user information, register two new plugins from the new <var>CmsUserConnector</var> module.</p>
                                                            <p>Add them here: <var>src/Pyz/Zed/Cms/CmsDependencyProvider.php</var></p>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Click to expand the code sample
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody"><pre><code class="language-PHP line-numbers">&lt;?php
namespace Pyz\Zed\Cms;

use Spryker\Zed\Cms\CmsDependencyProvider as SprykerCmsDependencyProvider;
use Spryker\Zed\CmsUserConnector\Communication\Plugin\UserCmsVersionPostSavePlugin;
use Spryker\Zed\CmsUserConnector\Communication\Plugin\UserCmsVersionTransferExpanderPlugin;
use Spryker\Zed\Kernel\Container;

class CmsDependencyProvider extends SprykerCmsDependencyProvider
{

    protected function getPostSavePlugins(Container $container)
    {
        return [
            new UserCmsVersionPostSavePlugin()
        ];
    }

    protected function getTransferExpanderPlugins(Container $container)
    {
        return [
            new UserCmsVersionTransferExpanderPlugin()
        ];
    }
}
?&gt;</code></pre>
                                                                </div>
                                                            </div>
                                                            <h3>CMS Data Importer</h3>
                                                            <p>To publish pages after importing, add this to your CMS Importer class:</p>
                                                            <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />
                            Click to expand the code sample
                        </a></span>
                                                                <div class="MCDropDownBody dropDownBody"><pre><code class="language-PHP line-numbers">    &lt;?php

    /**
     * @param array $data
     *
     * @return void
     */
    protected function importOne(array $data)
    {
        $page = $this-&gt;format($data);
        $templateTransfer = $this-&gt;findOrCreateTemplate($page[self::TEMPLATE]);

        $pageTransfer = $this-&gt;createPage($templateTransfer, $page);

        foreach ($this-&gt;localeFacade-&gt;getLocaleCollection() as $locale =&gt; $localeTransfer) {
            $urlTransfer = new UrlTransfer();
            $urlTransfer-&gt;setUrl($page[self::LOCALES][$locale][self::URL]);

            if ($this-&gt;urlFacade-&gt;hasUrl($urlTransfer)) {
                return;
            }

            $placeholders = $page[self::LOCALES][$locale][self::PLACEHOLDERS];

            $this-&gt;createPageUrl($pageTransfer, $urlTransfer-&gt;getUrl(), $localeTransfer);
            $this-&gt;createPlaceholder($placeholders, $pageTransfer, $localeTransfer);
        }

        $this-&gt;cmsFacade-&gt;publishWithVersion($pageTransfer-&gt;getIdCmsPage()); // Publishing the pages
    }
    ?&gt;    </code></pre>
                                                                </div>
                                                            </div>
                                                            <h3>Publishing Current Pages</h3>
                                                            <p>To publish current pages, create a console command that calls the following method:</p><pre><code class="language-PHP line-numbers">    &lt;?php

    protected function publishAllPages()
    {
        $spyCmsPagesEntities = SpyCmsPageQuery::create()-&gt;find();

        foreach ($spyCmsPagesEntities as $spyCmsPagesEntity) {
            $this-&gt;cmsFacade-&gt;publishWithVersion($spyCmsPagesEntity-&gt;getIdCmsPage());
        }
    ?&gt;
    </code></pre>
                                                            <hr class="noteInDiv" width="100%" size="0" align="center" />
                                                            <h2>Upgrading from Version 2.* to Version 3.*</h2>
                                                            <p>We have extended CMS pages with localized attributes such as name and HTML meta header information. Also CMS pages can now be marked as searchable. These changes required some changes in the database.</p>
                                                            <ol>
                                                                <li value="1">Before upgrading to the new version, make sure that you do not use any deprecated code from version 2.*. Check the description of the deprecated code to see what you will need to use instead.</li>
                                                                <li value="2">Database migration<ol><li value="1"><var>vendor/bin/console propel:diff</var>, also manual review is necessary for the generated migration file.</li><li value="2"><var>vendor/bin/console propel:migrate</var></li><li value="3"><var>vendor/bin/console propel:model:build</var></li><li value="4">After running the last command you’ll find some new classes in your project under <var>\Orm\Zed\Cms\Persistence</var> namespace. It’s important to make sure that they are extending the base classes from the core, i.e.<ul style="list-style-type: circle;"><li class="bullet_list" value="1"><var>Orm\Zed\Cms\Persistence\SpyCmsPageLocalizedAttributes extends Spryker\Zed\Cms\Persistence\Propel\AbstractSpyCmsPageLocalizedAttributes,</var></li><li class="bullet_list" value="2"><var>Orm\Zed\Cms\Persistence\SpyCmsPageLocalizedAttributesQuery</var> extends <var>Spryker\Zed\Cms\Persistence\Propel\AbstractSpyCmsPageLocalizedAttributesQuery</var>.</li></ul></li></ol></li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                    <p><b>See also:</b>
                                                    </p>
                                                    <ul>
                                                        <li value="1"><a href="https://documentation.spryker.com/administration_interface_guide/content_management/pages-201903.htm">Learn how to use CMS</a>
                                                        </li>
                                                        <li value="2"><a href="mg-cms-block.htm">Learn how to migrate CMS Block</a>
                                                        </li>
                                                        <li value="3"><a href="mg-cms-block-gui.htm">Learn how to migrate CMS Block GUI</a>
                                                        </li>
                                                        <li value="4"><a href="mg-cms-block-collector.htm">Learn how to migrate CMS Block Collector</a>
                                                        </li>
                                                        <li value="5"><a href="mg-cms-block-category-connector-console.htm">Learn how to migrate CMS Block Category Connector</a>
                                                        </li>
                                                        <li value="6"><a href="mg-cms-collector.htm">Learn how to migrate CMS Collector</a>
                                                        </li>
                                                    </ul>
                                                    <p>&#160;</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><a class="scroll-top js-scroll-top" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="#FFF" fill-rule="nonzero" d="M11.82 5.22a.54.54 0 0 1 0 .806.636.636 0 0 1-.852 0L6.607 1.937v13.49a.587.587 0 0 1-.602.573c-.336 0-.611-.258-.611-.573V1.937L1.04 6.026a.647.647 0 0 1-.86 0 .54.54 0 0 1 0-.807L5.573.163a.636.636 0 0 1 .852 0L11.82 5.22z" /></svg></a>
                                <script>/* <![CDATA[ */
			function createGithubUrl() {
			var GITHUB_CONTENT_PATH = '/blob/master/public';
			var link = document.querySelector('.js-widget-github-link');
			var href =
			link.getAttribute('href')
			+ GITHUB_CONTENT_PATH
			+ window.location.pathname;
			link.setAttribute('href', href);
			}
			createGithubUrl();
		/* ]]> */</script>
                                <script>/* <![CDATA[ */
			requirejs.config({
				appDir: '',
				paths: {
					'clipboard': ['https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min']
					
				}
			});
			require(['clipboard'], function(Clipboard) {
				console.log(Clipboard);
				window.Clipboard = Clipboard;
			});
		/* ]]> */</script>
                                <script src="../resources/scripts/perfect-scrollbar.js">
                                </script>
                                <script src="../resources/scripts/imagemapster.js">
                                </script>
                                <script src="../resources/scripts/script.js">
                                </script>
                                <script src="../resources/scripts/prism.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>
