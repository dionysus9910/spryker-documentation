<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.B2B,ReleaseVersions.2018-10">
    <head><title>Merchant Product Restrictions Feature Integration | Spryker</title>
        <link href="../Resources/TableStyles/PatternedRows2.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <meta name="description" content="Merchant Product Restrictions allows setting access to particular products. This guide describes the process of integrating the feature into a project." />
    </head>
    <body>
        <h1>Merchant Product Restrictions Feature Integration <img src="../Resources/Images/shoptype/B2B_Shop.png" /></h1>
        <MadCap:menuProxy data-mc-skin="/Project/Skins/SideMenuNotFixed.flskn" mc-linked-toc="$topicHeadings" style="mc-context-sensitive: True;mc-include-parent: True;mc-include-siblings: True;mc-include-children: True;" />
        <h2>Install Feature Core</h2>
        <h3>Prerequisites</h3>
        <p>
			To start feature integration, overview and install the necessary features:
		</p>
        <div class="table-wrap">
            <table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
                <thead>
                    <tr class="TableStyle-PatternedRows2-Head-Header1">
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Name</th>
                        <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Version</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-PatternedRows2-Body-LightRows">
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">Product Lists</td>
                        <td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows">2018.11.0</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <h3>1) Install the Required Modules Using Composer</h3>
        <p>
			Run the following command(s) to install the required modules:
		</p><pre><code class="language-PHP line-numbers">composer require spryker-feature/merchant-product-restrictions:"^2018.11.0" --update-with-dependencies</code></pre>
        <div class="tip">
			Make sure that the following modules were installed:
				<div class="table-wrap"><table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0"><thead><tr class="TableStyle-PatternedRows2-Head-Header1"><th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Module</th><th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Expected Directory</th></tr></thead><tbody><tr class="TableStyle-PatternedRows2-Body-LightRows"><td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">MerchantRelationshipProductList</td><td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows"><var>vendor/spryker/merchant-relationship-product-list</var></td></tr><tr class="TableStyle-PatternedRows2-Body-DarkerRows"><td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">MerchantRelationshipProductListDataImport</td><td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows"><var>vendor/spryker/merchant-relationship-product-list-data-import</var></td></tr><tr class="TableStyle-PatternedRows2-Body-LightRows"><td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">MerchantRelationshipProductListGui</td><td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows"><var>vendor/spryker/merchant-relationship-product-list-gui</var></td></tr></tbody></table></div></div>
        <h3>2) Set up database schema</h3>
        <p>
			Run the following commands to apply database changes, as well as generate entity and transfer changes:
		</p><pre><code class="language-PHP line-numbers">
	console transfer:generate
	console propel:install
	console transfer:generate
		</code></pre>
        <div class="tip">Make sure that the following changes have been applied by checking your database.
			<div class="table-wrap"><table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0"><thead><tr class="TableStyle-PatternedRows2-Head-Header1"><th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Database entity</th><th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Type</th><th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Event</th></tr></thead><tbody><tr class="TableStyle-PatternedRows2-Body-LightRows"><td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">spy_product_list.fk_merchant_relationship</td><td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">column</td><td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows">created</td></tr></tbody></table></div></div>
        <h3>3) Import Data</h3>
        <h4>Import merchant relationship to product lists</h4>
        <p>
			Prepare your data according to your requirements using our demo data:
		</p><pre><code class="language-PHP line-numbers">
	merchant_relation_key,product_list_key
	mr-008,pl-001
	mr-008,pl-002
	mr-008,pl-003
	mr-009,pl-004
	mr-010,pl-005
	mr-011,pl-006
	mr-011,pl-007
	mr-011,pl-008
		</code></pre>
        <div class="table-wrap">
            <table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
                <thead>
                    <tr class="TableStyle-PatternedRows2-Head-Header1">
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Column</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Is obligatory?</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Data type</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Data example</th>
                        <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Data explanation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-PatternedRows2-Body-LightRows">
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">merchant_relation_key</td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">mandatory</td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">string</td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">mr-008</td>
                        <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">Identifier of merchant relations. The merchant relations must exist already.</td>
                    </tr>
                    <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">product_list_key</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">mandatory</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">string</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">pl-001</td>
                        <td class="TableStyle-PatternedRows2-BodyA-Regular-DarkerRows">Identifier of product lists. The product lists must exist already.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p>
			Register the following plugin to enable data import:
		</p>
        <div class="table-wrap">
            <table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
                <thead>
                    <tr class="TableStyle-PatternedRows2-Head-Header1">
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Plugin</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Specification</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Prerequisites</th>
                        <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Namespace</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-PatternedRows2-Body-LightRows">
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">MerchantRelationshipProductListDataImportPlugin</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">Imports basic product list data into the database.</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">
                            <ul class="disk">
                                <li>Merchant relations must be imported first.</li>
                                <li>Product lists must be imported first.</li>
                            </ul>
                        </td>
                        <td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows"><var>Spryker\Zed\MerchantRelationshipProductListDataImport\Communication\Plugin</var>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p style="font-weight: normal;"><var style="font-weight: normal;">src/Pyz/Zed/DataImport/DataImportDependencyProvider.php</var>
        </p><pre><code class="language-PHP line-numbers">
	&lt;?php
   
	namespace Pyz\Zed\DataImport;
   
	use Spryker\Zed\DataImport\DataImportDependencyProvider as SprykerDataImportDependencyProvider;
	use Spryker\Zed\MerchantRelationshipProductListDataImport\Communication\Plugin\MerchantRelationshipProductListDataImportPlugin;
   
	class DataImportDependencyProvider extends SprykerDataImportDependencyProvider
	{
		/**
		* @return array
		*/
		protected function getDataImporterPlugins(): array
		{
			return [
				new MerchantRelationshipProductListDataImportPlugin(),
			];
		}
	}
		</code></pre>
        <p>
			Run the following console command to import data:
		</p><pre><code class="language-PHP line-numbers">console data:import merchant-relationship-product-list</code></pre>
        <div class="tip">Make sure that the configured data are added to the spy_product_list table in the database.</div>
        <h3>4) Set up behaviour</h3>
        <p>
			Activate the following plugins:
		</p>
        <div class="table-wrap">
            <table style="mc-table-style: url('../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
                <thead>
                    <tr class="TableStyle-PatternedRows2-Head-Header1">
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Plugin</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Specification</th>
                        <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Prerequisites</th>
                        <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Namespace</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-PatternedRows2-Body-LightRows">
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">ProductListCustomerTransferExpanderPlugin</td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                            <ul>
                                <li>Expands the customer transfer object with their assigned product lists.</li>
                                <li>The product list information is based on the customer's merchant relationship.</li>
                            </ul>
                        </td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">None</td>
                        <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows"><var>Spryker\Zed\MerchantRelationshipProductList\Communication\Plugin\Customer</var>
                        </td>
                    </tr>
                    <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">MerchantRelationshipProductListOwnerTypeFormExpanderPlugin</td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                            <ul>
                                <li>Provides the merchant relationship product list owner type.</li>
                                <li>Provides selectable merchant relationship options to assign to product lists.</li>
                            </ul>
                        </td>
                        <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">None</td>
                        <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows"><var>Spryker\Zed\MerchantRelationshipProductListGui\Communication\Plugin\ProductListGuiExtension</var>
                        </td>
                    </tr>
                    <tr class="TableStyle-PatternedRows2-Body-LightRows">
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">MerchantRelationshipTableExpanderPlugin</td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">
                            <ul>
                                <li>Provides table header, config and data extensions for product lists with merchant relationship owner type.</li>
                            </ul>
                        </td>
                        <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">None</td>
                        <td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows"><var>Spryker\Zed\MerchantRelationshipProductListGui\Communication\Plugin\ProductListGuiExtension</var>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p><var style="font-weight: normal;">src/Pyz/Zed/Customer/CustomerDependencyProvider.php</var>
        </p><pre><code class="language-PHP line-numbers">
	&lt;?php
 
	namespace Pyz\Zed\Customer;
 
	use Spryker\Zed\Customer\CustomerDependencyProvider as SprykerCustomerDependencyProvider;
	use Spryker\Zed\MerchantRelationshipProductList\Communication\Plugin\Customer\ProductListCustomerTransferExpanderPlugin;
 
	class CustomerDependencyProvider extends SprykerCustomerDependencyProvider
	{
		/**
		* @return \Spryker\Zed\Customer\Dependency\Plugin\CustomerTransferExpanderPluginInterface[]
		*/
		protected function getCustomerTransferExpanderPlugins()
		{
			return [
				new ProductListCustomerTransferExpanderPlugin(),
			];
		}
	}
		</code></pre>
        <p><var style="font-weight: normal;">src/Pyz/Zed/ProductListGui/ProductListGuiDependencyProvider.php</var>
        </p><pre><code class="language-PHP line-numbers">
	&lt;?php
 
	namespace Pyz\Zed\ProductListGui;
 
	use Spryker\Zed\MerchantRelationshipProductListGui\Communication\Plugin\ProductListGuiExtension\MerchantRelationshipProductListOwnerTypeFormExpanderPlugin;
	use Spryker\Zed\MerchantRelationshipProductListGui\Communication\Plugin\ProductListGuiExtension\MerchantRelationshipTableExpanderPlugin;
	use Spryker\Zed\ProductListGui\ProductListGuiDependencyProvider as SprykerProductListGuiDependencyProvider;
 
	class ProductListGuiDependencyProvider extends SprykerProductListGuiDependencyProvider
	{
		/**
		* @return \Spryker\Zed\ProductListGuiExtension\Dependency\Plugin\ProductListOwnerTypeFormExpanderPluginInterface[]
		*/
		protected function getProductListOwnerTypeFormExpanderPlugins(): array
		{
			return [
				new MerchantRelationshipProductListOwnerTypeFormExpanderPlugin(),
			];
		}
 
		/**
		* @return \Spryker\Zed\ProductListGuiExtension\Dependency\Plugin\ProductListTableConfigExpanderPluginInterface[]
		*/
		protected function getProductListTableConfigExpanderPlugins(): array
		{
			return [
				new MerchantRelationshipTableExpanderPlugin(),
			];
		}
 
		/**
		* @return \Spryker\Zed\ProductListGuiExtension\Dependency\Plugin\ProductListTableDataExpanderPluginInterface[]
		*/
		protected function getProductListTableDataExpanderPlugins(): array
			{
			return [
				new MerchantRelationshipTableExpanderPlugin(),
			];
		}
 
		/**
		* @return \Spryker\Zed\ProductListGuiExtension\Dependency\Plugin\ProductListTableDataExpanderPluginInterface[]
		*/
		protected function getProductListTableHeaderExpanderPlugins(): array
		{
			return [
				new MerchantRelationshipTableExpanderPlugin(),
			];
		}
	}		
		</code></pre>
        <div class="tip">
			Make sure that when creating or editing a product list in Zed, you can select the merchant relationship as an owner type and see the selected value in the list of product lists.<br /><br />			Also make sure that when a customer (with an assigned merchant relationship that has assigned product lists) logs in, they see products only according to their product list restrictions.
		</div>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <p><a href="https://documentation.spryker.com/capabilities/product_management/product-restrictions.htm">Product Restrictions Overview</a>
        </p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p><i>Last review date: Dec. 06th, 2018</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Tamás Nyulas, Yuliia Boiko</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>