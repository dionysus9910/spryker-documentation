<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="3332" MadCap:lastWidth="1453" style="">
    <head>
    </head>
    <body>
        <h1>Feature Integration - Product Group</h1>
        <h2>Prerequisites</h2>
        <ol>
            <li>To prepare your project to work with Product groups:</li>
            <li>Require the Product Group bundles in your <var>composer</var>.json by running composer require <var>spryker/product-group spryker/product-group-collector</var>.</li>
            <li>Install the new database tables. By running <var>vendor/bin/console propel:diff</var>. Propel should generate a migration file with the changes.</li>
            <li>Apply the database changes: run <var>vendor/bin/console propel:migrate</var>.</li>
            <li>Generate ORM models: run <var>vendor/bin/console propel:model:build</var>.<ul><li class="bullet_list">After running this command you’ll find some new classes in your project under <var>\Orm\Zed\ProductGroup\Persistence</var> namespace. It’s important that you make sure that they extend the base classes from the Spryker core, e.g.:</li><li class="bullet_list"><var>\Orm\Zed\ProductGroup\Persistence\SpyProductGroup</var> extends \<var>Spryker\Zed\ProductGroup\Persistence\Propel\AbstractSpyProductGroup</var></li><li class="bullet_list"><var>\Orm\Zed\ProductGroup\Persistence\SpyProductAbstractGroup </var>extends <var>\Spryker\Zed\ProductGroup\Persistence\Propel\AbstractSpyProductAbstractGroup</var></li><li class="bullet_list"><var>\Orm\Zed\ProductGroup\Persistence\SpyProductGroupQuery</var> extends <var>\Spryker\Zed\ProductGroup\Persistence\Propel\AbstractSpyProductGroupQuery</var></li><li class="bullet_list"><var>\Orm\Zed\ProductGroup\Persistence\SpyProductAbstractGroupQuery</var> extends <var>\Spryker\Zed\ProductGroup\Persistence\Propel\AbstractSpyProductAbstractGroupQuery</var></li></ul></li>
            <li>Run <var>vendor/bin/console transfer:generate</var> to get the new transfer objects.</li>
            <li>Activate the product group collectors by adding the <var>ProductGroupCollectorStoragePlugin </var>and the <var>ProductAbstractGroupsCollectorStoragePlugin </var>to the storage collector plugin stack, see example below:</li>
        </ol><pre><code class="language-PHP line-numbers">&lt;?php

namespace Pyz\Zed\Collector;

use Spryker\Shared\ProductGroup\ProductGroupConfig;
use Spryker\Zed\Kernel\Container;
use Spryker\Zed\ProductGroupCollector\Communication\Plugin\ProductAbstractGroupsCollectorStoragePlugin;
use Spryker\Zed\ProductGroupCollector\Communication\Plugin\ProductGroupCollectorStoragePlugin;
// ...

class CollectorDependencyProvider extends SprykerCollectorDependencyProvider
{
    /**
     * @param \Spryker\Zed\Kernel\Container $container
     *
     * @return \Spryker\Zed\Kernel\Container
     */
    public function provideBusinessLayerDependencies(Container $container)
    {
        // ...
       
        $container[self::STORAGE_PLUGINS] = function (Container $container) {
            return [
                // ...
                ProductGroupConfig::RESOURCE_TYPE_PRODUCT_GROUP =&gt; new ProductGroupCollectorStoragePlugin(),
                ProductGroupConfig::RESOURCE_TYPE_PRODUCT_ABSTRACT_GROUPS =&gt; new ProductAbstractGroupsCollectorStoragePlugin(),
            ];
        };
        
        // ...
    }
}</code></pre>
        <h2>Data Setup</h2>
        <p>You should now be able to use the Zed API of ProductGroup module to manage product groups, and the collectors should also be able to export them to the KV storage. This is a good time to implement an installer in your project to group products in a way how you’ll want to show them in your shop frontend. Check out our <a href="https://github.com/spryker/demoshop">Demoshop implementation</a> for examples and ideas.</p>
        <h2>Usage in Yves</h2>
        <p>The KV storage should by now have some product groups we can display in our frontend.</p>
        <p>The ProductGroup module is shipped with a twig extension that provides the <var>spyProductGroupItems()</var> twig function. This function collects necessary data from the KV storage and renders it in the specified way.</p>
        <p><var>spyProductGroupItems()</var> accepts two parameters:</p>
        <ol>
            <li><strong>$idProductAbstract</strong>: Reference of an abstract product by its ID field.</li>
            <li><strong>$template</strong>: Template path used to render the product group items (i.e. "<var>@ProductGroup/partials/product-group-items.twig</var>").</li>
        </ol>
        <p>To enable this twig function, you’ll need to register <var>\Spryker\Yves\ProductGroup\Plugin\Provider\ProductGroupTwigServiceProvider</var> in your application’s bootstrap.</p><pre><code class="language-PHP line-numbers">&lt;?php

namespace Pyz\Yves\Application;

use Spryker\Yves\ProductGroup\Plugin\Provider\ProductGroupTwigServiceProvider;
// ...

class YvesBootstrap
{
    /**
     * @return void
     */
    protected function registerServiceProviders()
    {
        // ...
        $this-&gt;application-&gt;register(new ProductGroupTwigServiceProvider());
    }
}</code></pre>
        <p>Example, of rendering product group items in a Yves twig template (i.e. on catalog and product detail pages):</p><pre>{{ spyProductGroupItems(idProductAbstract, '@ProductGroup/partials/product-group-items.twig') }}</pre>
        <h2>Rendering Product Group Items Templates</h2>
        <p>The templates used to render product group items use the <var>productGroupItems </var>template variable. The variable is an array that contains abstract products from the same group(s) that the subject product is in. The abstract products are read from the KV storage (as they were stored by the storage product collector) for the current locale.</p>
        <p>The following code examples show the Demoshop implementation of how to render product group items. Our demo products have a <var>colorCode </var>attribute that we use as the group item selector in the shop. You could use any other attribute as well for group selector.</p>
        <p>In <var>Pyz/Yves/ProductGroup/Theme/default/partials/product-group-items.twig</var> we simply traverse the product group items and display a list of links to the PDP of each product in the group. The links represent the color of each product.</p><pre><code class="language-PHP line-numbers">{% block content %}
    {% if productGroupItems|length %}
        &lt;div data-component="product-group"&gt;
            &lt;ul class="product-group"&gt;
                {% for productGroupItem in productGroupItems %}
                    &lt;li data-product-group-item-preview="{{ productGroupItem.imageSets.default[0].externalUrlSmall }}"&gt;
                        &lt;a href="{{ productGroupItem.url }}" {% if productGroupItem.colorCode %}style="background-color: {{ productGroupItem.colorCode }};"{% endif %}&gt;&lt;/a&gt;
                    &lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        &lt;/div&gt;
    {% endif %}
{% endblock %}</code></pre>
        <p>In the catalog pages of our Demoshop we also added custom styling and Javascript to display the image of an item on mouseover, but what and how you want to display for each item in the group is entirely up to your implementation.</p>
    </body>
</html>