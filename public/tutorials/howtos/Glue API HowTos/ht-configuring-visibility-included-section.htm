<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="ReleaseVersions.2019-03">
    <head>
        <link href="../../../Resources/TableStyles/PatternedRows2.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Configuring Visibility of the Included Section | Spryker</title>
        <meta name="description" content="This guides provides step-by-step instructions on how to configure the visibility of the included section of REST responses in Spryker Glue API." />
    </head>
    <body>
        <h1>Configuring Visibility of the Included Section</h1>
        <p>
            Responses of Spryker Glue REST API can return the&#160;<b>included</b>&#160;and <b>relationships</b> sections. The sections contain additional information on the resource requested. Such information is presented in the form of related resources. For example, 
            if you request information on products, the sections can include such additional related resources as image sets, prices, availability information etc.
        </p>
        <p class="info">For more details, see <a href="https://jsonapi.org/format/#document-compound-documents" target="_blank">Compound Documents</a>.</p>
        <p>You can decide whether Glue REST API includes the sections in all responses by default:</p>
        <ul>
            <li>If you <b>enable</b> the option,&#160;API endpoints return all related resources by default. With the help of the&#160;<i>include</i> query string you can filter out the unnecessary included resources and request only the information you need.</li>
            <li>If you&#160;<b>disable</b> the option, responses of API endpoints do not contain the&#160;<i>included</i>&#160;and <i>relationships&#160;</i>sections unless you specify the related resources you need via the&#160;<i>include</i> query string. When the string is specified, only the resources passed by it are returned.</li>
        </ul>
        <table style="mc-table-style: url('../../../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
            <tbody>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <th class="TableStyle-PatternedRows2-BodyE-Regular-LightRows"> </th>
                    <th class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">Request with 'include' query string</th>
                    <th class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">Request without 'include' query string</th>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <th class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>&#160;</p>
                    </th>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p style="text-align: center;">Example:</p>
                        <p style="text-align: center;"><i>/concrete-products/177_24867659?<b>include=concrete-product-image-sets</b></i>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p style="text-align: center;">Example:</p>
                        <p style="text-align: center;"><i>/concrete-products/177_24867659</i>
                        </p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows"><b>Enabled</b>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">The&#160;<b>included</b>&#160;and <b>relationships</b> sections contain only the resources whose names were passed in the query string (resource <i>concrete-product-image-sets</i> per the example).</td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows" rowspan="2">The&#160;<i>included</i> section contains&#160;<b>all</b>&#160;the included resources (if any). </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows"><b>Disabled</b>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">The response <b>does not</b> contain the&#160;<i>included</i> section with related resources.</td>
                </tr>
            </tbody>
        </table>
        <p>
            By default, the option is <b>enabled</b>&#160;on the Spryker Core level, but&#160;<b>disabled</b> on the project level in 
            all <a href="https://documentation.spryker.com/about_spryker/understanding_spryker/demoshops.htm">Spryker Demo Shops</a> (<i>B2B Demo Shop</i>, <i>B2C&#160;Demo Shop</i> and <i>Master Shop Suite</i>).
        </p>
        <p class="info">
            For the purposes of boosting the API performance and bandwidth usage optimization, it is recommended to request only the information you need.
        </p>
        <p>
            To configure the behavior of the <i>included</i>&#160;and <i>relationships&#160;</i>sections:
        </p>
        <h2>Prerequisites</h2>
        <p>
            To make the option possible, you need to have at least version <b>1.12.0</b> of <i>GlueApplication</i>&#160;module installed in your project. For details on how to upgrade, 
            see the Integration Guide.
        </p>
        <h2>Configuration</h2>
        <p>
            To configure the behavior of the sections:
        </p>
        <ol>
            <li>Open or create file&#160;<var>Pyz\Glue\GlueApplication\GlueApplicationConfig.php</var> on your project level.</li>
            <li>Set the value of the&#160;<var>getIsEagerRelatedResourcesInclusionEnabled</var> parameter according to the desired behavior:
                <ul><li><b>true</b> - to enable related resources everywhere;</li><li><b>false</b>&#160;- to return&#160;related resources per request only.</li></ul><p><b>Sample Implementation:</b></p><pre><code class="language-PHP line-numbers">&lt;?php

namespace Pyz\Glue\GlueApplication;

use Spryker\Glue\CartsRestApi\CartsRestApiConfig;
use Spryker\Glue\GlueApplication\GlueApplicationConfig as SprykerGlueApplicationConfig;

class GlueApplicationConfig extends SprykerGlueApplicationConfig
{
    ...
    
    /**
     * @return bool
     */
    public function isEagerRelationshipsLoadingEnabled(): bool
    {
        return false;
    }
}</code></pre></li>
            <li>Save the file.</li>
        </ol>
        <h2>Verification</h2>
        <p>
            To verify that the configuration has been completed successfully:</p>
        <ol>
            <li>Send a <i>GET</i> request as follows:<br /><i>http://mysprykershop.com/concrete-products/177_24867659?<b>include=concrete-product-image-sets</b></i></li>
            <li>
                <p>Make sure that the&#160;<i>included</i>&#160;and <i>relationships</i>&#160;sections of the response contain the&#160;<i>concrete-product-image-sets</i> resource <b>only</b>.</p>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot>Sample response</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody><pre><code class="language-Json line-numbers">{
  data: {
    type: concrete-products,
    id: 177_24867659,
    attributes: {...},
    links: {...},
    relationships: {
      concrete-product-image-sets: {
        data: [
          {
            type: concrete-product-image-sets,
            id: 177_24867659
          }
        ]
      }
    }
  },
  included: [
    {
      type: concrete-product-image-sets,
      id: 177_24867659,
      attributes: {
        imageSets: [
          {
            name: default,
            images: [
              {
                externalUrlLarge: //images.icecat.biz/img/norm/high/24867659-4916.jpg,
                externalUrlSmall: //images.icecat.biz/img/norm/medium/24867659-4916.jpg
              }
            ]
          }
        ]
      },
      links: {
        self: http://mysprykershop.com/concrete-products/177_24867659/concrete-product-image-sets
      }
    }
  ]
}</code></pre>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>Send a <i>GET</i> request as follows:<br /><i>http://mysprykershop.com/concrete-products/177_24867659</i></li>
            <li>
                <p>
                        Make sure that the endpoint responds in accordance with your configuration:
                    </p>
                <ul>
                    <li>
                        <p>if the <var>getIsEagerRelatedResourcesInclusionEnabled</var> parameter is set to&#160;<b>true</b>,&#160;the&#160;<i>included</i> section of the response contains all related resources.</p>
                        <MadCap:dropDown>
                            <MadCap:dropDownHead>
                                <MadCap:dropDownHotspot>Sample response</MadCap:dropDownHotspot>
                            </MadCap:dropDownHead>
                            <MadCap:dropDownBody><pre><code class="language-Json line-numbers">{
  data: {
    type: concrete-products,
    id: 177_24867659,
    attributes: {...},
    links: {...},
    relationships: {
      concrete-product-image-sets: {
        data: [
          {
            type: concrete-product-image-sets,
            id: 177_24867659
          }
        ]
      },
      concrete-product-availabilities: {
        data: [
          {
            type: concrete-product-availabilities,
            id: 177_24867659
          }
        ]
      },
      concrete-product-prices: {
        data: [
          {
            type: concrete-product-prices,
            id: 177_24867659
          }
        ]
      }
    }
  },
  included: [
    {
      type: concrete-product-image-sets,
      id: 177_24867659,
      attributes: {
        imageSets: [
          {
            name: default,
            images: [
              {
                externalUrlLarge: //images.icecat.biz/img/norm/high/24867659-4916.jpg,
                externalUrlSmall: //images.icecat.biz/img/norm/medium/24867659-4916.jpg
              }
            ]
          }
        ]
      },
      links: {
        self: http://mysprykershop.com/concrete-products/177_24867659/concrete-product-image-sets
      }
    },
    {
      type: concrete-product-availabilities,
      id: 177_24867659,
      attributes: {
        availability: true,
        quantity: 20,
        isNeverOutOfStock: false
      },
      links: {
        self: http://mysprykershop.com/concrete-products/177_24867659/concrete-product-availabilities
      }
    },
    {
      type: concrete-product-prices,
      id: 177_24867659,
      attributes: {
        price: 42502,
        prices: [
          {
            priceTypeName: DEFAULT,
            netAmount: null,
            grossAmount: 42502,
            currency: {
              code: EUR,
              name: Euro,
              symbol: €
            }
          }
        ]
      },
      links: {
        self: http://mysprykershop.com/concrete-products/177_24867659/concrete-product-prices
      }
    }
  ]
}</code></pre>
                            </MadCap:dropDownBody>
                        </MadCap:dropDown>
                    </li>
                    <li>
                        <p>if the <var>getIsEagerRelatedResourcesInclusionEnabled</var> parameter is set to&#160;<b>false</b>,&#160;the&#160;<i>included</i>&#160;and <i>relationships&#160;</i>sections are absent.</p>
                        <MadCap:dropDown>
                            <MadCap:dropDownHead>
                                <MadCap:dropDownHotspot>Sample response</MadCap:dropDownHotspot>
                            </MadCap:dropDownHead>
                            <MadCap:dropDownBody><pre><code class="language-Json line-numbers">{
  data: {
    type: concrete-products,
    id: 177_24867659,
    attributes: {...},
    links: {...},
}</code></pre>
                            </MadCap:dropDownBody>
                        </MadCap:dropDown>
                    </li>
                </ul>
            </li>
        </ol>
        <h2>See Also:</h2>
        <ul>
            <li><a href="https://documentation.spryker.com/glue_rest_api/glue_api_developer_guides/glue-infrastructure.htm">Glue Infrastructure</a>
            </li>
        </ul>
    </body>
</html>