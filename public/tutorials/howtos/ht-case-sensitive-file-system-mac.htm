<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1>HowTo - Handling Case Sensitive File-System on Mac OS</h1>
        <p>By default Mac OS uses a case-insensitive file system to support compatibility to applications (e.g. Photoshop) provided for the operating system. The file-system itself is capable of working in a case-sensitive mode. There are a number of options on how to change case sensitivity:</p>
        <ol>
            <li>Re-partition the entire hard drive with case-sensitivity turned on</li>
            <li>Create a new partition and re-format only this new partition with the case-sensitive file-system</li>
            <li>Create a disk image, format that image with the case-sensitive file-system, and mount this disk image</li>
        </ol>
        <p>Options 1 and 2 will require tampering with an existing hard drive that contains your operating system. Option 3 is the least destructive and requires very little effort.</p>
        <h2>Creating The Disk Image</h2>
        <p>We can use Mac OS' Disk Utility application to create a disk image. We will create a growing image with decent size so we don't waste any hard drive space bit still keep enough room for many projects.</p>
        <ol>
            <li>Open Disk Utility by opening Spotlight (Cmd + Space) and typing disk utility</li>
            <li>Choose File &gt; New Image &gt; Blank Image</li>
            <li>Enter a file name for the disk image (e.g. case-sensitive-file-system)</li>
            <li>Select the place where to store the image (e.g. your home folder)</li>
            <li>Enter a name for the image (e.g. workspace). This name will we shown in Finder once the image is mounted. I like to have matching names for the mountpoint and disk image name so Finder will display it nicely. For my local setup I use workspace as the image's name and mount-point</li>
            <li>Enter a decent value for the size so the image can accommodate all your projects (e.g. 100GB)</li>
            <li>Select the format: Mac OS Extended (Case-sensitive, Journaled)</li>
            <li>Encryption and partitions can be left as is</li>
            <li>Select the image format: Sparse (be careful: Somethimes changing the image format will reset the setting for image size)</li>
        </ol>
        <p>The resulting dialog should look something like this:</p>
        <p>
            <img src="../../Resources/Images/case sensitive system.png" />
        </p>
        <p>After the disk has been created you can see it being mounted in Finder already.</p>
        <h2>Copying Existing Projects</h2>
        <p>You can copy all existing projects to the newly created box. If it is not mounted simply double-click the disk image file in Finder. After you copied all your projects I suggest replacing your current project directory with the mount-point (please see next section _Automatically Mounting Disk Image at Boot_) for the disk image so you don't have to adjust any paths you already set up.</p>
        <h2>Automatically Mounting Disk Image at Boot</h2>
        <p>You don't want to manually mount the disk image every time you restart your system. We will create a Launch Agent that will take care of this.</p>
        <ol>
            <li>Create a new file for the definition of the Launch Agent under <code> (e.g. ~Library/LaunchAgents/local.mount-case-sensitive-file-system.plist)</code></li><pre><code>vim ~Library/LaunchAgents/local.mount-case-sensitive-file-system.plist
			</code></pre>
            <li>Place the following content inside the file</li><pre><code class="language-xml line-numbers">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
    &lt;dict&gt;
        &lt;key&gt;RunAtLoad&lt;/key&gt;
        &lt;true/&gt;
        &lt;key&gt;Label&lt;/key&gt;
        &lt;string&gt;local.mount-case-sensitive-file-system&lt;/string&gt;
        &lt;key&gt;ProgramArguments&lt;/key&gt;
        &lt;array&gt;
            &lt;string&gt;hdiutil&lt;/string&gt;
            &lt;string&gt;attach&lt;/string&gt;
            &lt;string&gt;[ABSOLUTE_PATH_TO_DISK_IMAGE]&lt;/string&gt;
            &lt;string&gt;-mountpoint&lt;/string&gt;
            &lt;string&gt;[ABSOLUTE_PATH_TO_MOUNT_POINT]&lt;/string&gt;
            &lt;string&gt;-nobrowse&lt;/string&gt;
        &lt;/array&gt;
    &lt;/dict&gt;
&lt;/plist&gt;	</code></pre>
        </ol>
        <p>
	Please put in some values for <b>[ABSOLUTE_PATH_TO_DISK_IMAGE]</b> (e.g. <code>/Users/joeaverage/case-sensitive-file-system.sparseimage</code>) and <b>[ABSOLUTE_PATH_TO_MOUNT_POINT]</b> (e.g. <code>/Users/joeaverage/workspace</code>). Please make sure that the mount-point folder exists and is empty.</p>
        <h2>Configuring PHP Storm</h2>
        <p>The first time you open one of the projects form the disk-image you will notice a warning about case-sensitive file-systems. PHPStorm for Mac OS is configured to work with a case-insensitive file-system and will report a warning that it detected a case-sensitive file-system. Unfortunately there is no way to configure PHPStorm on a per-project level but we can let PHPStorm know that all our projects will be stored on a case-sensitive file system.</p>
        <ol>
            <li>Open PHPStorm and go to <i>Help &gt; Edit Custom Properties</i></li>
            <li>Add the following option: <i>idea.case.sensitive.fs=true</i></li>
            <li>Save and close</li>
        </ol>
        <p>If you want to know more about this you can find documentation <a href="https://confluence.jetbrains.com/display/IDEADEV/Filesystem+Case-Sensitivity+Mismatch">here</a>. </p>
        <p>&#160;</p>
        <p><i>Last review date: Nov. 22nd, 2016 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Thomas KÃ¼hnel</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>