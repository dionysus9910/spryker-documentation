<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="">
    <head>
    </head>
    <body>
        <h1>Tutorial - Yves Bootstrapping</h1>
        <p>
            <img src="../../Resources/Images/shoptype/B2B_Shop.png" />
            <img src="../../Resources/Images/shoptype/B2C_Shop.png" />
            <img src="../../Resources/Images/shoptype/MasterSuite.png" />
            <img src="../../Resources/Images/shoptype/Demoshop.png" />
        </p>
        <p MadCap:conditions="General.Hidden Comment">used to be: http://spryker.github.io/tutorials/yves/yves-bootstrapping/</p>
        <p>Yves and Zed are both built upon the <a href="https://silex.sensiolabs.org/doc/2.0/" target="_blank" title="Silex micro-framework" alt="Silex micro-framework">Silex micro-framework</a>. So most concepts about modern web frameworks apply here as well.</p>
        <p>In <code>static/public/Yves/index.php</code> you will find the entry for the front-end application.</p><pre><code class="language-PHP line-numbers">&lt;?php
$errorHandlerEnvironment = new ErrorHandlerEnvironment();
$errorHandlerEnvironment-&gt;initialize();

$bootstrap = new YvesBootstrap();
$bootstrap
    -&gt;boot()
    -&gt;run();</code></pre>
        <p>The <code>boot()</code> method returns a Silex application which has a run() method, that processes the request and returns a response to the browser. <code>YvesBootstrap</code> is responsible for registering all the used service providers, controller providers and routers. The registration process is handled by the <code>boot()</code> operation.</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-PHP line-numbers">&lt;?php
namespace Pyz\Yves\Application;
 
use Spryker\Shared\Application\Communication\Application;
 
class YvesBootstrap
{
    /**
     * @var Application
     */
    protected $application;
 
    public function __construct()
    {
        $this-&gt;application = new Application();
    }
 
    /**
     * @return Application
     */
    public function boot()
    {
        $this-&gt;registerServiceProviders();
        $this-&gt;registerRouters();
        $this-&gt;registerControllerProviders();
 
        return $this-&gt;application;
    }
 
    // ...
}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <h2>Service Providers</h2>
        <p>We are using the Silex way to register service providers. You can easily register new service providers in YvesBootstrap. Note that the order of the registration matters, since sometimes one service provider already needs another service to be registered already.</p><pre><code class="language-PHP line-numbers">&lt;?php
// ...
 
/**
 * @return void
 */
protected function registerServiceProviders()
{
    $this-&gt;application-&gt;register(new ServiceProvider1());
    $this-&gt;application-&gt;register(new ServiceProvider2());
    // ...
}
 
// ...</code></pre>
        <p>Service providers need to implement <code>\Silex\ServiceProviderInterface</code>. You can find detailed information about service providers in the official <a href="https://silex.sensiolabs.org/doc/2.0/providers.html" target="_blank" title="Silex documentation page" alt="Silex documentation page">Silex documentation page</a>.</p>
        <h2>Controller Providers</h2>
        <p>Whenever you need to create a new controller you’ll need to define a path where it’s available. To do that you’ll need to register your controllers for a specific path (or in other words to create new route definition) in a controller provider.</p>
        <p>Let’s have a look at the <code>ApplicationControllerProvider </code>and how it registers two controllers in the Application module.</p><pre><code class="language-PHP line-numbers">&lt;?php
namespace Pyz\Yves\Application\Plugin\Provider;
 
use Pyz\Yves\Application\Plugin\Provider\AbstractYvesControllerProvider;
use Silex\Application;
 
class ApplicationControllerProvider extends AbstractYvesControllerProvider
{
    const ROUTE_HOME = 'home';
    const ROUTE_IMPRINT = 'imprint';
 
    /**
     * @return void
     */
    protected function defineControllers(Application $app)
    {
        $this-&gt;createGetController('/', static::ROUTE_HOME, 'Application', 'Index');
        $this-&gt;createGetController('/imprint', static::ROUTE_IMPRINT, 'Application', 'Static', 'imprint');
    }
}</code></pre>
        <p>Here we connect the IndexController and StaticController in the Application module to the paths <code>/</code> and <code>/imprint</code>. The last argument is the action name, which defaults to index.</p>
        <p>Note that we are extending <code>AbstractYvesControllerProvider</code> in the example which helps to get the URL prefix in the mounting process, but this is optional to use. If you want to register your controller providers the Silex way, you only need to implement <code>\Silex\ControllerProviderInterface</code> for your class and mount your controller providers as Silex recommends.</p>
        <p>The mounting process happens in <code>YvesBootstrap</code>. The example assumes that the Controller providers we use extends the <code>AbstractYvesControllerProvider</code>.</p><pre><code class="language-PHP line-numbers">&lt;?php
/**
 * @return void
 */
protected function registerControllerProviders()
{
    $controllerProviders = [
        new ApplicationControllerProvider(),
        new CheckoutControllerProvider(),
        // ...
    ];
 
    foreach ($controllerProviders as $controllerProvider) {
        $this-&gt;application-&gt;mount($controllerProvider-&gt;getUrlPrefix(), $controllerProvider);
    }
}</code></pre>
        <h2>Routers</h2>
        <p>Routers are responsible to find a matching controller action for each request. Spryker use Symfony’s ChainRouter to chain multiple routers which means each router will be executed after each other and the first which finds a matching path will resolve the request.</p>
        <p>By default we provide three routers:</p>
        <ol>
            <li>The first router is the <code>StorageRouter</code> which tries to match the path with the key-value storage (Redis).</li>
            <li>The next is the <code>SearchRouter</code> which tries to match the path with Elasticsearch (e.g. free text search pages)</li>
            <li>The last is the default <code>SilexRouter</code> which tries to match the path with the registered ControllerProviders.</li>
        </ol>
        <p>If you want to add a new router, you can add it in YvesBootsrap, but make sure you do it in the right ordering.</p><pre><code class="language-PHP line-numbers">&lt;?php
/**
 * @return void
 */
protected function registerRouters()
{
    $this-&gt;application-&gt;addRouter((new StorageRouter())-&gt;setSsl(false));
    $this-&gt;application-&gt;addRouter((new SearchRouter())-&gt;setSsl(false));
    $this-&gt;application-&gt;addRouter(new SilexRouter($this-&gt;application));
}</code></pre>
    </body>
</html>