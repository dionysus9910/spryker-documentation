<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="Spryker.ShopSuite,Spryker.B2C,Spryker.B2B">
    <head><title>Tutorial - Frontend - Create a Component</title>
    </head>
    <body>
        <h1>Tutorial - Frontend - Create a Component</h1>
        <p>
            <img src="../../../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/MasterSuite.png" /></p>
        <p>As Spryker Shop implements&#160;the <a href="../../../front-end_developer_guide/atomic_frontend/overview.htm#component-model" target="_blank">Component Model</a>, adding new functionality to it usually means implementing a new component. In this document, we shall review creation of a new component on the example of a simple block that displays the count of DOM elements of a certain type. To implement it:</p>
        <h2>1. Create Component Folder</h2>
        <p>First of all, you need to create a folder on&#160;the file system where all component files will be located. By default,&#160;project level components are located under&#160;<code>src/Pyz/Yves/ShopUi/Theme/default/components</code>. This folder should contain subfolders for each component type (<i>atoms</i>, <i>molecules</i>, <i>organisms</i>). A links counter is a simple molecule, so it will be created under the <b>molecules</b>&#160;subfolder. Per naming conventions, the folder name follows <a href="http://wiki.c2.com/?KebabCase" target="_blank">Kebab Case</a>:&#160;<i>src/Pyz/Yves/ShopUi/Theme/default/components/<b>molecules</b>/new-component-counter</i>.</p>
        <p>Open the <code>new-component-counter</code>&#160;folder and create the following files:</p>
        <ul>
            <li><code>index.ts</code> - Webpack entry point;</li>
            <li><code>new-component-counter.scss</code> - styles;</li>
            <li><code>new-component-counter.ts</code> - Javascript code;</li>
            <li><code>new-component-counter.twig</code> - component template.</li>
        </ul>
        <h2>2. Define Template</h2>
        <p>The first thing to do when creating a component is to define a template for it. A template specifies which blocks a component consists of and how they are arranged. This is done in Twig. Open the&#160;<code>new-component-counter.twig</code> file.</p>
        <p>First, we need to define the inheritance of the component. A component can inherit from a model or another component. Since we are creating a new component, it can be inherited from the following models defined in Spryker Shop Application:</p>
        <ul>
            <li>
                <p>atoms, molecules and organisms extend model <b>component</b>:<br /><code>{% extends model('component') %}</code></p>
            </li>
            <li>
                <p>templates and views extend model <b>template</b><br /><code>{% extends model('template') %}</code></p>
            </li>
        </ul>
        <p>As we are creating a molecule, it must inherit the <b>component</b> model. For this purpose, add the following:</p><pre><code class="language-Twig line-numbers">{% extends model('component') %}</code></pre>
        <p>After that, we need to define a configuration object for our new component. A configuration consists of the following:</p>
        <ul>
            <li>
                <p><b>name</b> - specifies the component name. It is also used as the class name of the component.</p>
            </li>
            <li>
                <p><b>tag</b> <i>(optional)</i> - specifies the name of the DOM tag that will be used to render the component. It also defines the component Javascript class name (<b>jsName</b>) automatically.</p>
                <p class="info">If the tag name is not defined,&#160;<b>div</b> is used by default.</p>
            </li>
            <li>
                <p><b>jsName</b> <i>(optional)</i>&#160;- explicitly specifies the&#160;Javascript class name&#160;(<b>.js-classname</b>) of the component.</p>
                <p class="tip"><b>Separation of Logic from Styles</b>
                    <br />To enforce separation between logic and visual styles and achieve clear understanding as to which code is responsible for what, the following convention has been put in place:<br />- code related to <b>styles</b> is always contained in <i><b>{{config.name}}</b>__element</i> classes;<br />- code related to <b>behavior</b> is always contained in <i><b>{{config.jsName}}</b>__element</i> classes;</p>
            </li>
        </ul>
        <p>The same as with files and folders, <i>Kebab Case</i> should be used</p>
        <p>We will use a custom tag for the component. It will have the same name as the name of the component. Add the <i>config</i> element as follows:</p><pre><code class="language-Twig line-numbers">{% define config = {
    name: 'new-component-counter',
    tag: 'new-component-counter'
} %}</code></pre>
        <p>Now, we need to define a contract for the component. Contract consists of the attributes required for the component to function properly. Attributes can be either&#160;<b>required</b> or <b>optional</b>. <i>Required</i>&#160;attributes must always be defined whenever a component is used, while&#160;<i>optional </i>ones can be left undefined. Nevertheless, by convention, attributes cannot have their value undefined. For this reason, if you define an optional attribute in your contract, you must set a default value for it.</p>
        <p>Let us define 2 attributes. They will be used to pass the component <i>title</i> and <i>description</i> displayed on a page. <i>Title</i> will be required and <i>description</i>&#160;will be optional with the default value of&#160;<i>no description.</i></p><pre><code class="language-Twig line-numbers">{% define data = {
    name: required,
    description: 'no description'
} %}</code></pre>
        <p>In addition to the data contract, you can also add attributes that will be passed in the HTML tag of the component. The same as <b>data</b> attributes, they can be required or not.</p>
        <p>For our component, we will use an attribute called&#160;<i>element-selector</i>. It will be used to specify the type of HTML elements to count. Let us add the attribute and make it required:</p><pre><code class="language-Twig line-numbers">{% define attributes = {
    'element-selector': required
} %}</code></pre>
        <p>With the above configuration, if we want our component to count&#160;<b>a</b>&#160;tags, we need to embed it on a page as follows:</p><pre><code class="language-Twig line-numbers">{% include molecule('new-component-counter') with {
                ...
                attributes: {
                    'element-selector': 'a'
                }
            } only %}</code></pre>
        <p>Finally, let us define the template. You can do this like you would normally do in Twig.</p><pre><code class="language-Twig line-numbers">{% block body %}
    {% spaceless %}
        &lt;strong class="{{config.name}}__name"&gt;
            {{data.name}}
        &lt;/strong&gt;
        &lt;em class="{{config.name}}__description"&gt;
            {% if data.description is not empty %}{{data.description}}{% endif %}
        &lt;/em&gt;
        {% block counter %}
            Found &lt;strong class="{{config.name}}__counter {{config.jsName}}__counter"&gt;&lt;/strong&gt; elements
        {% endblock %}
    {% endspaceless %}
{% endblock %}</code></pre>
        <h2>3. Create Styles</h2>
        <p>Now, let us create visual styles used to display the component on a page. When creating styles, use <a href="https://en.bem.info/methodology/css/" target="_blank">BEM methodology</a>. To link the style to the new component, the class name must be the same as the component name, also in <i>Kebab Case</i>.</p>
        <p>Open file&#160;<code>new-component-counter.scss</code>&#160;file and add the following code:</p><pre><code class="language-Css line-numbers">.new-component-counter {
    &amp;__name {
        display: block;
    }

    &amp;__description {
        display: block;
        color: $setting-color-dark;
    }

    &amp;__counter {
        color: $setting-color-alt;
    }

    &amp;--big {
        @include helper-font-size(big);
    }
}</code></pre>
        <p class="info">As shown in the example, you can use global variables, functions and mixins&#160;in your styles, for example&#160;<i>$setting-color-alt</i> or&#160;<i>$setting-color-dark</i>. They can be found in the <code>vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/styles</code>&#160;folder. For more details, see section&#160;<b>SASS Layer</b> in <a href="../../../front-end_developer_guide/atomic_frontend/overview.htm#sass-layer">Atomic Frontend</a>.</p>
        <p>Also, the styles must be locatable by Webpack. For this purpose, we need to add them to the entry point of the component. Open the&#160;<i>index.ts</i> file and add the following line:</p><pre><code class="language-Css line-numbers">import './new-component-counter.scss';</code></pre>
        <h2>4. Implement Behavior</h2>
        <p>Finally, we need to implement the actual code that will count the elements. Open the&#160;<code>new-component-counter.ts</code>&#160;file.</p>
        <p>The component we are creating is a molecule which is inherited from the&#160;<i>Component</i> model. Because of this, it must extend the&#160;<b>Component</b> base class defined in the <i>ShopUI</i> module. First, we need to import the base class:</p><pre><code class="language-Css line-numbers">import Component from 'ShopUi/models/component';</code></pre>
        <p>After that, we need to create the new component class extending the base&#160;class. The new component class must implement a DOM callback.&#160;You can use any callback defined by the <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" target="_blank">Web Components Specification</a>.&#160;When the component receives the callback you define, it should execute the behavioral logic.</p>
        <p class="tip">It is recommended to use&#160;<b>ready&#160;</b>callback. This callback is triggered when the component is ready and all other components have already been loaded in the DOM. It is the safest approach from the point of view of DOM manipulation.</p>
        <p>Let us implement the&#160;<b>ready</b> callback. Upon receiving the callback, the component will count the number of tags defined by&#160;<i>element-selector</i>.</p>
        <p>To fulfill our goal, we can use&#160;keyword&#160;<i>this</i>. It provides direct access to the public API of the HTML element associated with the component.</p>
        <p>Names of Javascript classes follow <a href="http://wiki.c2.com/?CamelCase" target="_blank">Camel Case</a>, thus, the behavior of our component will be implemented by Javascript class&#160;<b>NewComponentCounter</b>:</p><pre><code class="language-Javascript line-numbers">export default class NewComponentCounter extends Component {
    protected counter: HTMLElement
    protected elements: HTMLElement[]

    protected readyCallback(): void {
        this.counter = &lt;HTMLElement&gt;document.querySelector(`.${this.jsName}__counter`);
        this.elements = &lt;HTMLElement[]&gt;Array.from(document.querySelectorAll(this.elementSelector)); this.count(); }
                        count(): void { this.counter.innerText = `${this.elements.length}`; } get elementSelector():
                        string { return this.getAttribute('element-selector'); } }</code></pre>
        <p>After implementing the behavior, we also need to bind the Javascript class to the DOM. For this purpose, we need to use the&#160;<b>register</b> function of the Spryker Shop application. It accepts&#160;<b>2</b> arguments:</p>
        <ul>
            <li><b>name</b> - specifies the component name.<br />This name will be associated with the component and can be used in Twig to insert the component in a template. Also, it will be used in the DOM as a tag name. Whenever a tag with the specified name occurs in the DOM, the Shop Application will load the component. It must be the same as the&#160;<code>data.tag</code> specified in the component Twig on step&#160;<b>2</b>.</li>
            <li>
                <p><b>importer</b> - must be a call of Webpack's&#160;<b>import</b> function to import Typescript code for the component.<br />The call must include a Webpack magic comment that specifies which type of import you want for the component, 'lazy' or 'eager'. For details, see&#160;<a href="https://webpack.js.org/guides/code-splitting/#dynamic-imports" target="_blank">Dynamic Imports</a>.</p>
            </li>
        </ul>
        <p>In twig, we used tag name <code>new-component-counter</code>. Let us bind it to the Javascript class we created and use 'lazy' import. To do this, open file&#160;<code>index.ts</code> again and attach the following code:</p><pre><code class="language-Javascript line-numbers">// Import the 'register' function from the Shop Application
import register from 'ShopUi/app/registry';

// Register the component
export default register(
    'new-component-counter',
    () =&gt; import(/* webpackMode: "lazy" */'./new-component-counter')
);</code></pre>
        <h2>5. Compile and Use the Component</h2>
        <p>Our component is almost complete. The only thing left is to compile it. Execute the following line in the console: <code>npm run yves</code></p>
        <p>When done, you can include it into other components, views and templates.</p>
        <ul>
            <li>Copy file&#160;<code>vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/page-layout-main/page-layout-main.twig</code> to&#160;<code>src/Pyz/Yves/ShopUi/Theme/default/page-layout-main/page-layout-main.twig</code>. Doing so overrides the default main page on the project level.</li>
            <li>
                <p>Add the following&#160;code to the very beginning of the&#160;<code>&lt;main&gt;</code> block. It will include our new component&#160;and configure it to count&#160;<b>a</b> tags:</p><pre><code class="language-Twig line-numbers">{% include molecule('new-component-counter') with {
    modifiers: ['big'],
    data: {
        name: 'Counting a tags...',
        description: 'How many links are there on this page?'
    },
    attributes: {
        'element-selector': 'a'
    }
} only %}</code></pre>
                <MadCap:dropDown>
                    <MadCap:dropDownHead>
                        <MadCap:dropDownHotspot>See resulting file (page-layout-main.twig)</MadCap:dropDownHotspot>
                    </MadCap:dropDownHead>
                    <MadCap:dropDownBody>
                        <p><pre><code class="language-Twig line-numbers">{% extends template('page-blank') %}

{%- block class -%}js-page-layout-main__side-drawer-container{%- endblock -%}

{% block body %}
    {% block notifications %}
        {% include organism('notification-area') only %}
    {% endblock %}

    {% block sidebar %}
        {% include organism('component-side-drawer') with {
            class: 'is-hidden-lg-xl',
            attributes: {
                'container-selector': 'js-page-layout-main__side-drawer-container',
                'trigger-selector': 'js-page-layout-main__side-drawer-trigger'
            }
        } only %}
    {% endblock %}

    {% block outside %}{% endblock %}

    {% block header %}
        {% embed organism('header') only %}
            {% block mobile %}
                &lt;a href="#" class="link link--alt js-page-layout-main__side-drawer-trigger"&gt;
                    {% include atom('icon') with {
                        modifiers: ['big'],
                        data: {
                            name: 'bars'
                        }
                    } only %}
                &lt;/a&gt;
            {% endblock %}
        {% endembed %}
    {% endblock %}

    &lt;div class="container"&gt;
        {% block pageInfo %}
            &lt;div class="box"&gt;
                {% block breadcrumbs %}
                    {% include molecule('breadcrumb') only %}
                {% endblock %}

                &lt;hr /&gt;

                {% block title %}
                    &lt;h3&gt;{{data.title}}&lt;/h3&gt;
                {% endblock %}
            &lt;/div&gt;
        {% endblock %}

        &lt;main&gt;
            {#
                Use the new component
            #}
            {% include molecule('new-component-counter') with {
                modifiers: ['big'],
                    data: {
                    name: 'Counting a tags...',
                    description: 'How many links are there on this page?'
                },
                attributes: {
                    'element-selector': 'a'
                }
            } only %}
            {% block content %}{% endblock %}
        &lt;/main&gt;

        {% block footer %}
                {% include organism('footer') only %}
        {% endblock %}

        {% block copyright %}
            &lt;p class="text-center text-small text-secondary"&gt;
                Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
                &lt;br&gt;Aenean commodo ligula eget dolor. Aenean massa.
                &lt;br&gt;© ACME Company
            &lt;/p&gt;
        {% endblock %}
    &lt;/div&gt;

    {% block icons %}
        {% include atom('icon-sprite') only %}
    {% endblock %}
{% endblock %}</code></pre>
                        </p>
                    </MadCap:dropDownBody>
                </MadCap:dropDown>
            </li>
            <li>
                <p>Now, open the front page of Spryker Shop. The new component will appear at the top of the page, below the header:</p>
                <p>
                    <img src="../../../Resources/Images/frontend/new-component-counter.png" />
                </p>
            </li>
        </ul>
        <p><i>Last review date: November 19th, 2018</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"> by Volodymyr Volkov</MadCap:conditionalText>
        </p>
    </body>
</html>