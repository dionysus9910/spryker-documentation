<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="2624" MadCap:lastWidth="2122" style="">
    <head>
    </head>
    <body>
        <h1>Virtual Machine Cleanup</h1>
        <p>Used to be: http://spryker.github.io/getting-started/installation/virtual-machine-cleanup/</p>
        <p>If you need to cleanup the environment set up in the virtual machine, you can either do this by running a script or execute the cleanup steps manually.

</p>
        <h2>VM Cleanup - Automatic</h2>
        <p>To cleanup the VM:</p>
        <p>Run the setup script with the reset parameter, as in the examples below:
</p><pre><code class="language-PHP line-numbers">./setup -r
./setup --reset
</code></pre>
        <p>When running the setup script with the reset parameter, the execution will clear Redis and Elasticsearch data storages, the database will be dropped, the node_modules folder will be removed as well as the cache folders from Yves and Zed.
</p>
        <p><b>To clear the data stored in Redis and Elasticsearch and drop the database</b>:</p>
        <p>Run the setup script with the delete option as in one of the examples below:

</p><pre><code class="language-PHP line-numbers">./setup -d
./setup --delete</code></pre>
        <p><b>To reinitialize the application</b>:</p>
        <p>Run the setup script again without any argument.
</p>
        <p>T<b>o see available parameters for </b><var><b>setup</b>:</var></p>
        <p> Run one of the following commands:
</p><pre><code class="language-PHP line-numbers">./setup -h
./setup --help</code></pre>
        <h2>VM Cleanup - Manual </h2>
        <p>First, navigate to the project folder from your virtual machine:

</p><pre><code class="language-PHP line-numbers">cd /data/shop/development/current</code></pre>
        <p>1. <b>Clear the Elasticsearch service</b>:
</p>
        <p>Make sure the Elasticsearch service is up and running; if it’s not, restart it with:</p><pre><code class="language-PHP line-numbers">sudo /etc/init.d/elasticsearch restart</code></pre>
        <p>Delete all indices in Elasticsearch:

</p>
        <p>
curl -XDELETE 'http://localhost:9200/_all'
</p>
        <p>2. <b>Clear Zed database</b>:
</p>
        <p>In this step, <var>DE_development_zed database</var> will be dropped if it already exists.

</p>
        <p>CURRENT_STORE=`php -r "echo require 'config/Shared/default_store.php';"`
sudo dropdb --if-exists "${CURRENT_STORE}_development_zed"
</p>
        <p>3. <b>Clear Redis:</b></p>
        <p>
redis-cli -p 10009 flushdb
</p>
        <p>4. <b>Install dependencies
Install composer dependencies</b>:

</p><pre><code class="language-PHP line-numbers">php composer.phar install</code></pre>
        <p>Install npm dependencies:</p><pre><code class="language-PHP line-numbers">npm install -d </code></pre>
        <p>5. <b>Install application</b>:</p><pre><code class="language-PHP line-numbers">vendor/bin/console setup:install
vendor/bin/console setup:install-demo-data
sudo /etc/init.d/elasticsearch restart
vendor/bin/console collector:search:export
vendor/bin/console collector:storage:export</code></pre>
        <p>Using <var>-v</var> helps to show more details on the progress.</p>
    </body>
</html>