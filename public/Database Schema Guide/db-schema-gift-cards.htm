<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Gift Cards Schema</title>
    </head>
    <body>
        <h1>Gift Cards Schema</h1>
        <h2><b>Gift Cards</b>
        </h2>
        <h3>Gift Card Code</h3>
        <p class="info">Enable your customers to buy gift cards with flexible amounts of money and to give it to friends as a gift. They can apply it like a voucher code during checkout and pay their whole orders or a part of it.</p>
        <p class="important">Gift cards are not Discounts!</p>
        <p>
            <img src="../Resources/Images/Databaase Schema Guide/gift-card.png">
            </img>
        </p>
        <p><b>Structure</b>:</p>
        <ul>
            <li>A Gift Card has a name and a code that can be entered by the Customer.</li>
            <ul>
                <li><i>value</i> - The money value of the Gift Card.</li>
                <li><i>currency</i> - Ever Gift Card has a fixed currency.</li>
            </ul>
        </ul>
        <h3>Gift Card Product</h3>
        <p class="info">A Gift Card Product is a regular product in the shop which represents a Gift Card that Customer can buy.</p>
        <p>
            <img src="../Resources/Images/Databaase Schema Guide/gift-card-product.png">
            </img>
        </p>
        <p><b>Structure</b>:</p>
        <ul>
            <li><b>Gift Card Abstract Configuration</b>:</li>
            <ul>
                <li>The Abstract Product represents a specific type of Gift Cards with a code pattern (e.g. "XMAS-")</li>
                <li><i>code_pattern</i> - Pattern that is used to create the unique code of the produced Gift Card after the purchase</li>
            </ul>
            <li><b>Gift Card Configuration</b>:</li>
            <ul>
                <li>The Concrete Product represents a specific value that will be used to produce the Gift Card (e.g. "5 Euro")</li>
                <li><i>value</i> - This is the money value which will be used to produce the Gift Card</li>
            </ul>
        </ul>
        <h3>Gift Card Balance and Payment</h3>
        <p class="info">Gift Cards are used to pay orders. If the Grand Total is higher than the Gift Card Amount then there is some left over. This is saved as a balance.</p>
        <p>
            <img src="../Resources/Images/Databaase Schema Guide/gift-card-purchase-payment.png">
            </img>
        </p>
        <p><b>Structure</b>:</p>
        <ul>
            <li>Each Gift Card can be used for multiple Sales Orders. The applied amount is saved into <i>spy_gift_card_balance_log</i> per Sales Order. So to retrieve the used amount these rows need to be summed up. There is no way to refund a balance. In case of a refund, the system needs to create another Gift Card.</li>
            <li>When a Sales Order is saved then the table <i>spy_sales_payment</i> contains all used Payment Methods. As the Gift Card is a Payment Method, this needs to be saved here as well.</li>
            <li>There is an additional table <i>spy_payment_gift_card</i> which holds the used code.</li>
        </ul>
    </body>
</html>