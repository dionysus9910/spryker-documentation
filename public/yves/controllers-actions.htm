<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="6" MadCap:lastHeight="18668" MadCap:lastWidth="1232" style="">
    <head><title>Controllers and Actions</title>
        <link href="../Resources/TableStyles/PatternedRows.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <h1>Controllers and Actions</h1>
        <p MadCap:conditions="General.Hidden Comment">Used to be: http://spryker.github.io/development-guide/yves/controllers-actions/</p>
        <p>Controllers are placed inside the Controllers folder in Yves; they provide an entry point to the system for requests submitted by the front-end users.
</p>
        <p>The methods inside of a controller are called actions. Usually an action reads the incoming request-data, maybe validates it with a form, delegates it to a client and writes the response.

</p>
        <p>The following controller provides two actions: <var>indexAction()</var> and <var>testAction()</var>.
</p><pre><code class="language-PHP line-numbers">&lt;?php
namespace Namespace\Yves\Bundle\Controller;

use Spryker\Yves\Kernel\Controller\AbstractController;

 
class IndexController extends AbstractController
{
    public function indexAction()
    {
        return $this-&gt;viewResponse([]);
    }
 
    public function testAction(Request $request)
    {
       return $this-&gt;viewResponse([]);
    }
}
</code></pre>
        <h2>Input Parameters
</h2>
        <p>You can define an input parameter <var>$request</var> that is automatically injected. This is a <a href="http://api.symfony.com/2.3/Symfony/Component/HttpFoundation/Request.html" target="_blank">Symfony\Component\HttpFoundation\Request</a>, so you will find methods to fetch the get and post parameters and the session.
</p><pre><code class="language-PHP line-numbers">&lt;?php
public function testAction(Request $request)
{
    $request-&gt;getSession(); // retrieve current session
    $request-&gt;query-&gt;get('a'); // retrieve get-parameter index?a=
    // ...
}
</code></pre>
        <h2>Response Methods
</h2>
        <p>There are several ways to send responses in different use cases. These methods are called at the end of the action and their return value is returned by the action. e.g. return <var>$this-&gt;redirectResponse('/my-module')</var>.
</p>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
            <col class="TableStyle-PatternedRows-Column-Regular" />
            <col class="TableStyle-PatternedRows-Column-Regular" />
            <thead>
                <tr class="TableStyle-PatternedRows-Head-Header1">
                    <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">Response Method	</th>
                    <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">Purpose
</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-PatternedRows-Body-LightRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                        <p>viewResponse(array $data = [])</p>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                        <p>Loads the related twig template and provides the data for the template.</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-DarkerRows">
                        <p>	
jsonResponse($data = null, $status = 200, $headers = [])	</p>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-DarkerRows">
                        <p>Sends a json response which is needed for ajax calls.
</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-LightRows">
                    <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">
                        <p>redirectResponse($url, $status = 302, $headers = [])</p>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">
                        <p>Performs a redirect to the given relative path or absolute url.
</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows-BodyB-Regular-DarkerRows">
                        <p>	streamedResponse($callback = null, $status = 200, $headers = [])	</p>
                    </td>
                    <td class="TableStyle-PatternedRows-BodyA-Regular-DarkerRows">
                        <p>ends binary data. This is used to draw the state machines</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p><b>Example of usage in an action</b>:
</p><pre><code class="language-PHP line-numbers">&lt;?php
public function testAction(Request $request)
{
    // ...
    return $this-&gt;viewResponse(['customer' =&gt; ['name' =&gt; 'John doe']]);
}
</code></pre>
        <p>Now the data can be accessed in the twig template like this: <var>{{customer.name}}</var> .

</p>
        <h2>Controllers and Paths in Yves
</h2>
        <p>URL routing in Yves is not the same as URL routing in Zed. You can route a custom URL to a <var>module-controller-action</var> triple.

</p>
        <p>To learn more about URL routing in Yves, check out <a href="yves-url-routing.htm" target="_blank">Implementing URL Routing in Yves</a>.

</p>
        <h2>Twig Template in Yves
</h2>
        <p>Each action which returns $this-&gt;viewResponse() must have a dedicated Twig template:

</p>
        <ul>
            <li>Controller and action:
</li>
        </ul><pre><code class="language-PHP line-numbers">MyNamespace/Yves/MyBundle/Controller/TestController::doSomethingAction()
</code></pre>
        <ul>
            <li>Expected path of template:
</li>
        </ul><pre><code class="language-PHP line-numbers">MyNamespace/Yves/MyBundle/Theme/{ThemeName}/Test/do-something.twig
</code></pre>
    </body>
</html>