<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="General.Demoshop,Spryker.B2B,Spryker.B2C">
    <head>
    </head>
    <body>
        <h1>Migration Guide - RabbitMQ <img src="../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../Resources/Images/shoptype/B2C_Shop.png" /></h1>
        <h2>Upgrading from Version 0.* to Version 1.*</h2>
        <h3>Version 1 of the RabbitMq module </h3>
        <h4>Configuration</h4>
        <p>
            The configuration codes have moved from <var>RabbitMqDependencyProvider</var> to <var>RabbitMqConfiguration</var>.
        </p>
        <h4>RabbitMqOption TransferObject</h4>
        <p>
            RabbitMqOption transfer has changed: <var>bindingQueue</var> property has changed to <var>bindingQueueCollection</var>
            RabbitMqOption transfer has changed: <var>routingKey</var> property with string type has changed to <var>routingKeys</var> with array type.
        </p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot><div class="drop-anchor">Sample configuration code in RabbitMqConfiguration:</div></MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-PHP line-numbers">namespace Pyz\Client\RabbitMq;

use ArrayObject;
use Generated\Shared\Transfer\RabbitMqOptionTransfer;
use Spryker\Client\RabbitMq\Model\Connection\Connection;
use Spryker\Client\RabbitMq\RabbitMqConfig as SprykerRabbitMqConfig;
use Spryker\Shared\Event\EventConstants;

class RabbitMqConfig extends SprykerRabbitMqConfig
{

    /**
     * @return \ArrayObject
     */
    protected function getQueueOptions()
    {
        $queueOptionCollection = new ArrayObject();
        $queueOptionCollection-&gt;append($this-&gt;createQueueOption(EventConstants::EVENT_QUEUE, EventConstants::EVENT_QUEUE_ERROR));

        return $queueOptionCollection;
    }

    /**
    * @param string $queueName
    * @param string $errorQueueName
    * @param string $routingKey
    *
    * @return \Generated\Shared\Transfer\RabbitMqOptionTransfer
    */
    protected function createQueueOption($queueName, $errorQueueName, $routingKey = 'error')
    {
        $queueOption = new RabbitMqOptionTransfer();
        $queueOption
            -&gt;setQueueName($queueName)
            -&gt;setDurable(true)
            -&gt;setType('direct')
            -&gt;setDeclarationType(Connection::RABBIT_MQ_EXCHANGE)
            -&gt;addBindingQueueItem($this-&gt;createQueueBinding($queueName))
            -&gt;addBindingQueueItem($this-&gt;createErrorQueueBinding($errorQueueName, $routingKey));

        return $queueOption;
    }

    /**
    * @param string $queueName
    *
    * @return \Generated\Shared\Transfer\RabbitMqOptionTransfer
    */
    protected function createQueueBinding($queueName)
    {
        $queueOption = new RabbitMqOptionTransfer();
        $queueOption
            -&gt;setQueueName($queueName)
            -&gt;setDurable(true)
            -&gt;addRoutingKey('');

        return $queueOption;
    }

    /**
    * @param string $errorQueueName
    * @param string $routingKey
    *
    * @return \Generated\Shared\Transfer\RabbitMqOptionTransfer
    */
    protected function createErrorQueueBinding($errorQueueName, $routingKey)
    {
        $queueOption = new RabbitMqOptionTransfer();
        $queueOption
            -&gt;setQueueName($errorQueueName)
            -&gt;setDurable(true)
            -&gt;addRoutingKey($routingKey);

        return $queueOption;
    }

}
            </code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>&#160;</p>
        <p><b>See also:
		</b>
        </p>
        <ul>
            <li><a href="http://documentation.spryker.com/capabilities/development/queue/queue.htm">Learn more about Queue</a>
            </li>
            <li><a href="http://documentation.spryker.com/tutorials/introduction/setup-hello-world-queue.htm">Learn how to set up a "Hello World" Queue</a>
            </li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Oct. 18th, 2017 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Ehsan Zanjani</i>
            </MadCap:conditionalText><![CDATA[    ]]></p>
    </body>
</html>