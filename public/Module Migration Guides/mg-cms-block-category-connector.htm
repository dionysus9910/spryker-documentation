<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="General.Demoshop,Spryker.B2B,Spryker.B2C,Spryker.DemoShop">
    <head><title>Migration Guide - CMS Block Category Connector</title>
    </head>
    <body>
        <h1>Migration Guide - CMS Block Category Connector <img src="../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Upgrading from Version 1.* to Version 2.*</h2>
        <p>Due to introducing the CMS Block positioning and CMS Block templates for Category, the CMS Block Category Connector module now requires Category &gt;=4.0.</p>
        <p>The migration will contain the following steps:</p>
        <ol>
            <li>New module installation</li>
            <li>Deprecations migration</li>
            <li>Database migration</li>
            <li>Data migration</li>
        </ol>
        <h4>1. New Module Installation</h4>
        <p>Install a new module by adding the following into your composer.json: <var>"spryker/cms-block-category-connector": "^2.0.0"</var> and running the composer update.</p>
        <p>Follow the installation instructions to enable all connector plugins: CMS Block Category Connector: Installation.</p>
        <h4>2. Deprecations Migration</h4>
        <p>
            Change usage of <var>\Spryker\Shared\CmsBlockCategoryConnector\CmsBlockCategoryConnectorConstants::RESOURCE_TYPE_CMS_BLOCK_CATEGORY_CONNECTOR</var> to
            <var>\Spryker\Shared\CmsBlockCategoryConnector\CmsBlockCategoryConnectorConfig::RESOURCE_TYPE_CMS_BLOCK_CATEGORY_CONNECTOR</var></p>
        <h4>3. Database Migration</h4>
        <p>Run Propel migrations. 
    <var>vendor/bin/console propel:diff</var>, manual review is necessary for the generated migration file.
    <var>vendor/bin/console propel:migrate</var><var>vendor/bin/console propel:model:build</var></p>
        <h4>4. Data Migration</h4>
        <p>Notice: You can skip this step if you don't have data in <var>spy_cms_block_category_connector</var> table.</p>
        <p>
    We prepared a migration script to migrate relations to Category.
    The script can be found <a href="mg-cms-block-category-connector-console.htm">here</a>.
</p>
        <p>
    Copy script to <var>src/Pyz/Zed/CmsBlockCategoryConnector/Communication/Console/CmsBlockCategoryPosition.php</var> and register it in <var>Pyz\Zed\Console\ConsoleDependencyProvider</var>.
</p>
        <p>Check that the script covers your Category and CmsBlockCategoryConnector configuration.</p><pre><code class="language-PHP line-numbers">
&lt;?php
namespace Pyz\Zed\Console;

class ConsoleDependencyProvider extends SprykerConsoleDependencyProvider
{
    public function getConsoleCommands(Container $container)
    {
        $commands = [
          ...
          CmsBlockCategoryPosition()
        ];

        ...
    }
}
?&gt;
    </code></pre>
        <p>Run console script to migrate CMS Block - Category relations to the new structure: <var>vendor/bin/console cms-block-category-connector:migrate-position</var>.</p>
        <p>&#160;</p>
        <p><b>See more:</b>
        </p>
        <ul>
            <li>Get a general idea about CMS Block Category Connector</li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Aug 30, 2017 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Denis Tukrov</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>