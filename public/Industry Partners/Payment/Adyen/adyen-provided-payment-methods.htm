<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.ShopSuite">
    <head><title>Adyen - Provided Payment Methods | Spryker</title>
        <meta name="description" content="Spryker Adyen method provides the following payment methods: Credit Card, Direct Debit, Klarna Invoice, Prepayment, Sofort, PayPal, iDeal, AliPay, WeChatPay.&#xD;&#xA;&#xD;&#xA;" />
    </head>
    <body>
        <h1>Adyen - Provided Payment Methods</h1>
        <h2><a name="Credit"></a>Credit Card</h2>
        <p>Adyen module provides integration with possible ways: simple and with 3D Secure authorization.</p>
        <p>3D Secure integration requires adjustments on project level.</p>
        <p>At first you will need to add additional Checkout Step. Example of implementation:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>src/Pyz/Yves/CheckoutPage/Process/Steps/AdyenExecute3DStep.php</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
&lt;?php

namespace Pyz\Yves\CheckoutPage\Process\Steps;

use Pyz\Yves\CheckoutPage\CheckoutPageConfig;
use Spryker\Shared\Kernel\Transfer\AbstractTransfer;
use SprykerEco\Shared\Adyen\AdyenConfig;
use SprykerShop\Yves\CheckoutPage\Dependency\Client\CheckoutPageToQuoteClientInterface;
use SprykerShop\Yves\CheckoutPage\Process\Steps\AbstractBaseStep;

class AdyenExecute3DStep extends AbstractBaseStep
{
	/**
	 * @var \SprykerShop\Yves\CheckoutPage\Dependency\Client\CheckoutPageToQuoteClientInterface
	 */
	protected $quoteClient;

	/**
	 * @var \Pyz\Yves\CheckoutPage\CheckoutPageConfig
	 */
	protected $config;

	/**
	 * @param string $stepRoute
	 * @param string $escapeRoute
	 * @param \SprykerShop\Yves\CheckoutPage\Dependency\Client\CheckoutPageToQuoteClientInterface $quoteClient
	 * @param \Pyz\Yves\CheckoutPage\CheckoutPageConfig $config
	 */
	public function __construct(
		$stepRoute,
		$escapeRoute,
		CheckoutPageToQuoteClientInterface $quoteClient,
		CheckoutPageConfig $config
	) {
		parent::__construct($stepRoute, $escapeRoute);

		$this-&gt;quoteClient = $quoteClient;
		$this-&gt;config = $config;
	}

	/**
	 * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
	 *
	 * @return bool
	 */
	public function requireInput(AbstractTransfer $quoteTransfer)
	{
		if ($quoteTransfer-&gt;getPayment()-&gt;getPaymentSelection() === AdyenConfig::ADYEN_CREDIT_CARD &amp;&amp;
			$this-&gt;config-&gt;isAdyenCreditCard3dSecureEnabled()
		) {
			return true;
		}

		return false;
		}

		/**
		 * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
		 *
		 * @return bool
		 */
		public function postCondition(AbstractTransfer $quoteTransfer)
		{
			return true;
		}

		/**
		 * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
		 *
		 * @return array
		 */
		public function getTemplateVariables(AbstractTransfer $quoteTransfer)
		{
			$data = [
				'action' =&gt; $quoteTransfer-&gt;getPayment()-&gt;getAdyenRedirect()-&gt;getAction(),
				'fields' =&gt; $quoteTransfer-&gt;getPayment()-&gt;getAdyenRedirect()-&gt;getFields(),
		];

		return $data;
	}
}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>Then add template for this step:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>src/Pyz/Yves/CheckoutPage/Theme/default/views/adyen/execute_3d.twig</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
{% extends template('page-layout-main') %}
 
{% block body %}
	&lt;form id="adyenExecute3DStepForm_" name="adyenExecute3DStepForm" method="post" action="{{ _view.action }}"&gt;
		{% for key, value in _view.fields %}
			&lt;input type="hidden" id="adyenExecute3DStepForm_{{ key }}" name="{{ key }}" value="{{ value }}"&gt;
		{% endfor %}
	&lt;/form&gt;
	&lt;script type="text/javascript"&gt;
		document.getElementById('adyenExecute3DStepForm_').submit();
	&lt;/script&gt;
{% endblock %}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>And put it between place order and success steps:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>src/Pyz/Yves/CheckoutPage/Process/StepFactory.php</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
	public function createStepCollection()
	{
		$stepCollection = new StepCollection(
			$this-&gt;getUrlGenerator(),
			CheckoutPageControllerProvider::CHECKOUT_ERROR
		);
 
		$stepCollection
			-&gt;addStep($this-&gt;createEntryStep())
			-&gt;addStep($this-&gt;createCustomerStep())
			-&gt;addStep($this-&gt;createAddressStep())
			-&gt;addStep($this-&gt;createShipmentStep())
			-&gt;addStep($this-&gt;createPaymentStep())
			-&gt;addStep($this-&gt;createSummaryStep())
			-&gt;addStep($this-&gt;createPlaceOrderStep())
			-&gt;addStep($this-&gt;createAdyenExecute3DStep())
			-&gt;addStep($this-&gt;createSuccessStep());
 
		return $stepCollection;
	}
 
...
 
	public function createAdyenExecute3DStep(): StepInterface
	{
		return new AdyenExecute3DStep(
			CheckoutPageControllerProvider::CHECKOUT_ADYEN_EXECUTE_3D,
			HomePageControllerProvider::ROUTE_HOME,
			$this-&gt;getQuoteClient(),
			$this-&gt;getConfig()
		);
	}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>Do not forget to add step action to controller provider:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>src/Pyz/Yves/CheckoutPage/Plugin/Provider/CheckoutPageControllerProvider.php</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
	public const CHECKOUT_ADYEN_EXECUTE_3D = 'checkout-adyen-execute-3d';
 
	protected function defineControllers(Application $app)
	{
		$this-&gt;addCheckoutIndexRoute()
			-&gt;addCustomerStepRoute()
			-&gt;addAddressStepRoute()
			-&gt;addShipmentStepRoute()
			-&gt;addPaymentStepRoute()
			-&gt;addCheckoutSummaryStepRoute()
			-&gt;addPlaceOrderStepRoute()
			-&gt;addCheckoutErrorRoute()
			-&gt;addCheckoutSuccessRoute()
			-&gt;addAdyenExecute3DStepRoute();
	}
 
...
 
	protected function addAdyenExecute3DStepRoute(): self
	{
		$this-&gt;createController('/{checkout}/adyen-execute-3d', static::CHECKOUT_ADYEN_EXECUTE_3D, 'CheckoutPage', 'Checkout', 'adyenExecute3D')
			-&gt;assert('checkout', $this-&gt;getAllowedLocalesPattern() . 'checkout|checkout')
			-&gt;value('checkout', 'checkout')
			-&gt;method('GET|POST');
 
		return $this;
	}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>At last extend <var>PlaceOrder</var> step to set 3D Secure url and params into <var>QuoteTransfer</var>:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>src/Pyz/Yves/CheckoutPage/Process/Steps/PlaceOrderStep.php</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
	public function execute(Request $request, AbstractTransfer $quoteTransfer)
	{
		...
		$quoteTransfer-&gt;getPayment()-&gt;setAdyenRedirect($checkoutResponseTransfer-&gt;getAdyenRedirect());
 
		return $quoteTransfer;
	}</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenCreditCard01.xml</var></p>
        <h2><a name="Direct"></a>Direct Debit (SEPA Direct Debit)</h2>
        <p>SEPA (Single Euro Payments Area) Direct Debit was introduced by the European Payments Council to create a standardized payments infrastructure within the EU. With SEPA Direct Debit, businesses can process one-off or recurring payments for EU customers, making it a key payment method for businesses looking to expand across Europe.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenDirectDebit01.xml</var></p>
        <h2><a name="Klarna"></a>Klarna Invoice</h2>
        <p>Klarna Invoice enables your customers to pay without giving their credit card information to the online store. The customers do not have to pay until they have received their products.</p>
        <p>When a customer has checked out an order in your online store he/she will be able to choose Klarna and then the customer needs to type in his/her full social security number (CPR in Denmark). German or Dutch customers have to type in their Birth date. The customer is accepted throughout a credit check, which is done by Klarna. When the customer is accepted, Klarna pays the full amount to your online shop and the customer has to pay the amount directly to Klarna.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenKlarnaInvoice01.xml</var></p>
        <h2><a name="Prepayme"></a>Prepayment (Bank Transfer IBAN)</h2>
        <p>Prepayment method is a safe alternative to payments involving credit cards or debit cards (such as online banking transfer). Usually bank transfer would require manual processing to mark transaction as cancelled or completed, but the process is fully automated through the integration with the Adyen platform.</p>
        <p>The payment status is transmitted to the shop via a notification from the payment provider(Adyen).</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenPrepayment01.xml</var></p>
        <h2><a name="Sofort"></a>Sofort</h2>
        <p>SOFORT is the main online direct payment method and works via online banking. It is the predominant online banking method in countries such as Germany, Austria, Switzerland and Belgium, making it a must-have for any business wanting to operate in this area.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenSofort01.xml</var></p>
        <h2><a name="PayPal"></a>PayPal</h2>
        <p>PayPal Holdings, Inc. is an American company operating a worldwide online payments system that supports online money transfers and serves as an electronic alternative to traditional paper methods like cheques and money orders. The company operates as a payment processor for online vendors, auction sites, and other commercial users, for which it charges a fee in exchange for benefits such as one-click transactions and password memory.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenPayPal01.xml</var></p>
        <h2><a name="iDeal"></a>iDeal</h2>
        <p>The most popular payment method in the Netherlands, iDEAL is an inter-bank system covered by all major Dutch consumer banks.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenIdeal01.xml</var></p>
        <h2><a name="AliPay"></a>AliPay</h2>
        <p>Alipay is the most widely used third-party online payment service provider in China. With over 100 million daily transactions and over 520 million active users. Its primary product is a digital wallet, Alipay Wallet, which also includes a mobile app that allows customers to conduct transactions directly from their mobile devices.</p>
        <p>Alipay is a must-have payment method for any business looking to reach a critical mass of Chinese shoppers both home and abroad. It is available in 70 markets and has already been adopted by over 80,000 retail stores worldwide.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenAliPay01.xml</var></p>
        <h2><a name="WeChatPa"></a>WeChatPay</h2>
        <p>WeChat Pay is rapidly becoming a keystone payment method for businesses wanting to reach Chinese shoppers, both home and abroad. Originally a messaging app (like WhatsApp) WeChat has evolved into an ecosystem that allows Chinese shoppers to chat, browse, and make payments, all in one place - making shopping as easy as chatting to your friends.</p>
        <p>State machine example can be found in: <var>vendor/spryker-eco/adyen/config/Zed/Oms/AdyenWeChatPay01.xml</var></p>
        <p>&#160;</p>
        <p><b>See also</b>:</p>
        <ul>
            <li><a href="adyen.htm">Get acquainted with Adyen</a>
            </li>
            <li><a href="adyen-configuration.htm">Configure Adyen</a>
            </li>
            <li><a href="adyen-integration.htm">Integrate Adyen in your project</a>
            </li>
            <li><a href="adyen-filter-payment-methods.htm">Learn about Adyen Filter Payment Methods
					</a>
            </li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: November, 16th, 2018 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Aleksey Kotsuba, Oksana Karasyova</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>