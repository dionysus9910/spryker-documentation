<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="General.Draft,Spryker.B2C,Spryker.DemoShop">
    <head>
        <link href="../../../Resources/TableStyles/PatternedRows2.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Klarna - State Machine Commands and Conditions</title>
    </head>
    <body>
        <h1>Klarna - State Machine Commands and Conditions
<img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Commands
</h2>
        <p><b>Check</b><![CDATA[

]]></p>
        <ul>
            <li class="bullet_list">Checks order Status
</li>
            <li class="bullet_list">Update order status
</li>
            <li class="bullet_list">Plugin: <var>CheckPlugin</var></li>
        </ul>
        <p><b>Capture</b><![CDATA[

]]></p>
        <ul>
            <li class="bullet_list">Activates the reservation that corresponds to the given reference number
</li>
            <li class="bullet_list">Response:
<ul><li class="bullet_list">Success: order activated
</li><li class="bullet_list">Declined: capture failed. Need to update order
</li></ul></li>
            <li class="bullet_list">Plugin: <var>CapturePlugin</var></li>
        </ul>
        <p style="font-weight: bold;">Update

</p>
        <ul>
            <li class="bullet_list">Updates a reservation
</li>
            <li class="bullet_list">Response:
</li>
            <li class="bullet_list">Success: Reservation updated
</li>
            <li class="bullet_list">Declined: Some error occurred
</li>
            <li class="bullet_list">Plugin: <var>UpdatePlugin</var></li>
        </ul>
        <p><b>Cancel</b>
        </p>
        <ul>
            <li class="bullet_list">Cancels a reservation
</li>
            <li class="bullet_list">Plugin: <var>CancelPlugin</var></li>
        </ul>
        <p><b>Refund</b>
        </p>
        <ul>
            <li class="bullet_list">Performs a partial refund
</li>
            <li class="bullet_list">Response:
<ul><li class="bullet_list">Success: Refund possible and accepted
</li><li class="bullet_list">Declined: Some error occurred
</li></ul></li>
            <li class="bullet_list">Plugin: <var>RefundPlugin</var></li>
        </ul>
        <h2>Conditions
</h2>
        <table class="TableStyle-PatternedRows2" style="mc-table-style: url('../../../Resources/TableStyles/PatternedRows2.css');" cellspacing="0">
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <thead>
                <tr class="TableStyle-PatternedRows2-Head-Header1">
                    <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Name	</th>
                    <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Description	</th>
                    <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Plugin
</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>IsOrderStatusApproved</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>Checks if order payment status is pending accepted</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p><var>IsOrderStatusApprovedPlugin</var>
                        </p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>IfHasCapture</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>Checks if the capture response is successful</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p><var>IfHasCapturePlugin</var>
                        </p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">
                        <p><var>IsOrderDenied</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-LightRows">
                        <p>Checks if order payment status is denied</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyA-Regular-LightRows">
                        <p><var>IsOrderDeniedPlugin</var>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>KlarnaFacade
</h2>
        <table style="margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/PatternedRows2.css');" class="TableStyle-PatternedRows2" cellspacing="0">
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <col class="TableStyle-PatternedRows2-Column-Regular" />
            <thead>
                <tr class="TableStyle-PatternedRows2-Head-Header1">
                    <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Facade Method</th>
                    <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Param	</th>
                    <th class="TableStyle-PatternedRows2-HeadE-Regular-Header1">Return	</th>
                    <th class="TableStyle-PatternedRows2-HeadD-Regular-Header1">Description
</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>saveOrderPayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>QuoteTransfer</var>, <var>CheckoutResponseTransfer</var></p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>void	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Saves the payment for the submitted order</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>reserveAmount</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>QuoteTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>KlarnaReserveAmountResponseTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Reserves the amount of the purchase</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>updatePayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>QuoteTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>KlarnaReserveAmountResponseTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Update the reservation matching the given reservation number</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>capturePayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>SpyPaymentKlarna</var>, <var>OrderTransfer</var></p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>array	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Activate the reservation matching the given reservation number</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>capturePartPayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>array <var>$orderItems</var>, <var>SpyPaymentKlarna</var>, <var>OrderTransfer</var></p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>array	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Activate the reservation matching the given reservation number</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>refundPayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>SpyPaymentKlarna</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>string	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Performs a complete refund</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>refundPartPayment</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>array <var>$orderItems</var>, <var>SpyPaymentKlarna</var></p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>string	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Performs a partial refund</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>sendInvoiceByMail</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>SpyPaymentKlarna</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>string	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Sends an activated invoice to the customer via e-mail</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>sendInvoiceByPost</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>SpyPaymentKlarna</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>string	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Requests a postal send-out of an activated invoice to a customer by Klarna</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>getInstallments</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>QuoteTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>KlarnaInstallmentResponseTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Get available Part Payments</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>getPaymentLogs</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>ObjectCollection $orders</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>array	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Return all payment logs for submitted orders</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>getKlarnaCheckoutHtml</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>QuoteTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>KlarnaCheckoutTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Return checkout values</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>getKlarnaSuccessHtml</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>KlarnaCheckoutTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>KlarnaCheckoutTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Return success values</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>createCheckoutOrder</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>KlarnaCheckoutTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>bool	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Creates checkout order</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>checkOrderStatus</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>SpyPaymentKlarna</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>	int</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>	Return order status</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>cancelOrder</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>SpyPaymentKlarna</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>bool	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Cancels payment</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>getKlarnaPaymentById</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>int $salesOrderId</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p>	array</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>Return order payment data</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>getInvoicePdfUrl</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p><var>int $salesOrderId</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-DarkerRows">
                        <p>string	</p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-DarkerRows">
                        <p>Return pdf URL from config</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-LightRows">
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>checkoutService</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>QuoteTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyE-Regular-LightRows">
                        <p><var>KlarnaCheckoutServiceTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyD-Regular-LightRows">
                        <p>			Perform a checkout service request
</p>
                    </td>
                </tr>
                <tr class="TableStyle-PatternedRows2-Body-DarkerRows">
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">
                        <p><var>getAddressUpdater</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">
                        <p><var>OrderTransfer</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyB-Regular-DarkerRows">
                        <p><var>AddressUpdater</var>
                        </p>
                    </td>
                    <td class="TableStyle-PatternedRows2-BodyA-Regular-DarkerRows">
                        <p>		Return <var>AddressUpdater</var> from the factory</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p><b>See also:
			</b>
        </p>
        <ul>
            <li><a href="klarna.htm">Learn about Klarna payment system</a>
            </li>
            <li><a href="klarna-payment-workflow.htm">Learn about Klarna payment workflow</a>
            </li>
            <li><a href="klarna-part-payment-flexible.htm">Implement partial payments with Klarna</a>
            </li>
            <li><a href="klarna-invoice-pay-in-14-days.htm">Configure invoice 14-day payment with Klarna</a>
            </li>
        </ul>
    </body>
</html>