<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="Spryker.DemoShop,Spryker.B2C">
    <head>
    </head>
    <body>
        <h1>Computop - Direct Debit <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Example State Machine</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <div>
                    <img class="o-cover__logo" src="../../../Resources/Images/Computop/computop-direct-debit-flow-example.png" />
                </div>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <h2>Front-end Integration</h2>
        <p>
    To adjust the frontend appearance, provide the following templates in your theme directory:
</p>
        <p class="bullet_list"><var>src/&lt;project_name&gt;/Yves/Computop/Theme/&lt;custom_theme_name&gt;/direct_debit.twig</var>
        </p>
        <h2>State Machine Integration</h2>
        <p>The Computop provides a demo state machine for Direct Debit payment method which implements Authorization/Capture flow.

</p>
        <p>To enable the demo state machine, extend the configuration with the following values:

</p><pre><code class="language-php line-numbers">
    &lt;?php
$config[SalesConstants::PAYMENT_METHOD_STATEMACHINE_MAPPING] = [
    ...
    ComputopConfig::PAYMENT_METHOD_DIRECT_DEBIT =&gt; 'ComputopDirectDebit',
];

$config[OmsConstants::ACTIVE_PROCESSES] = [
    ...
    'ComputopDirectDebit',
];</code></pre>
        <h2>Direct Debit Payment Flow:</h2>
        <ol>
            <li>
        There is a radio button on "Payment" step.
        After submitting the order the customer will be redirected to the Computop (Paygate form implementation).
        The GET consists of 3 parameters:
			<ul><li>data (encrypted parameters, e.g. currency, amount, description);</li><li>length (length of 'data' parameter);</li><li>merchant id (assigned by Computop);</li></ul>
        Customer sets up all data just after the redirect to Computop.
        Init action: "Authorization". There is no Order call provided for this payment method. But Authorization call is working as Order call - without holding money. There is no call for holding money for this payment method.
    </li>
            <li>
        By default, on success the customer  will be redirected to "Success" step. The response contains <var>payId</var>
        On error, the customer  will be redirected to "Payment" step with the error message by default.
        Response data is stored in the DB.
    </li>
            <li>
        Capture/Refund and Cancel actions are implemented in the admin panel (on manage order).
        On requests, Spryker will use <var>payId</var> parameter stored in the DB to identify a payment.
    </li>
        </ol>
        <h2>Set Up Details:</h2>
        <p>For partial refunds:</p>
        <ol>
            <li>Partial refunds are possible for direct debit transactions.</li>
            <li>But please note, that you can not test it in test mode.</li>
            <li>If you want to test it, you have to say it afterwards to Computop help desk, so that they can prepare the transaction.</li>
        </ol>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <ul>
            <li><a href="computop.htm">Get a general idea about Computop</a><![CDATA[
            ]]></li>
            <li><a href="computop-api-details.htm">Learn about Computop API
            
</a>
            </li>
            <li><a href="computop-oms-details.htm">Get acquainted with Computop OMS functioning
            
</a>
            </li>
            <li><a href="computop-credit-card.htm">Configure Credit Card payment method for Computop
            
</a>
            </li>
            <li><a href="computop-easy-credit.htm">Configure Easy Credit payment method for Computop
            
</a>
            </li>
            <li><a href="computop-ideal.htm">Configure iDeal payment method for Computop</a><![CDATA[
            ]]></li>
            <li><a href="computop-ideal.htm">Configure Paydirekt payment method for Computop</a><![CDATA[
            ]]></li>
            <li><a href="computop-paynow.htm">Configure PayNow payment method for Computop
            
</a>
            </li>
            <li><a href="computop-paypal.htm">Configure PayPal payment method for Computop
            
</a>
            </li>
            <li><a href="computop-sofort.htm">Configure Sofort payment method for Computop
            
</a>
            </li>
            <li><a href="computop-crif.htm">Computop CRIF</a><![CDATA[           
			]]></li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Feb. 20th, 2018</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment">by Aleksey Kotsuba</MadCap:conditionalText>
        </p>
    </body>
</html>