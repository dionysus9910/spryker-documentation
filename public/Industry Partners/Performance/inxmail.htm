<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.B2C,Spryker.B2B,Spryker.ShopSuite,Spryker.DemoShop">
    <head><title>Email Provider - Inxmail</title>
    </head>
    <body>
        <h1>Email Provider - Inxmail <img src="../../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../Resources/Images/shoptype/MasterSuite.png" /> <img src="../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <p>
            <img src="../../Resources/Images/inxmail_Logo.png" />
        </p>
        <h2>Partner Information</h2>
        <table style="margin-left: 0; margin-right: auto;">
            <col style="width: 766px;">
            </col>
            <col>
            </col>
            <tbody>
                <tr>
                    <td><a href="https://www.inxmail.com" target="_blank">ABOUT INXMAIL</a>
                    </td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td colspan="2">
                        <p>With nearly 20 years of experience, we are a pioneer in software development for email marketing. We support our customers and partners with fantastic service and grow their potential in a targeted way. In doing so, we draw upon a broad range of technology and services.</p>
                        <p>Our solutions are influenced by our strong relationships with customers. We flexibly adapt our solutions to meet specific customer needs. Expertise that pays off: We have been implementing successful email marketing and multichannel campaigns for over 2,000 customers in more than 20 countries since 1999.</p>
                    </td>
                </tr>
                <tr>
                    <td>YOUR ADVANTAGES:<![CDATA[					]]></td>
                    <td>&#160;</td>
                </tr>
                <tr>
                    <td colspan="2">
                        <ul>
                            <li>Broad portfolio of technology, service and know-how - from the standard solution to individual solution packages</li>
                            <li>E-mail delivery solutions for highly personalized newsletters, transaction mails, and automated e-mail campaigns</li>
                            <li>Delivery security via whitelisted mail server even with high mail volumes</li>
                            <li>Powerful interfaces for seamless integration into existing system landscapes</li>
                            <li>Software made and hosted in Germany</li>
                            <li>DSGVO-compliant e-mail marketing</li>
                            <li>Co-founder and member of the Certified Senders Alliance (CSA)</li>
                            <li>Award Winning: Competent, Fast and Reliable Customer Service and Support</li>
                            <li>Personal advice and contact person</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>Installation</h2>
        <p>To install Inxmail run the command in the console:</p><pre><code class="language-php">
	composer require spryker-eco/inxmail:1.0.0
				</code></pre>
        <h2>Configuration</h2>
        <p>To set up the Inxmail initial configuration, use the credentials you received from your Inxmail server. Space id, key id and secret you can get from Settings → API keys panel on Inxmail server:</p><pre><code class="language-PHP line-numbers">
	$config[InxmailConstants::API_EVENT_URL] = '';
	$config[InxmailConstants::KEY_ID] = '';
	$config[InxmailConstants::SECRET] = '';
				</code></pre>
        <p>Event names depend on your events names on Inxmail server:</p><pre xml:space="preserve"><code class="language-PHP line-numbers">
	$config[InxmailConstants::EVENT_CUSTOMER_REGISTRATION] = '';
	$config[InxmailConstants::EVENT_CUSTOMER_RESET_PASSWORD] = '';
	$config[InxmailConstants::EVENT_ORDER_NEW] = '';
	$config[InxmailConstants::EVENT_ORDER_SHIPPING_CONFIRMATION] = '';
	$config[InxmailConstants::EVENT_ORDER_CANCELLED] = '';
	$config[InxmailConstants::EVENT_ORDER_PAYMENT_IS_NOT_RECEIVED] = '';
		</code></pre>
        <h2>Integration</h2>
        <h3>New customer registration event</h3>
        <p>Inxmail module has <code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Customer\InxmailPostCustomerRegistrationPlugin</code>. This plugin implements <code>PostCustomerRegistrationPluginInterface</code> and can be used in <code>\Pyz\Zed\Customer\CustomerDependencyProvider::getPostCustomerRegistrationPlugins.</code></p><pre><code class="language-PHP line-numbers">
	...
	use SprykerEco\Zed\Inxmail\Communication\Plugin\Customer\InxmailPostCustomerRegistrationPlugin
	...
 
	/**
	 * @return \Spryker\Zed\CustomerExtension\Dependency\Plugin\PostCustomerRegistrationPluginInterface[]
	 */
	protected function getPostCustomerRegistrationPlugins(): array
	{
		return [
			...
			new InxmailPostCustomerRegistrationPlugin(),
			...
		];
	}
		</code></pre>
        <h3>The customer asked to reset password event</h3>
        <p>Inxmail module has <code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Customer\InxmailCustomerRestorePasswordMailTypePlugin</code>. This plugin implements <code>MailTypePluginInterface</code> and can be used in <code>\Pyz\Zed\Mail\MailDependencyProvider::provideBusinessLayerDependencies</code></p><pre><code class="language-PHP line-numbers">
	...
	use \SprykerEco\Zed\Inxmail\Communication\Plugin\Customer\InxmailCustomerRestorePasswordMailTypePlugin;
	...

	/**
	 * @param \Spryker\Zed\Kernel\Container $container
	 *
	 * @return \Spryker\Zed\Kernel\Container
	 */
	public function provideBusinessLayerDependencies(Container $container)
	{
		$container = parent::provideBusinessLayerDependencies($container);

		$container-&gt;extend(self::MAIL_TYPE_COLLECTION, function (MailTypeCollectionAddInterface $mailCollection) {
			$mailCollection
				...
				-&gt;add(new InxmailCustomerRestorePasswordMailTypePlugin())
				...

			return $mailCollection;
		});

		...

		return $container;
	}
			</code></pre>
        <h3>Order referenced commands</h3>
        <p>Inxmail module has four different commands:</p>
        <ul>
            <li><code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Oms\Command\InxmailNewOrderPlugin</code>
            </li>
            <li><code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Oms\Command\InxmailOrderCanceledPlugin</code>
            </li>
            <li><code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Oms\Command\InxmailPaymentNotReceivedPlugin</code>
            </li>
            <li><code>\SprykerEco\Zed\Inxmail\Communication\Plugin\Oms\Command\InxmailShippingConfirmationPlugin</code>
            </li>
        </ul>
        <p>You can use this commands in&#160;<code>\Pyz\Zed\Oms\OmsDependencyProvider::getCommandPlugins</code></p><pre><code class="language-PHP line-numbers">
	...
	use SprykerEco\Zed\Inxmail\Communication\Plugin\Oms\Command\InxmailNewOrderPlugin;
	...

	/**
	 * @param \Spryker\Zed\Kernel\Container $container
	 * 
	 * @return \Spryker\Zed\Oms\Communication\Plugin\Oms\Command\CommandCollection
	 */
	protected function getCommandPlugins(Container $container)
	{
		$collection = parent::getCommandPlugins($container);

		...
		$collection-&gt;add(new InxmailNewOrderPlugin(), 'Inxmail/SendNewOrderRequest');
		...

		return $collection;
	}
		</code></pre>
        <p>After that you are ready to use commands in OMS setup:</p><pre><code class="language-PHP line-numbers">
	&lt;events&gt;
		&lt;event name="authorize" onEnter="true" manual="true" command="Inxmail/SendNewOrderRequest"/&gt;
		&lt;event name="pay" manual="true" timeout="1 hour" /&gt;
		&lt;event name="export" onEnter="true" manual="true" command="Oms/SendOrderConfirmation"/&gt;
		&lt;event name="ship" manual="true" command="Oms/SendOrderShipped"/&gt;
		&lt;event name="stock-update" manual="true"/&gt;
		&lt;event name="close" manual="true" timeout="1 hour"/&gt;
		&lt;event name="return" manual="true" /&gt;
	&lt;/events&gt;
		</code></pre>
        <h2>API Requests</h2>
        <p><code>\SprykerEco\Zed\Inxmail\Business\Api\Adapter\EventAdapter</code> which extend <code>\SprykerEco\Zed\Inxmail\Business\Api\Adapter\AbstractAdapter</code> contains all needed data for sending data to Inxmail for events.</p>
        <p>It sends the request via <code>&#160;\Generated\Shared\Transfer\InxmailRequestTransfer</code></p><pre><code class="language-xml">
	&lt;?xml version="1.0"?&gt;
	&lt;transfers xmlns="http://xsd.spryker.com"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xsi:schemaLocation="http://static.spryker.com http://static.spryker.com/transfer-01.xsd"&gt;

		&lt;transfer name="InxmailRequest"&gt;
			&lt;property name="event" type="string" /&gt;
			&lt;property name="transactionId" type="string" /&gt;
			&lt;property name="payload" type="array" /&gt;
		&lt;/transfer&gt;

	&lt;/transfers&gt;
				</code></pre>
        <p>The payload for customer loads from <code>&#160;\SprykerEco\Zed\Inxmail\Business\Mapper\Customer\AbstractCustomerMapper::getPayload</code> and for order from <code>&#160;\SprykerEco\Zed\Inxmail\Business\Mapper\Order\AbstractOrderMapper</code>. Abstract classes can be extended and changed in <code>&#160;\SprykerEco\Zed\Inxmail\Business\InxmailBusinessFactory.</code></p>
        <p class="note">For right URL's to images in the email body you should extend <code>\SprykerEco\Zed\Inxmail\Business\Mapper\Order\AbstractOrderMapper</code> and implement protected method <code>getImageItemLink(ArrayObject $images)</code>.</p>
        <p>&#160;</p>
        <h2>Copyright and Disclaimer</h2>
        <p>See <a href="https://github.com/spryker/spryker-documentation" target="_blank">Disclaimer</a>.</p>
        <p>&#160;</p>
        <p><i>Last review date: Aug. 28th, 2018 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Volodymyr Hrychenko</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>