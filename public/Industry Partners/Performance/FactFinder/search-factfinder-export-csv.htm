<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.DemoShop,Spryker.B2C">
    <head><title>FACT-Finder - Exporting CSVs</title>
    </head>
    <body>
        <h1>FACT-Finder - Exporting CSVs <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Output Folder </h2>
        <p>Define an output folder where  the CSV files will be generated by adding the following line in your configuration file:</p><pre><code class="language-php line-numbers">&lt;?php
$config[FactFinderSdkConstants::CSV_DIRECTORY] = APPLICATION_ROOT_DIR . '/path/to/generated/csv/files';</code></pre>
        <p class="note">Zed must have Read / Write access to this folder because  we will generate and read CSV files in that directory.</p>
        <h2>Queries</h2>
        <p>To export data to the CSV, we need to define the queries  executed in the database.</p>
        <p>All queries are located in the <code>SprykerEco\Zed\FactFinderSdk\Persistence\FactFinderSdkQueryContainer </code> directory.</p>
        <p>To change the query in <code>FactFinderSdk</code> module, we need to extend the <code>FactFinderSdkQueryContainer</code> in your project.</p>
        <h2>How is my Query Mapped to CSV Output ?</h2>
        <p>If you need to modify the CSV column mapping for any reason, you will have to extend the <code>FactFinderSdkQueryContainer</code> from <code>FactFinderSdk</code> module and implement your own <code>addColumns</code> method.</p>
        <h3>Console</h3>
        <p>To export the products and categories using the queries we made before, we must register the <code>FactFinderSdk</code> console command in <a href="https://documentation.spryker.com/capabilities/development/console.htm">Console</a>.</p>
        <p>The <code>FactFinderSdk</code> module already includes everything though you will need to add <code>FactFinderSdkExportConsole</code> to <code>Pyz\Zed\Console\ConsoleDependencyProvider</code> like below:</p><pre><code class="language-php line-numbers">&lt;?php

/**
* @param \Spryker\Zed\Kernel\Container $container
*
* @return \Symfony\Component\Console\Command\Command[]
*/
public function getConsoleCommands(Container $container)
{
   $commands = [
       ...
       new FactFinderSdkExportConsole(),
   ];
       ...
}</code></pre>
        <h3>Restrictions</h3>
        <ul>
            <li>The first row of the CSV file must contain the field names. The structure of this row is identical to the data rows.</li>
            <li>The number of fields is limited to 128. However, the standard FACT-Finder modules require the use of a limited number of fields. For that reason, we recommend that you do not use this limit in full. If your product database contains more than 128 attributes, you can store them in the multi-attribute fields.</li>
            <li>The field content is not limited in length. There is, however, a limit on the complete data record size. This limit is set at 50,000 characters. In special cases, the limit can be removed. We consider it as a part of a special FACT-Finder package creation process we perform  for you.</li>
        </ul>
        <h3>Recommendations</h3>
        <ul>
            <li>
            To save transmission bandwidth, you may compress the file in ZIP format before sending it to FACT-Finder. Other compression formats are also supported: GZip, BZip, GZip+TAR. RAR files and other archive formats are not supported by FACT-Finder automatic data update process.
        </li>
            <li>
            FACT-Finder suggests two ways of data exporting - downloads and uploads. Currently, export implemented for the downloads.
            You need to create an URL for a CSV file or put it into a public folder. Then you can set up an URL and an interval
            in a FACT-Finder channel management panel to download the CSV file.
        </li>
            <li>
            A CSV file export can be scheduled with the help of a cron job or triggered by an event.
        </li>
            <li>
                
            If additional attributes are available, they can also be used by the search process.
 </li>
            <li>If you have attribute types that vary from item to item, it does not make sense to create a separate field for every possible attribute type. Instead, you can create an attribute field that is formatted according to the following pattern: <code>|attribute1=value|attribute2=value|attribute3=value|</code>. <p class="note">Please note that  for the Attribute field the pipe separator <code>(|)</code> appears between the attributes, as well as at the beginning and at the end of the field contents. Also note, that the symbols <code>|</code>, <code>#</code> and <code>=</code> are reserved symbols in attribute field data and therefore are not permitted here. For some attributes, it is desirable to include a unit or currency designator. You must separate the attribute name from the unit with a double tilde <code>(~~)</code>. Please note that there can only be one unit per attribute name (even if the attributes appear in different data records), so the values must be normalized beforehand.</p></li>
        </ul>
        <h2>Checking Your Setup</h2>
        <p>If all the steps were correct you should be able to see the <code>fact-finder:export:products</code> command in the FACT-Finder section when you run <code>vendor/bin/console</code> from the project's root folder.</p>
        <p>Running <code>vendor/bin/console fact-finder:export:products</code> will create several CSV files (one per locale) in the folder you specified in <code>`$config[FactFinderSdkConstants::CSV_DIRECTORY]</code>.</p>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <ul>
            <li><a href="factfinder.htm">Get a general idea about FACT-Finder</a>
            </li>
            <li><a href="search-factfinder-recommendation.htm">Configure FACT-Finder recommendations widget</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-search.htm">Configure FACT-Finder Search</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-suggest.htm">Configure FACT-Finder Suggest module</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-campaigns.htm">Configure FACT-Finder Campaign Manager module</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-tracking.htm">Learn more about FACT-Finder tracking system</a><![CDATA[
            ]]></li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Dec. 22nd, 2017</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i> by Mykhailo Kozii</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>