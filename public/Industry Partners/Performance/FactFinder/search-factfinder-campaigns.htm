<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.DemoShop,Spryker.B2C">
    <head><title>[%=Heading.Level1%]</title>
    </head>
    <body>
        <h1>FACT-Finder - Campaigns <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Prerequisites</h2>
        <p>
            The FACT-Finder Campaign Manager module allows you to target the management of search results in order to improve the customer lead process or deliberately highlight products.
            Campaigns are activated according to the specific criteria and are then returned accordingly in the search results.
        </p>
        <p>
            Campaigns are a powerful tool for visual merchandising. One of their numerous functions is automatic redirects to static pages for specific search terms, e.g. searching for "ToS" automatically redirects the user to the terms of service page. Even more importantly, campaigns allow for targeted placement of banners or the customization of search results.</p>
        <p>These types of the campaign can be created with the Campaign Assistant:</p>
        <ul>
            <li>Feedback Campaigns: Display preset texts and banners with search results. Also used for pushed products.</li>
            <li>Redirect Campaigns: Redirect the user to the specific pages for certain search terms.</li>
            <li>Advisor Campaigns: Manages questions and answers that are presented to the shop visitor. Answers lead to specific product sets.</li>
            <li>Product Campaigns: Allows you to place campaigns on product pages instead of search result pages.</li>
        </ul>
        <h3>Feedback Campaign</h3>
        <p>
            Feedback campaigns add predefined banners, texts, and products aimed to search results in reaction to specific search terms or other triggers.
            These campaigns are best suited to pushing products.
            A feedback campaign can also be used to place videos, point the customer towards the brand stores or to the designed zero-result pages.
        </p>
        <h3>Redirect Campaign</h3>
        <p>
			Redirect campaigns react to triggers like search words and send users to specific pages, like Contact, ToS, etc.
			Every webstore has a number of pages that should be available in this way.
			Apart from the contact form and terms of service, payment and shipping conditions, as well as the about page, fall into that list.

        </p>
        <h3>Redirect Campaign</h3>
        <p>
            Advisor campaigns give you the ability to set up questions as text or images which are presented to the customer in certain situations.
            You group the questions with the preset answers the customer can choose. Each answer is combined with a product set which is
            displayed to the user on giving the answer. This gives you the ability to guide the user with targeted questions.
            Advisor campaigns are especially useful to react to rising trends or frequently used filter combinations.
        </p>
        <h3>Product Campaign</h3>
        <p>
            Product campaigns can be placed on any product detail page, shopping cart page or shop page and display a specific product set.
            They employ the same method of defining product sets but are different in the way they are triggered.
        </p>
        <h2>Usage </h2>
        <h3>Search Page</h3>
        <p>Search result campaigns are fetched implicitly by invoking a search request. Examples of integration of advisor, redirect, feedback and pushed products campaigns can be found in <code>vendor/spryker-eco/fact-finder/src/SprykerEco/Yves/FactFinder/Theme/default/search/catalog.twig</code></p>
        <h3>Product Details Page</h3>
        <p>To fetch Fact-Finder campaigns for product page, you need to make a call using Fact-Finder client. To do that:</p>
        <ol>
            <li>
        Add FactFinder client to dependency provider:
</li>
        </ol>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click here to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
&lt;?php
class ProductDependencyProvider extends AbstractBundleDependencyProvider
{
    ...
    const CLIENT_FACT_FINDER = 'CLIENT_FACT_FINDER';

    /**
     * @param \Spryker\Yves\Kernel\Container $container
     *
     * @return \Spryker\Yves\Kernel\Container
     */
    public function provideDependencies(Container $container)
    {
        $container = $this-&gt;provideClients($container);

        return $container;
    }

    /**
     * @param \Spryker\Yves\Kernel\Container $container
     *
     * @return \Spryker\Yves\Kernel\Container
     */
    protected function provideClients(Container $container)
    {
        ...

        $container[self::CLIENT_FACT_FINDER] = function (Container $container) {
            return $container-&gt;getLocator()-&gt;factFinderSdk()-&gt;client();
        };

        return $container;
    }

}
            </code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <ol>
            <li>
        Add methods to get FactFinder client and to create product campaign request transfer:
</li>
        </ol>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click here to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
&lt;?php
class ProductFactory extends AbstractFactory
{

    ...

    /**
     * @return \SprykerEco\Client\FactFinderSdk\FactFinderSdkClient
     */
    public function getFactFinderClient()
    {
        return $this-&gt;getProvidedDependency(ProductDependencyProvider::CLIENT_FACT_FINDER);
    }

    /**
     * @return \Generated\Shared\Transfer\FactFinderSdkProductCampaignRequestTransfer
     */
    public function createFactFinderSdkProductCampaignRequestTransfer()
    {
        return new FactFinderSdkProductCampaignRequestTransfer();
    }

}
            </code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <ol>
            <li>
        Fetch product campaigns from controller:
</li>
        </ol>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click here to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">
&lt;?php
class ProductController extends AbstractController
{

    /**
     * @param \Generated\Shared\Transfer\StorageProductTransfer $storageProductTransfer
     *
     * @return array
     */
    public function detailAction(Request $request, StorageProductTransfer $storageProductTransfer)
    {
        ...
        $factFinderSdkProductCampaignRequestTransfer = $this-&gt;getFactory()
            -&gt;createFactFinderSdkProductCampaignRequestTransfer();
        $factFinderSdkProductCampaignRequestTransfer-&gt;addProductNumber($storageProductTransfer-&gt;getIdProductAbstract());
            $factFinderSdkProductCampaignRequestTransfer-&gt;setSid($request-&gt;cookies-&gt;get(FactFinderConstants::COOKIE_SID_NAME));
        $factFinderProductCampaignResponseTransfer = $this-&gt;getFactory()
            -&gt;getFactFinderClient()
            -&gt;getProductCampaigns($factFinderSdkProductCampaignRequestTransfer);
        $campaigns = $factFinderProductCampaignResponseTransfer-&gt;getCampaignIterator()-&gt;getCampaigns();

        $productData = [
            ...
            'campaigns' =&gt; $campaigns,
        ];

        return $productData;
    }
}
            </code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <ol>
            <li>
        Inject feedback campaign templates into product details template, indicating position of campaign widget in <code>feedbackBlockPositionId</code> parameter e.g.:
        <pre><code class="language-php line-numbers">
{% if campaigns is defined %}
    {% include '@FactFinder/campaigns/partials/feedback.twig' with {
        campaigns: campaigns,
        feedbackBlockPositionId: 'product detail - above product',
    } %}
{% endif %}
            </code></pre><p>Additionally, you might need to add some more feedback widgets to general layout in <code>src/Pyz/Yves/Application/Theme/default/layout/layout.twig</code></p></li>
            <li>
        Inject pushed products campaign template into product details template, e.g.:
        <pre><code class="language-php line-numbers">
{% if campaigns is defined %}
    {% include '@FactFinder/campaigns/partials/pushed-products.twig' with {
        campaigns: campaigns,
    } %}
{% endif %}
            </code></pre></li>
        </ol>
        <h3>Cart Page</h3>
        <p>To fetch Fact-Finder campaigns for cart page, perform the same actions as for product page, but under Cart module namespace.</p>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <ul>
            <li><a href="factfinder.htm">Get a general idea about FACT-Finder</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-recommendation.htm">Configure FACT-Finder recommendations widget
            
</a>
            </li>
            <li><a href="search-factfinder-search.htm">Configure FACT-Finder Search</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-suggest.htm">Configure FACT-Finder Suggest module
            
</a>
            </li>
            <li><a href="search-factfinder-tracking.htm">Learn more about FACT-Finder tracking system
            
</a>
            </li>
            <li><a href="search-factfinder-export-csv.htm">Learn how to export CSVs to FACT-Finder
            
</a>
            </li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Dec. 22nd, 2017</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i> by Mykhailo Kozii</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>