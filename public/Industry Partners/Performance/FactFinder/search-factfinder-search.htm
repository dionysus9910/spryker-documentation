<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.DemoShop,Spryker.B2C">
    <head>
    </head>
    <body>
        <h1>FACT-Finder - Search <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Prerequisites </h2>
        <p>FACT-Finder suggests error-tolerant on-site search. The online shop’s search function is its most powerful sales tool.</p>
        <p>FACT-Finder delivers relevant results even when spelling errors and typos occur.</p>
        <h2>Usage</h2>
        <p>By default, you can use the <code>/fact-finder</code> route to see an example catalog page. Another option is to use FactFinderSdk module client to request FACT-Finder API. All parameters from <code>GET</code> request will be sent to the FACT-Finder API.</p>
        <p>As a response, you'll receive a <code>FactFinderSdkSearchResponseTransfer</code> object that contains data, after search navigation, bread crumbs, paging.</p>
        <p>Basic parameters:</p>
        <ul>
            <li><code>query</code> - The search term indicates the term or phrase that is to be used to search in the FACT- Finder database.</li>
            <li><code>channel</code> -  If your search environment consists of multiple channels, you can define  what channel to search here. If no channel is specified, the first channel in the channel list is used.</li>
            <li><code>page</code> -  If a search result contains many results, they will be divided into pages. It limits the amount of data that has to be sent in one go. You can indicate what page should be returned. Page numbering starts with 1.</li>
            <li><code>productsPerPage</code> - In the FACT-Finder Management Interface, you can define the number of results that will be returned on a page by default. To change the number, you can set it with this parameter.</li>
            <li><code>sort</code> - By default, the result that is returned has been sorted for relevance. However, you can specify a different sort order here.</li>
            <li><code>filter</code> - When a filter parameter is sent to FACT-Finder, the Search engine only returns results that correspond to the filter indicated.</li>
            <li><code>searchField</code> -  Normally FACT-Finder searches all fields defined as searchable. However, it is possible to search only one specific field as well.</li>
            <li><code>noArticleNumberSearch</code> - Normally an article number search is carried out if the search term matches one or more set formats. You can also use parameters to prevent an article number search from being carried out.</li>
            <li><code>sid</code> - Session ID.</li>
            <li><code>useAsn</code> - Controls whether or not the ASN (after-search navigation block) is created.</li>
            <li><code>useFoundWords</code> - FACT-Finder is able to return the words that were used to find the data record for the located records.</li>
            <li><code>useCampaigns</code> - If you want to prevent the Campaign Manager from checking whether the search query matches a campaign, use this parameter.</li>
            <li><code>navigation</code> - FACT-Finder can also replicate your entire shop navigation.</li>
            <li><code>idsOnly</code> - The result normally contains all field information about the products that have been found.</li>
            <li><code>generateAdvisorTree</code> - This parameter is used in conjunction with advisor campaigns.</li>
            <li><code>disableCache</code> - This parameter controls whether or not the search result cache is used.</li>
            <li><code>followSearch</code> - The parameter is automatically attached to all follow-up parameter sets of a search result. The parameter must not be passed on initial requests.</li>
            <li><code>usePersonalization</code> - Allows the activation / deactivation of the queries personalization.</li>
            <li><code>useSemanticEnhancer</code> - Allows activation / deactivation of the semantic enhancement of queries.</li>
            <li><code>useAso</code> - Allows the activation / deactivation of the automatic search optimization.</li>
        </ul>
        <p>Controller example:</p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click here to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">&lt;?php

...

    /**
     * @param \Symfony\Component\HttpFoundation\Request $request
     *
     * @return array
     */
    public function indexAction(Request $request)
    {
        $factFinderSearchRequestTransfer = new FactFinderSdkSearchRequestTransfer();
        $requestArray = $request-&gt;query-&gt;all();

        $factFinderSearchRequestTransfer-&gt;setRequest($requestArray);

        $ffSearchResponseTransfer = $this-&gt;getFactory()
            -&gt;getFactFinderClient()
            -&gt;search($factFinderSearchRequestTransfer);


        if ($ffSearchResponseTransfer-&gt;getCampaignIterator()-&gt;getHasRedirect()) {
            return $this-&gt;redirectResponseExternal($ffSearchResponseTransfer-&gt;getCampaignIterator()-&gt;getRedirectUrl());

        }

        $feedbackForm = $this-&gt;getFactory()
            -&gt;createFeedbackForm();

        if (!$ffSearchResponseTransfer-&gt;getResult()) {
            $this-&gt;addErrorMessage('Search is not available at the moment');
        }

        return [
            'searchResponse' =&gt; $ffSearchResponseTransfer,
            'pagingRote' =&gt; 'fact-finder',
            'lang' =&gt; Store::getInstance()-&gt;getCurrentLanguage(),
            'query' =&gt; isset($requestArray['query']) ? $requestArray['query'] : '',
            'page' =&gt; isset($requestArray['page']) ? $requestArray['page'] : '',
            'feedbackForm' =&gt; $feedbackForm-&gt;createView(),
        ];
    }

...</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p>The FactFinder module includes templates. Templates can be used for changing the default partial templates in the following way:</p>
        <p>In <code class="language-twig">src/Pyz/Yves/Catalog/Theme/default/catalog/catalog.twig</code> you can put:</p><pre><code class="language-php line-numbers">{% include '@FactFinder/layout/catalog/filters.twig' with {
    afterSearchNavigation: factFinderSearchResponse.getAfterSearchNavigation
} %}

{% include '@FactFinder/layout/partials/sort.twig' %}

{% include '@FactFinder/search/partials/pagination.twig' with {
            showAlwaysFirstAndLast: true
        } %}</code></pre>
        <p>According to the template examples, you can set up default demoshop template for using FACT-Finder responses.</p>
        <h2>After Search</h2>
        <p><code>FactFinderSdkSearchResponseTransfer</code> has campaign iterator, bread crumbs, paging, search result, sorting parameters,
            result per page option, filter groups.
        </p>
        <p>You can build any front end and templates using those options in the response transfer object.</p>
        <h3>Filter Groups</h3>
        <p>Default settings in the FACT-Finder admin panel are:</p>
        <p>For categories filter:</p>
        <ul>
            <li>Source field - <code>CategoryPath</code></li>
            <li>Field type - <code>CategoryPath</code></li>
        </ul>
        <p>For price filter:</p>
        <ul>
            <li>Source field - Price</li>
            <li>Field type - Number</li>
            <li>Range type - Slider</li>
        </ul>
        <p>For stock filter:</p>
        <ul>
            <li>Source field - Stock</li>
            <li>Field type - Text</li>
            <li>Selection Type - Multi-select</li>
        </ul>
        <p>Filter groups have the following options (name - type):</p>
        <ul>
            <li>filters - <code>FactFinderSdkDataFilter[]</code></li>
            <li>name - string</li>
            <li><code>detailedLinkCount</code> - int</li>
            <li>unit - string</li>
            <li><code>isRegularStyle</code> - bool</li>
            <li><code>isSliderStyle</code> - bool</li>
            <li><code>isTreeStyle</code> - bool</li>
            <li><code>isMultiSelectStyle</code> - bool</li>
            <li><code>hasPreviewImages</code> - bool</li>
            <li><code>hasSelectedItems</code> - bool</li>
            <li><code>isSingleHideUnselectedType</code> - bool</li>
            <li><code>isSingleShowUnselectedType</code> - bool</li>
            <li><code>isMultiSelectOrType</code> - bool</li>
            <li><code>isMultiSelectAndType</code> - bool</li>
            <li><code>isTextType</code> - bool</li>
            <li><code>isNumberType</code> - bool</li>
        </ul>
        <p>Filter has the following options (name - type):</p>
        <ul>
            <li>item - <code>FactFinderSdkDataItem</code></li>
            <li><code>fieldName</code> - string</li>
            <li><code>matchCount</code> - int</li>
            <li><code>clusterLevel</code> - int</li>
            <li><code>previewImage</code> - string</li>
            <li><code>hasPreviewImage</code> - bool</li>
            <li><code>absoluteMinimum</code> - string</li>
            <li><code>absoluteMaximum</code> - string</li>
            <li><code>selectedMinimum</code> - string</li>
            <li><code>selectedMaximum</code> - string</li>
        </ul>
        <h3>Bread Crumbs</h3>
        <p>Bread crumbs have following options (name - type):</p>
        <ul>
            <li>item - <code>FactFinderSdkDataItem</code></li>
            <li><code>isSearchBreadCrumb</code> - bool</li>
            <li><code>isFilterBreadCrumb</code> - bool</li>
            <li><code>fieldName</code> - string</li>
        </ul>
        <h3>Paging</h3>
        <p>Paging has the following options (name - type):</p>
        <ul>
            <li><code>pageCount</code> - int</li>
            <li><code>firstPage</code> - <code>FactFinderSdkDataPage</code></li>
            <li><code>lastPage</code> - <code>FactFinderSdkDataPage</code></li>
            <li><code>previousPage</code> - <code>FactFinderSdkDataPage</code></li>
            <li><code>currentPage</code> - <code>FactFinderSdkDataPage</code></li>
            <li><code>nextPage</code> - <code>FactFinderSdkDataPage</code></li>
        </ul>
        <p>Data page has the following options (name - type):</p>
        <ul>
            <li>item - <code>FactFinderSdkDataItem</code></li>
            <li><code>pageNumber</code> - int</li>
        </ul>
        <p>Data item has the following options (name - type):</p>
        <ul>
            <li>label - string</li>
            <li>url - string</li>
            <li>selected - bool</li>
        </ul>
        <h3>Sorting Options</h3>
        <p>Is array of data items.</p>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <ul>
            <li><a href="factfinder.htm">Get a general idea about FACT-Finder</a>
            </li>
            <li><a href="search-factfinder-recommendation.htm">Configure FACT-Finder recommendations widget</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-suggest.htm">Configure FACT-Finder Suggest module</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-campaigns.htm">Configure FACT-Finder Campaign Manager module
            
</a>
            </li>
            <li><a href="search-factfinder-tracking.htm">Learn more about FACT-Finder tracking system</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-export-csv.htm">Learn how to export CSVs to FACT-Finder</a><![CDATA[
            ]]></li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Dec. 22nd, 2017</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i> by Mykhailo Kozii</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>