<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Spryker.DemoShop,Spryker.B2C">
    <head><title>[%=Heading.Level1%]</title>
    </head>
    <body>
        <h1>FACT-Finder - Recommendation <img src="../../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <h2>Prerequisites </h2>
        <p>The FACT-Finder recommendation engine analyzes product and category relationships. The results are rendered in recommendations widget, which can be displayed on product details pages, homepage or in the shopping cart.</p>
        <h2>Usage </h2>
        <p> To add recommendations widget to product page, insert the following code into <code class="language-twig">src/Pyz/Yves/Product/Theme/default/product/detail.twig</code>: </p><pre><code class="language-twig">{{ fact_finder_recommendations({id: product.sku, mainId: product.idProductAbstract}, '@FactFinder/recommendations/products.twig') }}</code></pre>
        <p>To add recommendations widget to cart page, modify cart controller  (<code class="language-php">src/Pyz/Yves/Cart/Controller/CartController.php</code>) to add array of product ids into template variables: </p>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot>Click here to expand the code sample</MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody><pre><code class="language-php line-numbers">&lt;?php
...

class CartController extends AbstractController
{

    /**
     * @return array
     */
    public function indexAction(Request $request, ?array $selectedAttributes = null)
    {
        $quoteTransfer = $this-&gt;getClient()
            -&gt;getQuote();

        $factFinderSid = $request-&gt;cookies-&gt;get(FactFinderConstants::COOKIE_SID_NAME);
        $quoteTransfer-&gt;setFactFinderSid($factFinderSid);

        $voucherForm = $this-&gt;getFactory()
            -&gt;getVoucherForm();

        $cartItems = $this-&gt;getFactory()
            -&gt;createProductBundleGrouper()
            -&gt;getGroupedBundleItems($quoteTransfer-&gt;getItems(), $quoteTransfer-&gt;getBundleItems());

        $cartItemsIds = [];
        $cartItemsNames = [];
        foreach ($cartItems as $cartItem) {
            $cartItemsNames[] = $cartItem-&gt;getName();
            $cartItemsIds[] = $cartItem-&gt;getSku();
        }

        $stepBreadcrumbsTransfer = $this-&gt;getFactory()
            -&gt;getCheckoutBreadcrumbPlugin()
            -&gt;generateStepBreadcrumbs($quoteTransfer);

        $itemAttributesBySku = $this-&gt;getFactory()
            -&gt;createCartItemsAttributeProvider()
            -&gt;getItemsAttributes($quoteTransfer, $selectedAttributes);

        $promotionStorageProducts = $this-&gt;getFactory()
            -&gt;getProductPromotionMapperPlugin()
            -&gt;mapPromotionItemsFromProductStorage(
                $quoteTransfer,
                $request
            );

        $factFinderSdkProductCampaignRequestTransfer = $this-&gt;getFactory()
            -&gt;createFactFinderSdkProductCampaignRequestTransfer();
        $factFinderSdkProductCampaignRequestTransfer-&gt;setProductNumber($cartItemsIds);
        $factFinderSdkProductCampaignRequestTransfer-&gt;setSid($factFinderSid);

        $campaigns = $this-&gt;getCampaigns(
            $factFinderSdkProductCampaignRequestTransfer,
            $cartItems
        );

        return $this-&gt;viewResponse([
            'cart' =&gt; $quoteTransfer,
            'cartItems' =&gt; $cartItems,
            'attributes' =&gt; $itemAttributesBySku,
            'cartItemsIds' =&gt; $cartItemsIds,
            'cartItemsNames' =&gt; $cartItemsNames,
            'voucherForm' =&gt; $voucherForm-&gt;createView(),
            'stepBreadcrumbs' =&gt; $stepBreadcrumbsTransfer,
            'promotionStorageProducts' =&gt; $promotionStorageProducts,
            'campaigns' =&gt; $campaigns,
        ]);
    }

...</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <p> Then add recommendations widget to cart  page template <code>src/Pyz/Yves/Cart/Theme/default/cart/index.twig</code>: </p><pre><code class="language-twig">{{ fact_finder_recommendations({id: cartItemsIds, mainId: cartItemsIds}, '@FactFinder/recommendations/products.twig') }}</code></pre>
        <p>&#160;</p>
        <p><b>See also:</b>
        </p>
        <ul>
            <li><a href="factfinder.htm"><li>Get a general idea about FACT-Finder
            </li></a>
            </li>
            <li><a href="search-factfinder-search.htm">Configure FACT-Finder Search</a><![CDATA[
            ]]></li>
            <li><a href="search-factfinder-suggest.htm">Configure FACT-Finder Suggest module
            
</a>
            </li>
            <li><a href="search-factfinder-campaigns.htm">Configure FACT-Finder Campaign Manager module
            
</a>
            </li>
            <li><a href="search-factfinder-tracking.htm">Learn more about FACT-Finder tracking system
            
</a>
            </li>
            <li><a href="search-factfinder-export-csv.htm">Learn how to export CSVs to FACT-Finder</a><![CDATA[
            ]]></li>
        </ul>
        <p>&#160;</p>
        <p><i>Last review date: Dec. 22nd, 2017</i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i> by Mykhailo Kozii</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>