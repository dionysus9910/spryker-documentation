<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="" MadCap:conditions="Spryker.B2B,Spryker.B2C,Spryker.ShopSuite,Spryker.DemoShop">
    <head>
    </head>
    <body>
        <h1>Install Tool <img src="../../Resources/Images/shoptype/B2B_Shop.png" /> <img src="../../Resources/Images/shoptype/B2C_Shop.png" /> <img src="../../Resources/Images/shoptype/MasterSuite.png" /> <img src="../../Resources/Images/shoptype/Demoshop.png" /></h1>
        <p>Spryker offers an install tool which can be used to install the system as described in the install recipe file(s).</p>
        <h2>Installation</h2>
        <p>Install the module with composer by running the following command:</p><pre><code class="language-PHP line-numbers">
        composer require spryker/install
        </code></pre>
        <p>After the installation you can run the command with <var>vendor/bin/install</var>. Use the <var>-h</var> option to see the help page for this command.</p>
        <h2>Configuration</h2>
        <p>The way Spryker should be installed is described in a <var>*.yml</var> file. You can have as much configuration files as you want e.g. <var>development.yml</var>, <var>staging.yml</var> etc. These files are called recipe.</p>
        <p>It is also possible to have only local used recipes. Those local recipes are named <var>*_local.yml</var>. This is useful for different departments working with Spryker. Your frontend developer could have a <var>frontend_local.yml</var> where only all frontend related things are executed.</p>
        <p>All recipes have to be placed into the <var>{ROOT}/config/install/</var> directory.</p>
        <p>The recipe is divided into blocks we will describe later in this document.</p>
        <h3>Environment Variables</h3>
        <p>You can specify environment variables used for the installation. Those key value pairs are exported in the beginning of the installation with <var>putenv("KEY=value")</var>. This block is mainly used to define the environment the install tool should run in. E.g. <var>APPLICATION_ENV: development</var></p>
        <p>Example:</p><pre><code class="language-PHP line-numbers">
env:
  KEY1: value1
  KEY2: value2
</code></pre>
        <h3>Stores</h3>
        <p>You can specify all stores for which you want to run the install tool. When commands are marked as "store aware", the install tool will run the command for all specified stores.
            By default the install tool runs only the in your application-configured default store.</p>
        <p>Example:</p><pre><code class="language-PHP line-numbers">
store:
  - DE
  - AT
  - US
</code></pre>
        <h3>Command timeout</h3>
        <p>You can specify the command timeout limit in seconds for all commands defined per recipe.</p>
        <p>Example:</p><pre><code class="language-PHP line-numbers">
command-timeout: 3600 # Set timeout of every command to 3600 seconds.
</code></pre>
        <h3>Sections</h3>
        <p>You can have one or more section(s) in your configuration file. A section is a set of commands related to one topic. It is also possible to add "default excluded" sections,
            this is useful for sections which you only want to run in specific cases or when you want to run some commands only as pre or post command.
            Those default excluded sections are not executed until you "request" them to be executed. For more details about execution, look into <a href="#There">How to Execute the Install Tool</a> section below.</p>
        <p>Example:</p><pre><code class="language-PHP line-numbers">
...
sections:
  section-a:
    excluded: true (default false)
    command-a: ...
    command-b: ...
    command-c: ...

  section-b:
    command-a: ...
    command-b: ...
    command-c: ...

  section-c:
    pre: "section-name/command-name"
    post: "section-name/command-name"
    command-a: ...
    command-b: ...
    command-c: ...
...
</code></pre>
        <h4>Pre and Post</h4>
        <p>You can specify <var>pre</var> and <var>post</var> commands for each of your sections. The value for <var>pre</var> and <var>post</var> is a pair of the section name and the command name.
            The <var>pre</var> command is executed before any other command of the section is executed. The <var>post</var> command is executed after all other commands of the section are executed.
            This is very useful when you have commands which are not executed only once. When a command has a complex configuration, you only need to add it once and can run it at any time in your installation.</p>
        <h3>Commands</h3>
        <p>Each section contains one or more command(s) to be executed. The Command must be a string which can be executed on the command line. Internally we use Symfony's Process to execute those commands.</p>
        <p>Example:</p><pre><code class="language-PHP line-numbers">
...
sections:
  section-a:
    command-a: # name of the command
      excluded: true (default false)
      command: "vendor/bin/console your:command-a"

    command-b:
      command: "vendor/bin/console your:command-b"
      groups:
        - group-a
        - group-b

    command-c:
      command: "vendor/bin/console your:command-c"
      env:
        KEY1: value1
        KEY2: value2

    command-d:
      command: "vendor/bin/console your:command-d"
      stores: true

    command-e:
      command: "vendor/bin/console your:command-e"
      conditions:
        - command: "command-e"
          ifExitCode: 3

    command-f:
      pre: "section-name/command-name"
      post: "section-name/command-name"
      command: "vendor/bin/console your:command-f"

    command-g:
      command: "vendor/bin/console your:command-g"
      timeout: 300 # Set command timeout to 300 seconds.
...
</code></pre>
        <h4>Excluded</h4>
        <p>The <var>excluded</var> option can be used to mark a command as excluded, default is false. When a command is marked as excluded, it will not run until you request it to run.
            There are many ways to run the setup, for more details look into <a href="#There">How to Execute the Install Tool</a> section below.</p>
        <h4>Groups</h4>
        <p>Groups can be used to group several commands of several sections to make them executable in one shot.</p>
        <h4>Env</h4>
        <p>With the env option you can add additional environment variables which are exported with <var>putenv("KEY=value")</var>.
            After the command is executed those will be unset with <var>putenv("KEY")</var>.</p>
        <h4>Stores</h4>
        <p>When the option is set to true, the command will be run for all stores configured in the recipe. It is also possible to use a list of stores. Imagine you have three of stores, e.g DE, AT and US, and you want to share the database for the DE store with the one for AT.
            To not import the data for DE and AT twice into the same database, you can use a list with the store names the command should run for. In this example for DE and US.</p>
        <h4>Conditions</h4>
        <p>Conditions can be used when you want to run a command only when another command fulfills the condition. Currently we support <var>ifExitCode</var> and <var>ifNotExitCode</var>.</p>
        <h4>Pre and Post</h4>
        <p>You can specify <var>pre</var> and <var>post</var> commands for each of your commands. The value for <var>pre</var> and <var>post</var> is a pair of the section name and the command name.
            The <var>pre</var> command is executed before the command is executed. The <var>post</var> command is executed after the command is executed.</p>
        <h2>How to Execute the Install Tool</h2>
        <p><a name="There"></a>There are several ways to execute the install command. The following list describes some possibilities to execute it:
            <ul><li><var>vendor/bin/install</var> will execute all sections and commands which are not marked as excluded.</li><li><var>vendor/bin/deploy -s section-name (-s another-section-to-run)</var> will only execute the requested sections although they are marked as excluded.</li><li><var>vendor/bin/deploy -x section-name (-x another-section-to-exclude)</var> will execute all sections except the excluded ones.</li><li><var>vendor/bin/deploy -g group-name (-g another-group-to-execute)</var> will only execute the requested groups although they are marked as excluded.</li><li><var>vendor/bin/install -i</var> will ask you which sections should be included in your install run.</li></ul></p>
        <p>For full description of the install tool options run it with <var>-h</var> to see the help of this command.</p>
        <p>&#160;</p>
        <p><i>Last review date: Apr. 13th, 2018 </i>
            <MadCap:conditionalText MadCap:conditions="General.Hidden Comment"><i>by Tamás Nyulas</i>
            </MadCap:conditionalText>
        </p>
    </body>
</html>