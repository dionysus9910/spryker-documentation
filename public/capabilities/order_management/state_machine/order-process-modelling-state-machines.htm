<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-conditions="Spryker.B2C,Spryker.B2B,Spryker.ShopSuite,Spryker.DemoShop,Spryker.MultiStore" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Features|Order Management">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../Skins/Favicons/browserconfig.xml" />
        <meta name="description" content="State Machines help you define, execute and visualize predefined and automated processes. You can tailor the State Machine to your needs." />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Order Process Modelling via State Machines | Spryker</title>
        <!-- Google Tag Manager -->
        <script>/* <![CDATA[ */(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-NP24S2');/* ]]> */</script>
        <!-- End Google Tag Manager -->
        <script>/* <![CDATA[ */
			var s = document.createElement("script");
			s.type = "text/javascript";
			s.src = "https://www.googletagmanager.com/gtag/js?id==UA-56589105-4";
			document.getElementsByTagName('head').item(0).appendChild(s);
		/* ]]> */</script>
        <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-56589105-4');
		/* ]]> */</script>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <link href="../../../resources/stylesheets/perfect-scrollbar.css" rel="stylesheet" />
        <link href="../../../resources/stylesheets/prism.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../resources/scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../resources/stylesheets/mainstyles.css" rel="stylesheet" />
        <script src="../../../resources/scripts/custom.modernizr.js">
        </script>
        <script src="../../../resources/scripts/jquery.min.js">
        </script>
        <script src="../../../resources/scripts/require.min.js">
        </script>
        <script src="../../../resources/scripts/require.config.js">
        </script>
        <script src="../../../resources/scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../resources/scripts/plugins.min.js">
        </script>
        <script src="../../../resources/scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search the Academy" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <!-- Google Tag Manager (noscript) -->
                                <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NP24S2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                </noscript>
                                <!-- End Google Tag Manager (noscript) -->
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="breadcrumbs-block">
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                        </div>
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchHome mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                                <div data-sticky-container="" id="08jeVSKUk0G_PE7Nmk_aoA">
                                                    <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="08jeVSKUk0G_PE7Nmk_aoA:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                        <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/master.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="side-menu">
                                                <div class="toolbar-wrapper">
                                                    <div class="widget-github js-widget-github"><a class="widget-github-link js-widget-github-link" href="https://github.com/spryker/spryker-documentation" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><path d="M13.5 0C6.057 0 0 6.057 0 13.5c0 5.888 3.791 10.905 9.058 12.745a.463.463 0 0 0 .258.088c1.316.43 2.724.667 4.184.667C20.943 27 27 20.943 27 13.5S20.943 0 13.5 0zm0 .931c6.93 0 12.569 5.639 12.569 12.569 0 5.428-3.459 10.061-8.287 11.818a1.903 1.903 0 0 1-.092-.527v-2.446c0-.975-.477-2.037-.946-2.75 2.584-.436 5.537-1.776 5.537-6.779 0-1.37-.429-2.58-1.275-3.598.186-.611.415-1.9-.225-3.52a.47.47 0 0 0-.291-.272c-.13-.04-1.326-.35-3.806 1.277a12.921 12.921 0 0 0-6.36 0c-2.481-1.63-3.68-1.319-3.809-1.277a.47.47 0 0 0-.29.273C5.582 7.319 5.811 8.607 6 9.218c-.85 1.018-1.279 2.227-1.279 3.598 0 4.957 2.9 6.323 5.463 6.778-.322.407-.66.934-.81 1.47-.661.184-2.018.19-2.929-1.37-.032-.06-.829-1.475-2.4-1.584-.25.002-.882.042-1.035.525-.169.537.424.944.679 1.117l.058.034c.029.015.707.371 1.213 1.644.105.333 1.03 2.84 4.353 2.399.002.367 0 .552-.004.7v.26c0 .15-.045.378-.096.525C4.386 23.558.931 18.924.931 13.5.931 6.57 6.57.931 13.5.931zm6.51 5.375c.5 1.471.158 2.537.035 2.839a.468.468 0 0 0 .089.49c.805.883 1.214 1.952 1.214 3.181 0 4.72-2.796 5.666-5.535 5.97a.464.464 0 0 0-.253.815c.368.314 1.199 1.68 1.199 2.744v2.446c0 .009.001.414.134.809a12.513 12.513 0 0 1-6.792-.002c.135-.396.139-.802.139-.81l.001-.248c.002-.211.006-.497 0-1.266a.473.473 0 0 0-.174-.362.47.47 0 0 0-.391-.09c-3.126.681-3.802-1.576-3.828-1.67l-.016-.047c-.448-1.135-1.037-1.713-1.388-1.975.759.267 1.182 1.007 1.193 1.024 1.231 2.107 3.264 2.162 4.328 1.685a.463.463 0 0 0 .27-.36c.095-.665.826-1.545 1.196-1.87a.464.464 0 0 0 .136-.488.461.461 0 0 0-.39-.324c-2.73-.31-5.524-1.266-5.524-5.98 0-1.228.41-2.3 1.219-3.181a.464.464 0 0 0 .087-.491c-.124-.302-.467-1.364.031-2.837.396.013 1.362.182 2.988 1.286.112.076.256.1.387.063.973-.27 2.058-.416 3.135-.421 1.08.005 2.166.15 3.14.421.131.037.273.013.386-.063 1.635-1.11 2.6-1.275 2.984-1.288z" /></svg></a>
                                                    </div>
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic NextTopic Print ExpandAll CollapseAll;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="js-anchorer main-content">
                                                    <h1>Order Process Modelling via State Machines <img src="../../../resources/images/shoptype/b2b_shop.png" /> <img src="../../../resources/images/shoptype/b2c_shop.png" /> <img src="../../../resources/images/shoptype/mastersuite.png" /> <img src="../../../resources/images/shoptype/demoshop.png" /></h1>
                                                    <p><a href="javascript:void(0);" class="MCTextPopup popup popupHead">MS<span class="MCTextPopupBody MCTextPopupBody_Closed needs-pie popupBody"><span class="MCTextPopupArrow"></span>Multi-store</span></a>
                                                    </p>
                                                    <p>State Machines help you define, execute and visualize predefined and automated processes. It can model events that involve performing a predetermined sequence of actions, for example in the order process.</p>
                                                    <p class="example">The order is being shipped if the payment is successful.</p>
                                                    <p>You can tailor the State Machine to your needs to trigger certain processes automatically or execute them manually.</p>
                                                    <ul>
                                                        <li value="1">Model and visualize the process as state machine in XML
</li>
                                                        <li value="2">Reusable sub processes (e.g. return-process)
- programmable commands and conditions
</li>
                                                        <li value="3">Events can be triggered manually or fully automated
</li>
                                                        <li value="4">Timeouts</li>
                                                    </ul>
                                                    <h2>State Machine Module</h2>
                                                    <p>The <var>StateMachine</var> module provides generic implementation for state machines (SM). This module provides functionality for drawing the SM graph, triggering events, initializing a new state machine or for getting the state history for a processed item. </p>
                                                    <p class="note"> If you are looking for information on the OMS State Machine see: <a href="../oms-matrix.htm">OMS State Machine</a></p>
                                                    <p class="info" data-mc-conditions="Spryker.DemoShop">There is already an example state machine implemented in Legacy Demoshop. Look for <var>stateMachineExample</var> module. You can use it as a base for implementing your custom SM.&#160;</p>
                                                    <h2>States</h2>
                                                    <p>How are the states modelled in the XML?</p>
                                                    <ul>
                                                        <li value="1">A list of state elements can be easily defined in an XML file, as in the example below.</li>
                                                        <li value="2">A state is defined by a name. 
			<p class="example">The display attribute allows to link a glossary key that contains the name of the state for the locales configured in the application, as you want to be shown in Yves.</p></li>
                                                    </ul><pre><code class="language-XML line-numbers">&lt;states&gt;
    &lt;state name="new" reserved="true"/&gt;
    &lt;state name="paid" display="customer.order.state.received"&gt;
        &lt;flag&gt;invoiceable&lt;/flag&gt;
    &lt;/state&gt;
    &lt;state name="shipped" display="custom.order.state.shipped" /&gt;
&lt;/states&gt;</code></pre>
                                                    <p>Furthermore, a state can have several associated flags. </p>
                                                    <p>You can query the state machine for items marked with specified flags by using <var>StateMachineFacade::getItemsWithFlag()</var> or vice versa <var>StateMachineFacade::getItemsWithoutFlag()</var>. </p>
                                                    <p class="info">We already have predefined number of sate machine flags in our <var>oms.xsd</var> filed which can be found in <code>http://static.spryker.com/oms-01.xsd</code>, you can find it in <var>stateType</var> definition flag subsection.</p>
                                                    <p>Currently we use '<i>exclude from customer</i>' flag which will skip all orders having <i>ALL</i> item states flagged with this flag. That means it won't be displayed in customer Yves order details/list pages.</p>
                                                    <h2>Transitions</h2>
                                                    <p>Spryker’s state machine allows to define transitions between states. A transition is bound to an event, which tells when the state machine item can leave the current state.</p>
                                                    <p class="example">For example, the states <var>waiting for credit card capture</var> and <var>captured</var> are connected with a transition that expects an external event <var>capture successful</var>. States and transitions define the possible flow a process can take, and also which sequence of states is actually not possible.</p>
                                                    <p>Technically, transitions are very simple. The attribute <var>happy</var> marks this transition as the happy case. When the state machine graph is rendered in Zed, the transition is marked with green.</p>
                                                    <p>The condition attribute allows to add PHP code that double checks if this transition can be fired or not. The condition is evaluated when the event associated with the transition has been fired.</p>
                                                    <p>Furthermore a <var>source</var> and a <var>target</var> state are defined. The event specifies when the transition can be fired.</p>
                                                    <p>The event element can be omitted (making request not block user request). This way an external call like <i>save Order</i> or <i>triggerEvent</i> are finished. That means that the control flow of the code goes back to the invoking method. Zed will continue the execution of the process model with the help of a cron job. If the event element is omitted and a condition is used, Zed will use the condition to evaluate if the transition can be fired.</p><pre><code class="language-PHP line-numbers">&lt;transition condition="PackageName/ClassName" happy="true"&gt;
    &lt;source&gt;paid&lt;/source&gt;
    &lt;target&gt;shipped&lt;/target&gt;
    &lt;event&gt;ship it&lt;/event&gt;
&lt;/transition&gt;</code></pre>
                                                    <h2>Events</h2>
                                                    <p>Events tell when a transition can be fired. Every event has a name that is referenced in a transition.</p>
                                                    <ul>
                                                        <li value="1">The easiest event is the one that has the <var>onEnter="true"</var> attribute associated. This event is fired automatically when the source state is reached.</li>
                                                        <li value="2">Another option is to attach a timeout. It can be used for a prepayment process.
        <p>How is the reminder then technically sent? This is implemented with the command attribute. The command attribute references a PHP class that implements a specific interface. Every time the event is fired (automatically, after timeout), Zed makes sure the associated command is executed. </p><p class="info">If an exception occurs when executing the command, the item stays in the source state.</p><p>This is how an event is defined:</p><pre><code class="language-PHP line-numbers">&lt;event name="ship it" timeout="" manual="true|false" onEnter="true|false" command="PackageName/ClassName"/&gt;</code></pre><p>The timeout attribute uses string date <a href="http://php.net/manual/en/datetime.formats.relative.php" title="Relative formats" alt="Relative formats" target="_blank">relative formats</a>.</p><p class="example"><b>For example:</b> 1 day, 1 hour, 1 min</p></li>
                                                        <li value="3">Another option to fire the event is by setting the manual attribute to true. This allows adding manual button in your Zed UI to manually trigger events. By clicking the button the event will be fired and thus, the corresponding transition will take place.</li>
                                                        <li value="4">Furthermore events can be triggered via an API call. The method <var>triggerEvent</var> allows to trigger an event for a given process instance. For example if a message from the payment provider is received that a capture was successful, the corresponding process instance can be triggered via API call.</li>
                                                    </ul>
                                                    <h2>Subprocesses</h2>
                                                    <p>A process can be split into multiple subprocesses, that is each related to a single independent concept.</p>
                                                    <p class="example">For example: Payment subprocess, cancellation subprocess.</p>
                                                    <p>There are several reasons for introducing subprocesses when modeling a state machine process:</p>
                                                    <ul>
                                                        <li class="bullet_list" value="1">the flow of the process is easier to follow</li>
                                                        <li class="bullet_list" value="2">if more then one process needs to be defined (e.g.: orders that are being paid before delivery and orders that are paid on delivery) then the common parts of the processes can be extracted into subprocesses and they be reused</li>
                                                    </ul>
                                                    <p>To introduce a subprocess in the main process, you need to specify it’s name under the subprocesses tag as in the example below :</p><pre><code class="language-PHP line-numbers">&lt;process name="Prepayment" main="true"&gt;
    &lt;subprocesses&gt;
        &lt;process&gt;completion&lt;/process&gt;
        &lt;process&gt;cancellation&lt;/process&gt;
       ..
    &lt;/subprocesses&gt;
..</code></pre>
                                                    <p>You also need to specify the path to the file in which the transitions of that subprocess are being described :</p><pre><code class="language-PHP line-numbers">&lt;process name="Prepayment01" main="true"&gt;
 ..
&lt;/process&gt;
&lt;process name="completion" file="subprocesses/Completion.xml"/&gt;
&lt;process name="cancellation" file="subprocesses/Cancellation.xml"/&gt;</code></pre>
                                                    <p>In the main process add the corresponding transitions between the starting and ending states of the included subprocesses and other states (that are defined in other subprocesses or in the main process).</p>
                                                    <h2>Subprocess Prefix</h2>
                                                    <p>You might want to copy a subprocess over to consolidate process endpoints. To do so, you need to define a prefix for a subprocess and use it for a target/source state or an event definition.</p><pre><code class="language-XML line-numbers">&lt;process name="Name" main="true"&gt;
...
&lt;transition condition="PackageName/ClassName"&gt;
	&lt;source&gt;paid&lt;/source&gt;
    &lt;target&gt;Foo - Cancellation&lt;/target&gt;
    &lt;event&gt;Enter Foo cancellation&lt;/event&gt;
&lt;/transition&gt;

&lt;transition condition="PackageName/ClassName" happy="true"&gt;
	&lt;source&gt;paid&lt;/source&gt;
 	&lt;target&gt;Cancellation&lt;/target&gt;
	&lt;event&gt;Enter general cancellation&lt;/event&gt;
&lt;/transition&gt;
...
&lt;/process&gt;
&lt;process name="cancellation" file="subprocesses/Cancellation.xml"/&gt;
&lt;process name="cancellation" file="subprocesses/Cancellation.xml" prefix="Foo"/&gt;</code></pre>
                                                    <h2>Putting It All Together</h2>
                                                    <p>The following snippet shows how all the elements are brought together in an XML file. Notice that we can also define subprocesses. This allows to reuse a subprocess from several processes. Therefore the subprocess used is declared in the <var>&lt;subprocesses&gt;</var> section. You need to define for each subprocess a process element that contains the name and file location as attributes.</p><pre><code class="language-XML line-numbers">&lt;?xml version="1.0"?&gt;
&lt;statemachine
    xmlns="spryker:state-machine-01"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="spryker:state-machine-01 http://static.spryker.com/state-machine-01.xsd"&gt;

   &lt;process name="CreditCardDropShipping"&gt;
      &lt;subprocesses&gt;
         &lt;process&gt;invoice creation&lt;/process&gt;
      &lt;/subprocesses&gt;

      &lt;!-- state go here --&gt;
      &lt;states&gt;
         &lt;state&gt; ... &lt;/state&gt;
      &lt;/states&gt;


      &lt;!-- Transitions go here --&gt;
      &lt;transitions&gt;
         &lt;transition&gt; ... &lt;/transition&gt;
      &lt;transitions&gt;


      &lt;!-- Events go here --&gt;
      &lt;events&gt;
         &lt;event&gt; ... &lt;/event&gt;
      &lt;events&gt;
   &lt;/process&gt;
   &lt;process name="invoice creation" file="subprocesses/InvoiceCreation.xml"/&gt;
&lt;/statemachine&gt;</code></pre>
                                                    <h2>Where to Store the File?</h2>
                                                    <p>Each state machine should have a folder created under the <var>config/Zed/StateMachine/{StateMachineName}/</var> folder. {StateMachineName} name is taken from SM handler plugin <var>StateMachineHandlerInterface::getStateMachineName()</var>.</p>
                                                    <h2>Linking Processes With Code</h2>
                                                    <p>Events can have commands attached to it, which is logic that gets executed when that event is fired.</p>
                                                    <p>Example:</p><pre><code class="language-PHP">&lt;events&gt;
    &lt;event name="example event" onEnter="true" manual="true" command="Example/ExampleCommand"/&gt;
    ..
&lt;/events&gt;</code></pre>
                                                    <p>The mapping between this string and the actual implementation of the command is done through the state machine handler <var>StateMachineHandlerInterface::getCommandPlugins()</var>.</p>
                                                    <div class="example">Example of <var>\Pyz\Zed\Oms\OmsDependencyProvider</var>:
<p><pre><code class="language-PHP line-numbers">&lt;?php
...
class OmsDependencyProvider extends SprykerOmsDependencyProvider
{
    ...
    public function provideBusinessLayerDependencies(Container $container)
    {
        $container = parent::provideBusinessLayerDependencies($container);

        $container-&gt;extend(self::COMMAND_PLUGINS, function (CommandCollectionInterface $commandCollection) {
            $commandCollection-&gt;add(new ExamplePlugin(), 'Example/ExampleCommand');

            return $commandCollection;
        });

        return $container;
    }
...
}</code></pre></p></div>
                                                    <p>Similar to this, the mapping between a string linked to a condition and the implementation of the condition is also done through the state machine handler <var>StateMachineHandlerInterface::getConditionPlugins().</var></p>
                                                    <p>A transition from one state to another can be conditioned: it’s possible to make that transition if a condition is satisfied:</p><pre><code class="language-XML line-numbers">&lt;transition condition="Example/ExampleTransition" happy="true"&gt;
    &lt;source&gt;paid&lt;/source&gt;
    &lt;target&gt;shipped&lt;/target&gt;
    &lt;event&gt;ship it&lt;/event&gt;
&lt;/transition&gt;</code></pre>
                                                    <p>&#160;</p>
                                                    <p>&#160;</p>
                                                    <p><a href="javascript:void(0);" class="MCHelpControl MCHelpControl-Related relatedTopics" data-mc-topics="Cron Jobs - State Machine | Spryker|state-machine-cronjob.htm||Implementing the Plugin - State Machine | Spryker|state-machine-implementing-plugin.htm||Persistence - State Machine | Spryker|state-machine-persistence.htm||State Machine Cookbook - Part I - State Machine Fundamentals|https://documentation.spryker.com/state_machine_cookbook/state-machine-cookbook.htm||State Machine Patterns | Spryker|state-machine-patterns.htm||Triggering Events - State Machine | Spryker|state-machine-events.htm||Updating Presentation in Zed - State Machine | Spryker|state-machine-zed-presentation.htm"><span class="MCHelpControl-RelatedHotSpot_"><img class="MCHelpControl_Image_Icon" src="../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Related Topics Link Icon" />Related Topics</span></a>
                                                    </p>
                                                    <p>&#160;</p>
                                                    <p><i>Last review date: </i><i>Fed 21, 2019 </i><![CDATA[    ]]></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><a class="scroll-top js-scroll-top" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="#FFF" fill-rule="nonzero" d="M11.82 5.22a.54.54 0 0 1 0 .806.636.636 0 0 1-.852 0L6.607 1.937v13.49a.587.587 0 0 1-.602.573c-.336 0-.611-.258-.611-.573V1.937L1.04 6.026a.647.647 0 0 1-.86 0 .54.54 0 0 1 0-.807L5.573.163a.636.636 0 0 1 .852 0L11.82 5.22z" /></svg></a>
                                <script>/* <![CDATA[ */
			function createGithubUrl() {
			var GITHUB_CONTENT_PATH = '/blob/master/public';
			var link = document.querySelector('.js-widget-github-link');
			var href =
			link.getAttribute('href')
			+ GITHUB_CONTENT_PATH
			+ window.location.pathname;
			link.setAttribute('href', href);
			}
			createGithubUrl();
		/* ]]> */</script>
                                <script>/* <![CDATA[ */
			requirejs.config({
				appDir: '',
				paths: {
					'clipboard': ['https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min']
					
				}
			});
			require(['clipboard'], function(Clipboard) {
				console.log(Clipboard);
				window.Clipboard = Clipboard;
			});
		/* ]]> */</script>
                                <script src="../../../resources/scripts/perfect-scrollbar.js">
                                </script>
                                <script src="../../../resources/scripts/imagemapster.js">
                                </script>
                                <script src="../../../resources/scripts/script.js">
                                </script>
                                <script src="../../../resources/scripts/prism.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>
