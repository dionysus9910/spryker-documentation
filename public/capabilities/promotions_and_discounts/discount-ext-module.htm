<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-conditions="Spryker.B2C,Spryker.B2B,Spryker.DemoShop,Spryker.ShopSuite" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Extending the Discount Module</title>
        <script>/* <![CDATA[ */
			var s = document.createElement("script");
			s.type = "text/javascript";
			s.src = "https://www.googletagmanager.com/gtag/js?id==UA-56589105-4";
			document.getElementsByTagName('head').item(0).appendChild(s);
		/* ]]> */</script>
        <script>/* <![CDATA[ */
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-56589105-4');
		/* ]]> */</script>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <link href="../../resources/stylesheets/perfect-scrollbar.css" rel="stylesheet" />
        <link href="../../resources/stylesheets/prism.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/stylesheets/mainstyles.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search the Academy" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="breadcrumbs-block">
                                        </div>
                                        <div>
                                        </div>
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie _Skins_SearchHome mc-component">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                            </div>
                                        </div>
                                        <div>
                                            <div class="side-menu">
                                                <div class="toolbar-wrapper">
                                                    <div class="widget-github js-widget-github"><a class="widget-github-link js-widget-github-link" href="https://github.com/spryker/spryker-documentation" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><path d="M13.5 0C6.057 0 0 6.057 0 13.5c0 5.888 3.791 10.905 9.058 12.745a.463.463 0 0 0 .258.088c1.316.43 2.724.667 4.184.667C20.943 27 27 20.943 27 13.5S20.943 0 13.5 0zm0 .931c6.93 0 12.569 5.639 12.569 12.569 0 5.428-3.459 10.061-8.287 11.818a1.903 1.903 0 0 1-.092-.527v-2.446c0-.975-.477-2.037-.946-2.75 2.584-.436 5.537-1.776 5.537-6.779 0-1.37-.429-2.58-1.275-3.598.186-.611.415-1.9-.225-3.52a.47.47 0 0 0-.291-.272c-.13-.04-1.326-.35-3.806 1.277a12.921 12.921 0 0 0-6.36 0c-2.481-1.63-3.68-1.319-3.809-1.277a.47.47 0 0 0-.29.273C5.582 7.319 5.811 8.607 6 9.218c-.85 1.018-1.279 2.227-1.279 3.598 0 4.957 2.9 6.323 5.463 6.778-.322.407-.66.934-.81 1.47-.661.184-2.018.19-2.929-1.37-.032-.06-.829-1.475-2.4-1.584-.25.002-.882.042-1.035.525-.169.537.424.944.679 1.117l.058.034c.029.015.707.371 1.213 1.644.105.333 1.03 2.84 4.353 2.399.002.367 0 .552-.004.7v.26c0 .15-.045.378-.096.525C4.386 23.558.931 18.924.931 13.5.931 6.57 6.57.931 13.5.931zm6.51 5.375c.5 1.471.158 2.537.035 2.839a.468.468 0 0 0 .089.49c.805.883 1.214 1.952 1.214 3.181 0 4.72-2.796 5.666-5.535 5.97a.464.464 0 0 0-.253.815c.368.314 1.199 1.68 1.199 2.744v2.446c0 .009.001.414.134.809a12.513 12.513 0 0 1-6.792-.002c.135-.396.139-.802.139-.81l.001-.248c.002-.211.006-.497 0-1.266a.473.473 0 0 0-.174-.362.47.47 0 0 0-.391-.09c-3.126.681-3.802-1.576-3.828-1.67l-.016-.047c-.448-1.135-1.037-1.713-1.388-1.975.759.267 1.182 1.007 1.193 1.024 1.231 2.107 3.264 2.162 4.328 1.685a.463.463 0 0 0 .27-.36c.095-.665.826-1.545 1.196-1.87a.464.464 0 0 0 .136-.488.461.461 0 0 0-.39-.324c-2.73-.31-5.524-1.266-5.524-5.98 0-1.228.41-2.3 1.219-3.181a.464.464 0 0 0 .087-.491c-.124-.302-.467-1.364.031-2.837.396.013 1.362.182 2.988 1.286.112.076.256.1.387.063.973-.27 2.058-.416 3.135-.421 1.08.005 2.166.15 3.14.421.131.037.273.013.386-.063 1.635-1.11 2.6-1.275 2.984-1.288z" /></svg></a>
                                                    </div>
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic NextTopic Print ExpandAll CollapseAll;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img src="../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="js-anchorer">
                                                    <h1>Extending the Discount Module</h1>
                                                    <p>The main components that describe a discount are:</p>
                                                    <ul>
                                                        <li class="bullet_list" value="1"><strong>discount collector</strong>: Specifies for which items discount is being applied/calculated.<br />Example: The discount can be applied for a specific set of products or for orders that contain a minimum number of items or for orders that have a minimum grand total value.</li>
                                                        <li class="bullet_list" value="2"><strong>discount decision</strong> rule: Specifies the conditions that need to be satisfied for the discount to be applied.<br />Example: The discount can be used on specific days of the week or on specific time intervals in a day.</li>
                                                        <li class="bullet_list" value="3"><strong>discount filter</strong> is applied to disountable items after collector had been run, filters are executed after each discount allowed explicit filtering.</li>
                                                        <li class="bullet_list" value="4"><strong>discount collector strategy</strong>: It's possible to change what collector strategy is used when collecting items for discounts, by default query string strategy is used. Collecting items by defined rule.</li>
                                                        <li class="bullet_list" value="5"><strong>discount post save</strong>: This extension allows to add more behaviour to discounts after discount saved. </li>
                                                        <li class="bullet_list" value="6"><strong>discount post update</strong>: This extension allows to add more behaviour to discounts after discount updated. </li>
                                                        <li class="bullet_list" value="7"><strong>discount configuration expander</strong>: This extension allows to add more data to DiscountConfigurationTransfer object. This object later mapped to discount form. </li>
                                                        <li class="bullet_list" value="8"><strong>discount form expander</strong>: This extension allows to extend the discount form. </li>
                                                        <li class="bullet_list" value="9"><strong>discount form data provider expander</strong>: This extension allows adding additional data to discount form data provider. </li>
                                                        <li class="bullet_list" value="10"><strong>discount view block provider</strong>: This extension allows adding additional blocks to discount view page. </li>
                                                        <li class="bullet_list" value="11"><strong>discount applicable filter plugin</strong>: This extension allows to filter quote items before passing to query builder (decision rule). For example you can filter items you don't want to match all your rules. </li>
                                                    </ul>
                                                    <p>The decision rule associated with the discount always runs first; if it is satisfied, the collector is run so that the discount calculation can be performed on the collected items.</p>
                                                    <p>The <var>Discount</var> module already contains a set of discount collectors and decision rules, but depending on your needs, you can extend it with your own ones.</p>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a New Decision Rule</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>The decision rules are placed in the <var>Business/DecisionRule/</var> folder from the <var>Discount</var> module in Zed.</p>
                                                            <p>A decision rule must implement the <var>DecisionRuleInterface</var>. You’ll need to implement the <var>isSatisfiedBy()</var> method that returns a boolean value that states if the decision rule is satisfied.</p>
                                                            <p>Example:</p><pre><code class="language-PHP line-numbers">&lt;?php
    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ItemTransfer $currentItemTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @throws \Spryker\Zed\Discount\Business\Exception\ComparatorException
     *
     * @return bool
     */
    public function isSatisfiedBy(
        QuoteTransfer $quoteTransfer,
        ItemTransfer $currentItemTransfer,
        ClauseTransfer $clauseTransfer
    ) {
        return $this-&gt;comparators-&gt;compare($clauseTransfer, $currentItemTransfer-&gt;getSku());
    }</code></pre>
                                                            <p>In the example above, we are checking if the given item is matching the clause (has the same SKU).</p>
                                                            <p>To use the query comparators, you need to inject them in the constructor of your new decision rule.</p>
                                                            <p>The next step is to expose the new decision rule through the facade: extend the <var>DiscountFacade</var> by adding a new operation that exposes its functionality.</p><pre><code class="language-PHP line-numbers">&lt;?php
    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ItemTransfer $itemTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @return bool
     */
    public function isItemSkuSatisfiedBy(
        QuoteTransfer $quoteTransfer,
        ItemTransfer $itemTransfer,
        ClauseTransfer $clauseTransfer
    ) {
        return $this-&gt;getFactory()
            -&gt;createSkuDecisionRule()
            -&gt;isSatisfiedBy($quoteTransfer, $itemTransfer, $clauseTransfer);
    }</code></pre>
                                                            <p>Create a plugin that calls the facade operation you have just added. The plugin must be placed inside the <var>Communication/Plugin/DecisionRule/</var> folder from the <var>Discount</var> module . The decision rule plugin must implement the <var>DecisionRulePluginInterface</var>.</p>
                                                            <p>Besides calling the discount decision rule to check if the discount can be applied, the plugin also defines the name of the field to which we’re performing the comparison, as well as the accepted data types.</p><pre><code class="language-PHP line-numbers">&lt;?php
class SkuDecisionRulePlugin extends AbstractPlugin implements DecisionRulePluginInterface
{

    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ItemTransfer $itemTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @return bool
     */
    public function isSatisfiedBy(QuoteTransfer $quoteTransfer, ItemTransfer $itemTransfer, ClauseTransfer $clauseTransfer)
    {
        return $this-&gt;getFacade()
            -&gt;isItemSkuSatisfiedBy($quoteTransfer, $itemTransfer, $clauseTransfer);
    }

    /**
     * Name of field as used in query string
     *
     * @return string
     */
    public function getFieldName()
    {
        return 'sku';
    }

    /**
     * @return array
     */
    public function acceptedDataTypes()
    {
        return [
            ComparatorOperators::TYPE_STRING,
            ComparatorOperators::TYPE_LIST,
        ];
    }

}</code></pre>
                                                            <p>The last step is to register the plugin so that it’s available in the discount plugin stack.</p>
                                                            <p>Extend the <var>DiscountDependencyProvider::getDecisionRulePlugins()</var> and add the new decision rule to the stack.</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a New Collector</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>Adding a new collector is similar to adding a new decision rule.</p>
                                                            <p>The discount collectors are placed inside the <var>Business/Collector/</var> folder from the <var>Discount</var> module in Zed.</p>
                                                            <p>A collector must implement the <var>CollectorInterface</var> and must extend the <var>BaseCollector</var> class that offers support for creating the discountable items. You’ll need to implement the <var>collect()</var> method that returns the set of items on which the discount can be applied.</p>
                                                            <p>Example:</p><pre><code class="language-PHP line-numbers">&lt;?php
    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @return \Generated\Shared\Transfer\DiscountableItemTransfer[]
     */
    public function collect(QuoteTransfer $quoteTransfer, ClauseTransfer $clauseTransfer)
    {
        $discountableItems = [];
        foreach ($quoteTransfer-&gt;getItems() as $itemTransfer) {
            if ($this-&gt;comparators-&gt;compare($clauseTransfer, $itemTransfer-&gt;getSku()) === false) {
                continue;
            }

            $discountableItems[] = $this-&gt;createDiscountableItemTransfer(
                $itemTransfer-&gt;getUnitGrossPrice(),
                $itemTransfer-&gt;getQuantity(),
                $itemTransfer-&gt;getCalculatedDiscounts()
            );
        }

        return $discountableItems;
    }</code></pre>
                                                            <p>In the example above, we are looking over the items included in the order and select the ones that have the SKU specified in the collector clause.</p>
                                                            <p>To use the query comparators, you need to inject them in the constructor of your new discount collector.</p>
                                                            <p>The next step is to expose the new collector through the facade: extend the <var>DiscountFacade</var> by adding a new operation that exposes its functionality.</p><pre><code class="language-PHP line-numbers">&lt;?php
    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @return array
     */
    public function collectBySku(QuoteTransfer $quoteTransfer, ClauseTransfer $clauseTransfer)
    {
        return $this-&gt;getFactory()
            -&gt;createSkuCollector()
            -&gt;collect($quoteTransfer, $clauseTransfer);
    }</code></pre>
                                                            <p>Create a plugin that calls the facade operation you have just added. The plugin must be placed inside the <var>Communication/Plugin/Collector/ </var>folder from the <var>Discount</var> module. The discount collector plugin must implement the <var>CollectorPluginInterface</var>.</p>
                                                            <p>Besides calling the discount collector to retrieve the items for which the discount can be applied, the plugin also defines the name of the field to which we’re performing the comparison, as well as the accepted data types.</p><pre><code class="language-PHP line-numbers">&lt;?php
class ItemBySkuCollectorPlugin extends AbstractPlugin implements CollectorPluginInterface
{

    /**
     * @param \Generated\Shared\Transfer\QuoteTransfer $quoteTransfer
     * @param \Generated\Shared\Transfer\ClauseTransfer $clauseTransfer
     *
     * @return array
     */
    public function collect(QuoteTransfer $quoteTransfer, ClauseTransfer $clauseTransfer)
    {
        return $this-&gt;getFacade()-&gt;collectBySku($quoteTransfer, $clauseTransfer);
    }

    /**
     * Name of field as used in query string
     *
     * @return string
     */
    public function getFieldName()
    {
        return 'sku';
    }

    /**
     * @return array
     */
    public function acceptedDataTypes()
    {
        return [
            ComparatorOperators::TYPE_STRING,
            ComparatorOperators::TYPE_LIST,
        ];
    }

}</code></pre>
                                                            <p>The last step is to register the plugin so that it’s available in the discount plugin stack.</p>
                                                            <p>Extend the <var>DiscountDependencyProvider::getCollectorPlugins()</var> and add the new discount collector to the stack.</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Filter Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>If you extended <var>\Spryker\Zed\Discount\Business\Calculator\Calculator</var> in your project code, change it to <var>\Spryker\Zed\Discount\Business\Calculator\FilteredCalculator</var>, as it also includes filtering related logic.</p>
                                                            <p>To add a new filter plugin, create a plugin in your respective module which implements <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountableItemFilterPluginInterface</var>.</p>
                                                            <p>The filter will send <var>\Generated\Shared\Transfer\CollectedDiscountTransfer</var> to your plugin for each applicable discount. To filter out discounts, remove items from <var>\Generated\Shared\Transfer\CollectedDiscountTransfer::$discountableItems</var>.</p>
                                                            <p>If you return an empty collection, then this discount will not be applied.</p>
                                                            <p>Add your plugin to the plugin stack <var>\Spryker\Zed\Discount\DiscountDependencyProvider::getDiscountableItemFilterPlugins</var> extended by a project. After this all discounts will be filtered by the provided plugins.</p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Creating a New Discount Collector Strategy Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>
                    Discount module distributes discount amount to discountable items. For this there is a collector which returns the list of items to which discount can be applied. If you want to have custom logic how this is collected, then you can implement a different collector strategy.
                </p>
                                                            <p>
                    You will need to implement <var>\Spryker\Zed\Discount\Dependency\Plugin\CollectorStrategyPluginInterface</var>. This interface has two methods, the first <var>\Spryker\Zed\Discount\Dependency\Plugin\CollectorStrategyPluginInterface::accept(DiscountTransfer $discountTransfer, QuoteTransfer $quoteTransfer)</var></p>
                                                            <p><![CDATA[
                   ]]>must return true for a given discount if current strategy is applicable. DiscountTransfer and QuoteTransfer are provided for additional context when making decision.
                </p>
                                                            <p>
                    The second, <var>\Spryker\Zed\Discount\Dependency\Plugin\CollectorStrategyPluginInterface::collect(DiscountTransfer $discountTransfer, QuoteTransfer $quoteTransfer)</var> must return DiscountableItemTransfer array, this is the items to which discount will be applied.
                </p>
                                                            <p>
                    You have to create a new plugin in your module and place it to for example <var>Communication/Plugins/Discount/NameOfPlugin.php</var>, add this plugin to Discount module dependency provider, by modifying <var>\Pyz\Zed\Discount\DiscountDependencyProvider::getCollectorStrategyPlugins()</var></p>
                                                            <p>
                   The method would look like:
                   <code>
                       /**
                         * @return \Spryker\Zed\Discount\Dependency\Plugin\CollectorStrategyPluginInterface[]
                         */
                        protected function getCollectorStrategyPlugins()
                        {
                            return [
                                new NameOfPlugin(),
                            ];
                        }
                   </code></p>
                                                            <p>
                    After this the new collector should be ready for use.
                </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Post Save Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>If you want to add more behavior after the discount is saved, you can implement <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountPostSavePluginInterface</var> plugin interface. </p>
                                                            <p>
                   Create a new plugin which implements the interface, place plugin in your module under <var>Communication/Plugins/Discount/NameOfPlugin()</var>.
                </p>
                                                            <p>
                   Add this plugin to <var>`\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountPostSavePlugins`</var> plugin stack.
                </p>
                                                            <p>
                   After this the new post save plugin should be ready for use.
                </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Post Update Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>If you want to add more behavior after discount is updated, you can implement <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountPostUpdatePluginInterface</var> plugin interface. </p>
                                                            <p>
                   Create a new plugin which implements the interface, place plugin in your module under <var>Communication/Plugins/Discount/NameOfPlugin()</var>.
                </p>
                                                            <p>
                   Add this plugin to <var>`\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountPostUpdatePlugins`</var> plugin stack.
                </p>
                                                            <p>
                   After this the new post save plugin should be ready for use.
                </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Configuration Expander Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>If you want to expand <var>DiscountConfigurationTransfer</var> with additional data, you can create a new plugin implementing <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountConfigurationExpanderPluginInterface</var> </p>
                                                            <p>
                   Create a new plugin which implements the interface, place plugin in your module under <var>Communication/Plugins/Discount/NameOfPlugin()</var>.
                </p>
                                                            <p>
                   Add this plugin to <var>`\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountConfigurationExpanderPlugins`</var> plugin stack.
                </p>
                                                            <p>
                   After this the new expander pluing should be ready for use.
                </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Form Expander Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>
                       It's possible to extend ZED discount administration form.
                   </p>
                                                            <p>
                       To inject new form fields, you have to implement <var>\Spryker\Zed\Discount\Dependency\Plugin\Form\DiscountFormExpanderPluginInterface</var> plugin interface.
                   </p>
                                                            <p>
                       This plugin has 1 method:
                       <ol><li value="1"><var>public function expandFormType(FormBuilderInterface $builder, array $options)</var> is the method used to add new properties to Discount form.</li></ol>

                      You have to use $builder object to extend Discount form.
                      reference you can check implementation of <var>\Spryker\Zed\DiscountPromotion\Communication\Plugin\Discount\DiscountPromotionCalculationFormExpanderPlugin</var> which adds two new form fields to Discount Calculation form.
                   </p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Adding a Discount Form Data Expander Plugin</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>
                       This plugin allows to add additional data to discount form data provider
                   </p>
                                                            <p>
                       To add additional data to discount form, <var>\Spryker\Zed\Discount\Dependency\Plugin\Form\DiscountFormDataProviderExpanderPluginInterface</var> plugin interface should be implemented.
                   </p>
                                                            <p>
                       This plugin has 2 methods:

                       <ol><li value="1"><var>public function expandDataProviderOptions(array $options);</var>: This method must return extended option array which will be passed to DiscountForm.</li><li value="2"><var>public function expandDataProviderData(array $data);</var>: This method must return extended data array which will be passed to DiscountForm.</li></ol>

                      Add this plugin to: <var>\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountFormDataProviderExpanderPlugins</var></p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Rendering Additional Data Inside Discount View Page</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>
                       You can provide URL to your action which will include rendered html at the bottom of the discount view page.
                   </p>
                                                            <p>
                      It is necessary to implement  <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountViewBlockProviderPluginInterface</var> plugin interface.
                   </p>
                                                            <p>
                      This plugin has single method <var> public function getUrl()</var> which must return URL path to controller action, for example <var>"/discount/block/index"</var>.
                      Add this plugin to: <var>\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountViewTemplateProviderPlugins</var></p>
                                                        </div>
                                                    </div>
                                                    <div class="MCDropDown MCDropDown_Closed dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Filter Applicable Discounts Before Query Rule Engine</a></span>
                                                        <div class="MCDropDownBody dropDownBody">
                                                            <p>
                       You can filter out  quote items before making them match your decision rule. For example, you don't want matching promotion items.
                       This filter will be applicable to all decision rules. Each plugin is narrowing down applicable items. For example when you have two plugins, second plugin will receive items filtered by the first one.
                   </p>
                                                            <p>
                      It is necessary to implement  <var>\Spryker\Zed\Discount\Dependency\Plugin\DiscountApplicableFilterPluginInterface</var> plugin interface.
                   </p>
                                                            <p>
                      This plugin has single method <var> public function filter(array $discountApplicableItems, QuoteTransfer $quoteTransfer, $idDiscount);</var> which must return array of <var>ItemTransfer[]</var> object applicable for discount.
                      Add this plugin to: <var>\Pyz\Zed\Discount\DiscountDependencyProvider::getDiscountApplicableFilterPlugins</var></p>
                                                        </div>
                                                    </div>
                                                    <p>&#160;</p>
                                                    <p><![CDATA[
		]]><i>Last review date: Sep. 1, 2017</i> <![CDATA[
    ]]></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><a class="scroll-top js-scroll-top" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="#FFF" fill-rule="nonzero" d="M11.82 5.22a.54.54 0 0 1 0 .806.636.636 0 0 1-.852 0L6.607 1.937v13.49a.587.587 0 0 1-.602.573c-.336 0-.611-.258-.611-.573V1.937L1.04 6.026a.647.647 0 0 1-.86 0 .54.54 0 0 1 0-.807L5.573.163a.636.636 0 0 1 .852 0L11.82 5.22z" /></svg></a>
                                <script>/* <![CDATA[ */
			function createGithubUrl() {
			var GITHUB_CONTENT_PATH = '/blob/master/public';
			var link = document.querySelector('.js-widget-github-link');
			var href =
			link.getAttribute('href')
			+ GITHUB_CONTENT_PATH
			+ window.location.pathname;
			link.setAttribute('href', href);
			}
			createGithubUrl();
		/* ]]> */</script>
                                <script>/* <![CDATA[ */
			requirejs.config({
				appDir: '',
				paths: {
					'clipboard': ['https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min']
					
				}
			});
			require(['clipboard'], function(Clipboard) {
				console.log(Clipboard);
				window.Clipboard = Clipboard;
			});
		/* ]]> */</script>
                                <script src="../../resources/scripts/perfect-scrollbar.js">
                                </script>
                                <script src="../../resources/scripts/script.js">
                                </script>
                                <script src="../../resources/scripts/prism.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>